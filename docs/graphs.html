<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Using R for Data Analysis and Graphics - 2&nbsp; Base R Graphics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./reg.html" rel="next">
<link href="./basics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./graphs.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Base R Graphics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Using R for Data Analysis and Graphics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An overview of the R system</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Base R Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GLMandA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Generalized Linear and Additive Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regular Time Series in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tree-based models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mva.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Level Models and Repeated Measures Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-base-graphics-plot-scatterplot-function" id="toc-the-base-graphics-plot-scatterplot-function" class="nav-link active" data-scroll-target="#the-base-graphics-plot-scatterplot-function"><span class="header-section-number">2.1</span> The base graphics <code>plot()</code> scatterplot function</a>
  <ul class="collapse">
  <li><a href="#plot-methods-for-different-classes-of-object" id="toc-plot-methods-for-different-classes-of-object" class="nav-link" data-scroll-target="#plot-methods-for-different-classes-of-object">Plot methods for different classes of object</a></li>
  </ul></li>
  <li><a href="#plot-and-allied-functions-some-further-details" id="toc-plot-and-allied-functions-some-further-details" class="nav-link" data-scroll-target="#plot-and-allied-functions-some-further-details"><span class="header-section-number">2.2</span> <code>plot()</code> and allied functions – some further details</a>
  <ul class="collapse">
  <li><a href="#size-colour-and-choice-of-plotting-symbol" id="toc-size-colour-and-choice-of-plotting-symbol" class="nav-link" data-scroll-target="#size-colour-and-choice-of-plotting-symbol">Size, colour, and choice of plotting symbol</a></li>
  <li><a href="#fine-control-parameter-settings" id="toc-fine-control-parameter-settings" class="nav-link" data-scroll-target="#fine-control-parameter-settings">Fine control – Parameter settings</a></li>
  <li><a href="#multiple-plots-on-the-one-page" id="toc-multiple-plots-on-the-one-page" class="nav-link" data-scroll-target="#multiple-plots-on-the-one-page">Multiple plots on the one page</a></li>
  <li><a href="#the-shape-of-the-graph-sheet" id="toc-the-shape-of-the-graph-sheet" class="nav-link" data-scroll-target="#the-shape-of-the-graph-sheet">The shape of the graph sheet</a></li>
  </ul></li>
  <li><a href="#adding-points-lines-and-text" id="toc-adding-points-lines-and-text" class="nav-link" data-scroll-target="#adding-points-lines-and-text"><span class="header-section-number">2.3</span> Adding points, lines, and text</a>
  <ul class="collapse">
  <li><a href="#adding-a-specified-line-to-plots" id="toc-adding-a-specified-line-to-plots" class="nav-link" data-scroll-target="#adding-a-specified-line-to-plots">Adding a specified line to plots</a></li>
  <li><a href="#adding-text" id="toc-adding-text" class="nav-link" data-scroll-target="#adding-text">Adding text</a></li>
  <li><a href="#adding-text-in-one-of-the-margins" id="toc-adding-text-in-one-of-the-margins" class="nav-link" data-scroll-target="#adding-text-in-one-of-the-margins">Adding Text in one of the margins</a></li>
  <li><a href="#identification-and-location-on-the-figure-region" id="toc-identification-and-location-on-the-figure-region" class="nav-link" data-scroll-target="#identification-and-location-on-the-figure-region">Identification and Location on the Figure Region</a></li>
  </ul></li>
  <li><a href="#plots-that-show-the-distribution-of-data-values" id="toc-plots-that-show-the-distribution-of-data-values" class="nav-link" data-scroll-target="#plots-that-show-the-distribution-of-data-values"><span class="header-section-number">2.4</span> Plots that show the distribution of data values</a>
  <ul class="collapse">
  <li><a href="#histograms-and-density-plots" id="toc-histograms-and-density-plots" class="nav-link" data-scroll-target="#histograms-and-density-plots">Histograms and density plots</a></li>
  <li><a href="#dotcharts-and-stripcharts" id="toc-dotcharts-and-stripcharts" class="nav-link" data-scroll-target="#dotcharts-and-stripcharts">Dotcharts and stripcharts</a></li>
  <li><a href="#boxplots" id="toc-boxplots" class="nav-link" data-scroll-target="#boxplots">Boxplots</a></li>
  <li><a href="#normal-probability-plots" id="toc-normal-probability-plots" class="nav-link" data-scroll-target="#normal-probability-plots">Normal probability plots</a></li>
  </ul></li>
  <li><a href="#scatterplot-smoothing" id="toc-scatterplot-smoothing" class="nav-link" data-scroll-target="#scatterplot-smoothing"><span class="header-section-number">2.5</span> Scatterplot smoothing</a></li>
  <li><a href="#sec-lattice" id="toc-sec-lattice" class="nav-link" data-scroll-target="#sec-lattice"><span class="header-section-number">2.6</span> Lattice graphics</a>
  <ul class="collapse">
  <li><a href="#examples-that-present-panels-of-scatterplots-using-xyplot" id="toc-examples-that-present-panels-of-scatterplots-using-xyplot" class="nav-link" data-scroll-target="#examples-that-present-panels-of-scatterplots-using-xyplot">Examples that Present Panels of Scatterplots – Using <code>xyplot()</code></a></li>
  <li><a href="#plotting-columns-in-parallel" id="toc-plotting-columns-in-parallel" class="nav-link" data-scroll-target="#plotting-columns-in-parallel">Plotting columns in parallel</a></li>
  <li><a href="#data-compared-with-simulated-normal-data" id="toc-data-compared-with-simulated-normal-data" class="nav-link" data-scroll-target="#data-compared-with-simulated-normal-data">Data, compared with simulated normal data</a></li>
  <li><a href="#adding-new-layers" id="toc-adding-new-layers" class="nav-link" data-scroll-target="#adding-new-layers">Adding new layers</a></li>
  </ul></li>
  <li><a href="#using-mathematical-expressions-in-plots" id="toc-using-mathematical-expressions-in-plots" class="nav-link" data-scroll-target="#using-mathematical-expressions-in-plots"><span class="header-section-number">2.7</span> Using mathematical expressions in plots</a></li>
  <li><a href="#guidelines-for-graphs" id="toc-guidelines-for-graphs" class="nav-link" data-scroll-target="#guidelines-for-graphs"><span class="header-section-number">2.8</span> Guidelines for Graphs</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">2.9</span> Exercises</a></li>
  <li><a href="#references-and-reading" id="toc-references-and-reading" class="nav-link" data-scroll-target="#references-and-reading"><span class="header-section-number">2.10</span> References and reading</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Base R Graphics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Most of the attention will be on base graphics. Base graphics functions in the style of <code>plot()</code> and allied functions are designed to directly create graphs that appear in printed output or on the screen.</p>
<p>This contrasts with the approach in <em>lattice</em> and in <em>ggplot2</em> graphics, where graphics functions create graphics <em>objects</em>, i.e., instructions for creating a plot, rather than a plot on the screen or page. Plotting (or printing) is then a process by which those instructions are used to create a plot on the graph or screen. In this context, <code>plot()</code> (or <code>print()</code>) are used as generic functions, whose action is determined by the <em>class</em> of object.</p>
<section id="the-base-graphics-plot-scatterplot-function" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-base-graphics-plot-scatterplot-function"><span class="header-section-number">2.1</span> The base graphics <code>plot()</code> scatterplot function</h2>
<p>The functions <code>plot()</code>, <code>points()</code>, <code>lines()</code>, <code>text()</code>, <code>mtext()</code>, <code>axis()</code>, and <code>identify()</code> are part of a suite that plots points, lines and text. To see some of the possibilities that R offers, enter</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">demo</span>(graphics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Press the Enter key to move to each new graph.</p>
<section id="plot-methods-for-different-classes-of-object" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="plot-methods-for-different-classes-of-object">Plot methods for different classes of object</h3>
<p>The plot function is a generic function that has special methods for “plotting” various different classes of object. For example, plotting a data frame gives, for each numeric variable, a normal probability plot. Plotting the lm object that is created by the use of the <code>lm()</code> linear model function gives diagnostic and other information that is designed to help in the interpretation of regression results. Try</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hills)  <span class="co"># Has the same effect as `pairs(hills)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="plot-and-allied-functions-some-further-details" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="plot-and-allied-functions-some-further-details"><span class="header-section-number">2.2</span> <code>plot()</code> and allied functions – some further details</h2>
<p>The following both plot <code>y</code> against <code>x</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x)  <span class="co"># Use a formula to specify the graph</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)   <span class="co"># </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is usual for <code>x</code> and <code>y</code> to be numeric vectors of the same length. (Also possible, but rarely used, is for <code>x</code> to be a factor.) Try</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>)<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">10</span>, <span class="fu">sin</span>((<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>)<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)<span class="sc">*</span><span class="fl">0.92</span>, <span class="fu">sin</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)<span class="sc">*</span><span class="fl">0.92</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compare the appearance that these graphs present. Is it obvious that these points lie on a sine curve? How can one make it obvious? (Place the cursor over the lower border of the graph sheet, until it becomes a double-sided arror. Drag the border in towards the top border, making the graph sheet short and wide.)</p>
<p>Two further examples are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(distance <span class="sc">~</span> stretch, <span class="at">data=</span>DAAG<span class="sc">::</span>elasticband) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ACT <span class="sc">~</span> Year, <span class="at">data=</span>DAAG<span class="sc">::</span>austpop, <span class="at">type=</span><span class="st">"l"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ACT <span class="sc">~</span> Year, <span class="at">data=</span>DAAG<span class="sc">::</span>austpop, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>points()</code> function adds points to a plot. The <code>lines()</code> function adds lines to a plot . The <code>text()</code> function adds text at specified locations. The <code>mtext()</code> function places text in one of the margins. The <code>axis()</code> function gives fine control over the adding of axis ticks and labels, usually on a graph where one or both axes have been omitted (<code>xaxt='n'</code> or <code>yaxt='n'</code> or <code>axes=false</code>) from the initial plot.</p>
<p>Here is a further possibility</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">spline</span>(Year, ACT), <span class="at">data=</span>DAAG<span class="sc">::</span>austpop, <span class="at">type=</span><span class="st">"l"</span>)  </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit smooth curve through points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="size-colour-and-choice-of-plotting-symbol" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="size-colour-and-choice-of-plotting-symbol">Size, colour, and choice of plotting symbol</h3>
<p>For <code>plot()</code> and <code>points()</code> the parameter <code>cex</code> (“character expansion”) controls the size, while <code>col</code> (“colour”) controls the colour of the plotting symbol. The parameter <code>pch</code> controls the choice of plotting symbol. The parameters <code>cex</code> and <code>col</code> may be used in a similar way with <code>text()</code>. Try</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="fl">0.15</span>,<span class="dv">4</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">7.35</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="dv">5</span>), <span class="at">type=</span><span class="st">"n"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">""</span>)   <span class="co"># Do not plot points or axes</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()               <span class="co"># Draw a box around the plot area</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="fu">rep</span>(<span class="fl">4.65</span>, <span class="dv">7</span>), <span class="at">cex=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">pch=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">lwd=</span><span class="dv">4</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="fu">rep</span>(<span class="fl">3.5</span>, <span class="dv">7</span>), <span class="at">labels=</span><span class="fu">paste</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">cex=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following, added to the plot that results from the above three statements, demonstrates other choices of pch.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">7</span>), <span class="at">pch=</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>)<span class="sc">+</span><span class="dv">7</span>, <span class="at">cex=</span><span class="dv">3</span>)  <span class="co"># Plot symbols 7 to 13</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">7</span>), <span class="fu">paste</span>((<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>)<span class="sc">+</span><span class="dv">7</span>), <span class="at">pos=</span><span class="dv">4</span>, <span class="at">cex=</span><span class="dv">1</span>)  <span class="co"># Add symbol number</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">7</span>), <span class="at">pch=</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>)<span class="sc">+</span><span class="dv">14</span>, <span class="at">cex=</span><span class="dv">3</span>)       <span class="co"># Plot symbols 14 to 20</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">7</span>), <span class="fu">paste</span>((<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>)<span class="sc">+</span><span class="dv">14</span>), <span class="at">pos=</span><span class="dv">4</span>, <span class="at">cex=</span><span class="dv">1</span>)   <span class="co"># Add symbol number</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note the use of pos=4 to position the text to the right of the point (1=below, 2=left, 3=top, 4=right). <a href="#fig-fig8" class="quarto-xref">Figure&nbsp;<span>2.1</span></a> shows the plots:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig8" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig8-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Different plot symbols, colours and sizes
</figcaption>
</figure>
</div>
</div>
</div>
<p>A variety of color palettes are available. <a href="#fig-fig9" class="quarto-xref">Figure&nbsp;<span>2.2</span></a> shows some of the possibilities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>view.colors <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.55</span>,<span class="fl">10.9</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>)){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="fl">0.15</span>,<span class="dv">4</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">xlim=</span>xlim, <span class="at">ylim=</span>ylim, <span class="at">type=</span><span class="st">"n"</span>, <span class="at">axes=</span>F, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="fu">rep</span>(<span class="fl">3.5</span>,<span class="dv">8</span>), <span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">col=</span><span class="fu">palette</span>()[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">cex=</span><span class="dv">4</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="dv">9</span>, <span class="fl">3.5</span>, <span class="st">"Default palette"</span>, <span class="at">adj=</span><span class="dv">0</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    rainchars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"R"</span>,<span class="st">"O"</span>,<span class="st">"Y"</span>,<span class="st">"G"</span>,<span class="st">"B"</span>,<span class="st">"I"</span>,<span class="st">"V"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">7</span>), rainchars, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">7</span>), <span class="at">cex=</span><span class="dv">4</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="dv">9</span>, <span class="fl">2.5</span>, <span class="st">"rainbow(7)"</span>, <span class="at">adj=</span><span class="dv">0</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## topo.colors()</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rect</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)<span class="sc">-</span><span class="fl">0.5</span>, <span class="fu">rep</span>(<span class="fl">1.05</span>,<span class="dv">8</span>), (<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)<span class="sc">+</span><span class="fl">0.5</span>, <span class="fu">rep</span>(<span class="fl">1.95</span>,<span class="dv">8</span>), <span class="at">col=</span><span class="fu">topo.colors</span>(<span class="dv">8</span>))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="fu">rep</span>(<span class="fl">1.5</span>,<span class="dv">8</span>), <span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">col=</span><span class="st">"gray"</span>, <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="dv">9</span>, <span class="fl">1.5</span>, <span class="st">"topo.colors(8)"</span>, <span class="at">adj=</span><span class="dv">0</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## heat.colors()</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rect</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)<span class="sc">-</span><span class="fl">0.5</span>, <span class="fu">rep</span>(<span class="fl">0.05</span>,<span class="dv">8</span>), (<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)<span class="sc">+</span><span class="fl">0.5</span>, <span class="fu">rep</span>(<span class="fl">0.95</span>,<span class="dv">8</span>), <span class="at">col=</span><span class="fu">heat.colors</span>(<span class="dv">8</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="fu">rep</span>(<span class="fl">0.5</span>,<span class="dv">8</span>), <span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">col=</span><span class="st">"gray"</span>, <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="dv">9</span>, <span class="fl">0.5</span>, <span class="st">"heat.colors(8)"</span>, <span class="at">adj=</span><span class="dv">0</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(oldpar)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig9" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig9-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: Some available colour palettes
</figcaption>
</figure>
</div>
</div>
</div>
<p>To run the function, enter</p>
</section>
<section id="fine-control-parameter-settings" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="fine-control-parameter-settings">Fine control – Parameter settings</h3>
<p>The default settings of parameters, such as character size, are often adequate. In order to change parameter settings for a subsequent plot, use the <code>par()</code> function. For example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">1.25</span>)   <span class="co"># character expansion</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>This increases the text and plot symbol size <span class="dv">25</span>% above the default. </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On the first use of <code>par()</code> to make changes for the current device, it is often useful to store existing settings, so that they can be restored later. For this, specify, e.g.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span><span class="fl">1.25</span>, <span class="at">mex=</span><span class="fl">1.25</span>)  <span class="co"># mex=1.25 expands the margin by 25%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This stores the existing settings in oldpar, then changes parameters (here cex and mex) as requested. To restore the original parameter settings at some later time, enter <code>par(oldpar)</code>. Here is an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(distance <span class="sc">~</span> stretch, <span class="at">data=</span>elasticband) </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar)         <span class="co"># Restores the earlier settings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Inside a function one can specify, e.g.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span><span class="fl">1.25</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">on.exit</span>(<span class="fu">par</span>(oldpar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Type in <code>help(par)</code> to get details of available parameter settings.</p>
</section>
<section id="multiple-plots-on-the-one-page" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="multiple-plots-on-the-one-page">Multiple plots on the one page</h3>
<p>The parameter <code>mfrow</code> can be used to configure the graphics sheet so that subsequent plots appear row by row, one after the other in a rectangular layout, on the one page.<br>
For a column by column layout, use <code>mfcol</code> instead. <a href="#fig-fig5" class="quarto-xref">Figure&nbsp;<span>2.3</span></a> uses a two by two layout to show plots of <code>brain</code> versus <code>body</code> with four different transformations, for data in the <code>DAAG::MASS::Animals</code> data frame:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig5-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: Plots of <code>brain</code> versus <code>body</code> for 26 different animals, with four different transformations.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Code</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(MASS<span class="sc">::</span>Animals, {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(body, brain)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="fu">sqrt</span>(body), <span class="fu">sqrt</span>(brain))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(body<span class="sc">^</span><span class="fl">0.1</span>, brain<span class="sc">^</span><span class="fl">0.1</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="fu">log</span>(body),<span class="fu">log</span>(brain))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note the use of braces (<code>{</code>,<code>}</code>) to bracket together the four plot statements, as a way to ensure that in all four cases the variable names refer to columns of the <code>MASS::Animals</code> data frame.</p>
</section>
<section id="the-shape-of-the-graph-sheet" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-shape-of-the-graph-sheet">The shape of the graph sheet</h3>
<p>One may for example want the individual plots to be rectangular rather than square. The R for Windows functions <code>win.graph()</code> or <code>x11()</code> that set up the Windows screen take the parameters width (in inches), height (in inches) and pointsize (in 1/72 of an inch). The setting of <code>pointsize</code> (default =12) determines character heights. It is the relative sizes of these parameters that matter for screen display or for incorporation into Word and similar programs. Graphs can be enlarged or shrunk by pointing at one corner, holding down the left mouse button, and pulling.</p>
</section>
</section>
<section id="adding-points-lines-and-text" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="adding-points-lines-and-text"><span class="header-section-number">2.3</span> Adding points, lines, and text</h2>
<p>Use the function <code>points()</code> to add points. Use <code>lines()</code> to join successive lines to points.</p>
<section id="adding-a-specified-line-to-plots" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-a-specified-line-to-plots">Adding a specified line to plots</h3>
<p>Use the function <code>abline()</code> for this. The parameters may be an intercept and slope, or a vector that holds the intercept and slope, or an lm object. Alternatively it is possible to draw a horizontal line (<code>h</code> = <height>), or a vertical line (<code>v</code> = <ordinate>).</ordinate></height></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig14" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig14-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.4: Plots of brain weight (gm) against body weight (kg).<br>
Panel A makes it clear why a logarithmic or other power transformation is needed. Panel B adds both a least squares regression line and a robust regression line.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-fig14" class="quarto-xref">Figure&nbsp;<span>2.4</span></a> shows plots of brain weight (gm) against body weight (kg), for 28 species of land animals. Logarithmic scales on both axes result in a meaningful plot, shown in Panel B. Two lines have been added – a least squares regression line (in black), and a robust regression line (in red).</p>
<p>The robust regression line makes a more sense than the least squares line. There are a number of animals with large body weight that have a larger brain weight than the red line would suggest.</p>
<p>Code for Panel B is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Animals.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log10</span>(brain) <span class="sc">~</span> <span class="fu">log10</span>(body), <span class="at">data=</span>Animals)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Animals.rlm <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">rlm</span>(<span class="fu">log10</span>(brain) <span class="sc">~</span> <span class="fu">log10</span>(body), <span class="at">data=</span>Animals)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(Animals.rlm, <span class="at">col=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="adding-text" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-text">Adding text</h3>
<p>Here is a simple example that uses the function <code>text()</code> to add text labels to the points on a plot. Data are</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>primates <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>primates</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>primates</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>              Bodywt Brainwt</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>Potar monkey    <span class="fl">10.0</span>     <span class="dv">115</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Gorilla        <span class="fl">207.0</span>     <span class="dv">406</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>Human           <span class="fl">62.0</span>    <span class="dv">1320</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>Rhesus monkey    <span class="fl">6.8</span>     <span class="dv">179</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>Chimp           <span class="fl">52.2</span>     <span class="dv">440</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Observe that the row names store labels for each row</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-fig6" class="quarto-xref">Figure&nbsp;<span>2.5</span></a> (a) would be adequate for identifying points, but is not a presentation quality graph. <a href="#fig-fig6" class="quarto-xref">Figure&nbsp;<span>2.5</span></a> (b) uses the <code>xlab</code> (x-axis) and <code>ylab</code> (y-axis) parameters to specify meaningful axis titles. It uses the parameter setting <code>pos=4</code> to move the labeling to the right of the points. It sets <code>pch=16</code> to make the plot character a heavy black dot. This helps make the points stand out against the labeling.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig6-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.5: Plots of the primates data, with labels on points. Panel B improves on Panel A
</figcaption>
</figure>
</div>
</div>
</div>
<p>To place the text to the left of the points, specify</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>Bodywt, <span class="at">y=</span>Brainwt, <span class="at">labels=</span><span class="fu">row.names</span>(primates), <span class="at">pos=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is the R code for <a href="#fig-fig6" class="quarto-xref">Figure&nbsp;<span>2.5</span></a>:</p>
</section>
<section id="adding-text-in-one-of-the-margins" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-text-in-one-of-the-margins">Adding Text in one of the margins</h3>
<p>Use <code>mtext(side, line, text, ..)</code> to add text in a margin (<code>side</code>) of the current plot. The sides are numbered 1(x-axis), 2(y-axis), 3(top) and 4(right).</p>
</section>
<section id="identification-and-location-on-the-figure-region" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="identification-and-location-on-the-figure-region">Identification and Location on the Figure Region</h3>
<p>The functions <code>identify()</code> and <code>locator()</code> can be used for this purpose. Draw the graph first, then call one or other of these functions.</p>
<p>Use <code>locator()</code> to show the co-ordinates of points, and <code>identify()</code> to label points. Position the cursor near the point whose co-ordinates are required, and click the left mouse button. prints out the co-ordinates of points. One positions the cursor at the location for which coordinates are required, and click the left mouse button. Depending on the screen device, a click with a mouse button other than the first, or pressing the ESC key terminates the process and returns a list that has the co-ordinates of the points. Or, if the setting of the parameter <code>n</code> (by default 360) is reached first, that terminates the process and returns the list.</p>
<p>The function <code>identify()</code> requires specification of a vector <code>x</code>, a vector <code>y</code>, and a vector of text strings that are available for use a labels. The parameter <code>n</code> is set to the number of points. Click to the left or right, and slightly above or below a point, depending on the preferred positioning of the label. When labeling is terminated, the row numbers of the observations that have been labelled are printed on the screen, in order. Thus try:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(brain <span class="sc">~</span> body, <span class="at">data=</span>MASS<span class="sc">::</span>Animals)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(primates, <span class="fu">identify</span>(Bodywt, Brainwt, <span class="fu">rownames</span>(primates)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function can be used to mark new points (specify <code>type="p"</code>) or lines (specify <code>type="l"</code>) or both points and lines (specify <code>type="b"</code>).</p>
</section>
</section>
<section id="plots-that-show-the-distribution-of-data-values" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="plots-that-show-the-distribution-of-data-values"><span class="header-section-number">2.4</span> Plots that show the distribution of data values</h2>
<p>We discuss histograms, density plots, boxplots and normal probability plots.</p>
<section id="histograms-and-density-plots" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="histograms-and-density-plots">Histograms and density plots</h3>
<p>The shapes of histograms depend on the placement of the breaks, as <a href="#fig-fig10" class="quarto-xref">Figure&nbsp;<span>2.6</span></a> illustrates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>possum <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>possum</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(possum, {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>here <span class="ot">&lt;-</span> sex <span class="sc">==</span> <span class="st">"f"</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(totlngth[here], <span class="at">breaks =</span> <span class="fl">72.5</span> <span class="sc">+</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">22</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Total length"</span>, <span class="at">main =</span><span class="st">"A: Breaks at 72.5, 77.5, ..."</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(totlngth[here]),<span class="at">type=</span><span class="st">"l"</span>, <span class="at">main=</span><span class="st">"B: Density curve"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>dens <span class="ot">&lt;-</span> <span class="fu">density</span>(totlngth[here])</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>xlim <span class="ot">&lt;-</span> <span class="fu">range</span>(dens<span class="sc">$</span>x)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">range</span>(dens<span class="sc">$</span>y)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(totlngth[here], <span class="at">breaks =</span> <span class="fl">72.5</span> <span class="sc">+</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">xlim =</span> xlim, <span class="at">ylim =</span> ylim, <span class="at">xlab=</span><span class="st">"Total length"</span>, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">main=</span><span class="st">"C: Breaks at 73, 78, ..."</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dens)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig10" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig10-1.png" class="img-fluid figure-img" width="691">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.6: Panel A shows a histogram with a frequency scale. Panel B is drawn with a density scale, so that a density curve can be readily superimposed. Panel C has a different choice of breakpoints, so that the histogram gives a rather different impression of the distribution of the data. The density curve is superimposed.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here is the code used to plot the histogram in <a href="#fig-fig10" class="quarto-xref">Figure&nbsp;<span>2.6</span></a> A.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(possum, {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  here <span class="ot">&lt;-</span> sex <span class="sc">==</span> <span class="st">"f"</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(totlngth[here], <span class="at">breaks =</span> <span class="fl">72.5</span> <span class="sc">+</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">22</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab=</span><span class="st">"Total length"</span>, <span class="at">main =</span><span class="st">"A: Breaks at 72.5, 77.5, ..."</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Density plots, now that they are available, are often a preferred alternative to a histogram. A histogram may be viewed as a crude form of density plot. Density plots do not depend on a choice of breakpoints. The choice of width and type of window, controlling the nature and amount of smoothing, does affect the appearance of the plot, making it more or less smooth. The following will give a density plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(totlngth[here]),<span class="at">type=</span><span class="st">"l"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(possum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="#fig-fig10" class="quarto-xref">Figure&nbsp;<span>2.6</span></a> B the y-axis for the histogram is labelled so that the area of a rectangle is the density for that rectangle, i.e., the frequency for the rectangle is divided by the width of the rectangle. This gives a scale that is appropriate for superimposing a density curve estimate. The only difference between <a href="#fig-fig10" class="quarto-xref">Figure&nbsp;<span>2.6</span></a> C and <a href="#fig-fig10" class="quarto-xref">Figure&nbsp;<span>2.6</span></a> B is that a different choice of breakpoints is used for the histogram, so that the histogram gives a rather different impression of the distribution of the data. Code for <a href="#fig-fig10" class="quarto-xref">Figure&nbsp;<span>2.6</span></a> B is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(possum, {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  here <span class="ot">&lt;-</span> sex <span class="sc">==</span> <span class="st">"f"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  dens <span class="ot">&lt;-</span> <span class="fu">density</span>(totlngth[here])</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  xlim <span class="ot">&lt;-</span> <span class="fu">range</span>(dens<span class="sc">$</span>x)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  ylim <span class="ot">&lt;-</span> <span class="fu">range</span>(dens<span class="sc">$</span>y)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(totlngth[here], <span class="at">breaks =</span> <span class="fl">72.5</span> <span class="sc">+</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> xlim, <span class="at">ylim =</span> ylim, <span class="at">xlab=</span><span class="st">"Total length"</span>, <span class="at">main=</span><span class="st">""</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(dens)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dotcharts-and-stripcharts" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="dotcharts-and-stripcharts">Dotcharts and stripcharts</h3>
<p>These can be a good alternative to barcharts. They have a much higher information to ink ratio! Try</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(islands)  <span class="co"># vector of named numeric values, in the datasets package</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Unfortunately there are many names, and there is substantial overlap. Either enlarge the graph to occupy a large display screen, or plot with perhaps <code>cex=0.5</code>, so that the names can be distinguished.</p>
<p>Note also stripcharts, obtained using <code>stripchart()</code>. Try, e.g.:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(decrease <span class="sc">~</span> treatment, <span class="at">log =</span> <span class="st">"x"</span>, <span class="at">data =</span> OrchardSprays)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="boxplots" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="boxplots">Boxplots</h3>
<p><a href="#fig-fig11" class="quarto-xref">Figure&nbsp;<span>2.7</span></a> shows a boxplot of the female possum lengths:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig11" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig11-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.7: Boxplot of female possum lengths, with additional labeling information
</figcaption>
</figure>
</div>
</div>
</div>
<p>Code for the boxplot, without the annotation, is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>totlngth <span class="ot">&lt;-</span> <span class="fu">subset</span>(DAAG<span class="sc">::</span>possum, sex<span class="sc">==</span><span class="st">"f"</span>)<span class="sc">$</span>totlngth</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(totlngth[here], <span class="at">horizontal=</span><span class="cn">TRUE</span>, <span class="at">xlab=</span><span class="st">"Total length (cm)"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rug</span>(totlngth, <span class="at">side=</span><span class="dv">1</span>)   <span class="co"># Add a 'rug' that shows the location of points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-fig11" class="quarto-xref">Figure&nbsp;<span>2.7</span></a> adds interpretative information. Also a ‘rug’, showing the location of individual data points, has been added.</p>
</section>
<section id="normal-probability-plots" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="normal-probability-plots">Normal probability plots</h3>
<p>Type <code>qqnorm(y)</code> to obtain a normal probability plot of the elements of <code>y</code>.<br>
The points of a normal probability plot will on average lie on a straight line if the distribution is Normal. In order to calibrate the eye to recognize plots that indicate non-normal variation, it is helpful to do several normal probability plots for random samples of the relevant size from a normal distribution. Look ahead to <a href="#fig-fig19" class="quarto-xref">Figure&nbsp;<span>2.12</span></a>, which uses the <em>lattice</em> function <code>qqmath()</code>, with a much more effective graph than is readily obtained using base graphics functions.</p>
</section>
</section>
<section id="scatterplot-smoothing" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="scatterplot-smoothing"><span class="header-section-number">2.5</span> Scatterplot smoothing</h2>
<p>The function <code>panel.smooth()</code> plots points, then adds a smooth curve through the points. As an example, consider the <code>MASS:forbes</code> data frame that has 17 observations of barometric pressure (<code>bp</code>, inches of mercury) and boiling point of water (<code>bp</code>, degrees Fahrenheit), at various locations in the Alps. <a href="#fig-fig13" class="quarto-xref">Figure&nbsp;<span>2.8</span></a> plots the data, and adds a smooth curve. A dashed line has been added for comparison.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig13" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig13-1.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.8: Boiling point of water, versus measured barometric pressure
</figcaption>
</figure>
</div>
</div>
</div>
<p>The parameter <code>span</code>, specifying the proportion of points that influence the smoothed value at each point, can be used to control the smoothness. The default is <span class="math inline">\(\frac{2}{3}\)</span>.</p>
</section>
<section id="sec-lattice" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="sec-lattice"><span class="header-section-number">2.6</span> Lattice graphics</h2>
<p>Lattice plots allow the use of the layout on the page to reflect meaningful aspects of data structure. The <em>lattice</em> package sits on top of the <em>grid</em> package. To use lattice graphics, both these packages must be installed.<br>
Providing it is installed, the <em>grid</em> package will be attached automatically when lattice is attached.</p>
<p>The <em>lattice</em> package has now to an extent been overtaken by the <em>ggplot2</em> package, with its richer and more complex language syntax. A number of packages have been built on top of <em>ggplot2</em>, aimed at providing specific types of graph, that allow users to work around much of the complexity. Functions in <em>lattice</em> and <em>ggplot2</em> return a graphics object, i.e., instructions for creating a plot, rather than a plot. This can be successively updated using the <code>update()</code> function, and/or new <em>layers</em> added, before using the generic <code>print()</code> (or <code>plot()</code> has the same effect) function or to produce a plot. Explicit use of <code>print()</code> or <code>plot()</code> is not required – all that is needed is to return type the object name on the command line, effectively sending its instructions to the command line.</p>
<p>The function name <code>print</code> emphasizes that the main part of the work required to produce a graph has already been done before the <code>print()</code> function is called – all that is then required is take the instructions that have been embedded in the graphics object and use them to show a graph on the screen or on the printed page. Readers who wish to pursue use of <em>ggplot2</em> and of packages built on <em>ggplot2</em> are referred to the extensive tutorial resources available on the web.</p>
<section id="examples-that-present-panels-of-scatterplots-using-xyplot" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="examples-that-present-panels-of-scatterplots-using-xyplot">Examples that Present Panels of Scatterplots – Using <code>xyplot()</code></h3>
<p>The basic function for creating panels of scatterplots is <code>xyplot()</code>. As an example, consider data, in the data frame <code>DAAG::tinting</code>, that are from an experiment that investigated the effects of tinting of car windows on visual recognition performance, primarily for visual recognition tasks that would be performed through side windows. Variables are <code>csoa</code> (critical stimulus onset asynchrony, i.e.&nbsp;the time in milliseconds required to recognize an alphanumeric target), <code>it</code> (inspection time, i.e., the time required for a simple discrimination task) and <code>age</code>, with ordered factors <code>tint</code> (level of tinting: <code>no</code>, <code>lo</code>, <code>hi</code>), <code>target</code> (<code>contrast</code>: <code>locon</code>, <code>hicon</code>), and <code>agegp</code> (1 = young, in the early 20s; 2 = an older participant, in the early 70s), and the factor <code>sex</code> (1 = male, 2 = female). <a href="#fig-fig16" class="quarto-xref">Figure&nbsp;<span>2.9</span></a> shows the style of graph that one can get from xyplot(). The different symbols are different contrasts.</p>
<div class="cell">
<pre><code>Loading required package: lattice</code></pre>
<div class="cell-output-display">
<div id="fig-fig16" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig16-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.9: cap16
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Code</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latticeExtra)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(csoa <span class="sc">~</span> it <span class="sc">|</span> sex <span class="sc">*</span> agegp, <span class="at">data =</span> DAAG<span class="sc">::</span>tinting, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">panel =</span> panel.superpose, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> target, <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">columns =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Addition of the argument <code>groups=target</code> has the result that two different colors of symbol are used to distinguish between low contrast and high contrast targets. To use different symbols, add an argument in the style of <code>par.settings=simpleTheme(pch=c(1,16))</code>. Additionally, or instead, it would make sense to use lighter and darker colors for the two levels of contrast. Code is easier to follow if one starts with the graphics object needed for <a href="#fig-fig16" class="quarto-xref">Figure&nbsp;<span>2.9</span></a> and then updates it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>gph <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(csoa <span class="sc">~</span> it <span class="sc">|</span> sex <span class="sc">*</span> agegp, <span class="at">data =</span> DAAG<span class="sc">::</span>tinting, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel =</span> panel.superpose, <span class="at">groups =</span> target)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(gph, <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">columns =</span> <span class="dv">2</span>),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span><span class="fu">simpleTheme</span>(<span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"lightblue3"</span>,<span class="st">"blue"</span>)))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># As the result goes to the command line, it is `printed`</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(gph, <span class="at">groups =</span> target, <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">columns =</span> <span class="dv">2</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span><span class="fu">simpleTheme</span>(<span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"lightblue3"</span>,<span class="st">"blue"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A striking feature is that the very high values, for both csoa and it, occur only for elderly males. It is apparent that the long response times for some of the elderly males occur, as we might have expected, with the low contrast target.</p>
<p><a href="#fig-fig17" class="quarto-xref">Figure&nbsp;<span>2.10</span></a> puts smooth curves through the data, separately for the two target types:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(csoa<span class="sc">~</span>it<span class="sc">|</span>sex<span class="sc">*</span>agegp, <span class="at">data=</span>DAAG<span class="sc">::</span>tinting, <span class="at">groups=</span>target, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">type=</span><span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig17" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig17-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.10: Smooth curves have been added to the plots, separately for the two types of target
</figcaption>
</figure>
</div>
</div>
</div>
<p>The relationship between <code>csoa</code> and <code>it</code> seems much the same for both levels of contrast. Finally, we do a plot (<a href="#fig-fig18" class="quarto-xref">Figure&nbsp;<span>2.11</span></a>) that uses different symbols (in black and white) for different levels of tinting. The longest times are for the high level of tinting.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig18" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig18-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.11: Panels show ``csoa versus it, for each combination of females/males and elderly/young. The different levels of tinting (no, +=low, &gt;=high) are shown with different symbols.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Code</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">xyplot</span>(csoa <span class="sc">~</span> it <span class="sc">|</span> sex <span class="sc">*</span> agegp, <span class="at">data =</span> DAAG<span class="sc">::</span>tinting,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> tint, <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">columns =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-columns-in-parallel" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="plotting-columns-in-parallel">Plotting columns in parallel</h3>
<p>Use the parameter outer to control whether the columns appear on the same or separate panels. If on the same panel, it is desirable to use auto.key to give a simple key. The following use the dataset <code>grog</code> from the <em>DAAGxtras</em> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(Beer<span class="sc">+</span>Spirit<span class="sc">+</span>Wine <span class="sc">~</span> Year <span class="sc">|</span> Country, <span class="at">outer=</span><span class="cn">TRUE</span>,  </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>grog) </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(Beer<span class="sc">+</span>Spirit<span class="sc">+</span>Wine <span class="sc">~</span> Year, <span class="at">groups=</span>Country, <span class="at">outer=</span><span class="cn">TRUE</span>,  </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>grog) </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(Beer<span class="sc">+</span>Spirit<span class="sc">+</span>Wine <span class="sc">~</span> Year <span class="sc">|</span> Country, <span class="at">outer=</span><span class="cn">FALSE</span>,  </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>grog, <span class="at">auto.key=</span><span class="fu">list</span>(<span class="at">columns=</span><span class="dv">3</span>), </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">par.settings=</span><span class="fu">simpleTheme</span>(<span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="dv">2</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the final plot, note the use of simpleTheme() as a simple mechanism for controlling common parameter settings. Use of the parameter par.settings makes the change for the current plot only. Use trellis.par.set() to make the changes for the duration of the current device, unless reset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Fixed, sliced and free scales</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>jobs <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>jobs</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="do">## scale="fixed" </span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(BC<span class="sc">+</span>Alberta <span class="sc">~</span> Date, <span class="at">data=</span>jobs, <span class="at">outer=</span><span class="cn">TRUE</span>) </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="do">## scale="sliced" - different slices of same scale </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(BC<span class="sc">+</span>Alberta <span class="sc">~</span> Date, <span class="at">data=</span>jobs, <span class="at">outer=</span><span class="cn">TRUE</span>, </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">"sliced"</span>)) ) </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="do">## scale="free" - independent scales </span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(BC<span class="sc">+</span>Alberta <span class="sc">~</span> Date, <span class="at">data=</span>jobs, <span class="at">outer=</span><span class="cn">TRUE</span>, </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">"free"</span>)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-compared-with-simulated-normal-data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="data-compared-with-simulated-normal-data">Data, compared with simulated normal data</h3>
<section id="is-the-sample-data-consistent-with-random-normal-data" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="is-the-sample-data-consistent-with-random-normal-data">Is the sample data consistent with random normal data?</h4>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig19" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig19-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.12: Normal probability plots. If data are from a normal distribution then points should fall, on average, along a line. The plot in the top left shows the 43 lengths of female possums. The other plots are for independent normal random samples of size 43.
</figcaption>
</figure>
</div>
</div>
</div>
<p>There is one unusually small value. Otherwise the points for the female possum lengths are as close to a straight line as in many of the plots for random normal data. Code is:</p>
<p>The idea is an important one. In order to judge whether data are normally distributed, examine a number of randomly generated samples of the same size from a normal distribution. It is a way to train the eye, to give an idea of the extent to which departures from linearity may be explained as random variation The mean and standard deviation is best matched to that of the data that are under investigation.</p>
<p>For comparison, for readers who are interested, here is code that plots the same data using base graphics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.8</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">3.1</span>,<span class="fl">3.6</span>,<span class="fl">2.6</span>,<span class="fl">1.6</span>))             <span class="co"># A 2 by 4 layout of plots</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>gps <span class="ot">&lt;-</span> <span class="fu">unique</span>(dat<span class="sc">$</span>gp)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (val <span class="cf">in</span> gps){</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">subset</span>(dat, gp<span class="sc">==</span>val)<span class="sc">$</span>y</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(x, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">"Length"</span>, <span class="at">main=</span>levs)  </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="adding-new-layers" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-new-layers">Adding new layers</h3>
<p>The <em>latticeExtra</em> package provides wide-ranging abilities for overlaying or underlaying an existing graphics object. Or, given an initial graphics object, a separate graphics object can be converted to a layer that is then added to the initial object.</p>
<p>In each instance, conditioning variables can be added. In most cases, a groups parameter can be specified, i.e., the plot is repeated for the groupings within the one panel. The data on athletes in the Australian Institute of Sport, in the dataset <code>DAAG::ais</code> will be used for the example that now follows. The following show haemoglobin count versus red blood cell count, distinguished by sport within panel, with separate panels for females and males:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latticeExtra)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>aisBS <span class="ot">&lt;-</span> <span class="fu">subset</span>(DAAG<span class="sc">::</span>ais, sport <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"B_Ball"</span>, <span class="st">"Swim"</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>basic1 <span class="ot">&lt;-</span>  <span class="fu">xyplot</span>(hc <span class="sc">~</span> rcc <span class="sc">|</span> sex, <span class="at">groups=</span>sport[<span class="at">drop=</span><span class="cn">TRUE</span>],  <span class="at">data=</span>aisBS)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>basic2 <span class="ot">&lt;-</span> <span class="fu">update</span>(basic1,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">par.settings=</span><span class="fu">simpleTheme</span>(<span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="fl">1.5</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot characters 1 and 3 distinguish the groups</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip=</span><span class="fu">strip.custom</span>(<span class="at">factor.levels=</span><span class="fu">c</span>(<span class="st">"Female"</span>,<span class="st">"Male"</span>)),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Label the panels "Female" and "Male", not "f" and "m"</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">scales=</span><span class="fu">list</span>(<span class="at">tck=</span><span class="fl">0.5</span>), <span class="at">auto.key=</span><span class="fu">list</span>(<span class="at">columns=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Printing the object <code>basic1</code> would give a very basic plot. The object <code>basic2</code> sets separate line types for males and females, creates thicker lines, specefies strip level names that are different from the group level names, reduces the length of the axis ticks, and adds a key.</p>
<p>The <code>xyplot()</code> function has provision for the addition of separate lines for the two sports, but not for the parallel lines that are preferred. The following creates a new layer. The values <code>x</code> and <code>y</code> will be taken from the data used for the object <code>basic1</code>, when the new layer is added. Code for the new layer is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>layer2 <span class="ot">&lt;-</span> <span class="fu">layer</span>(parallel.fit <span class="ot">&lt;-</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">fitted</span>(<span class="fu">lm</span>(y <span class="sc">~</span> groups[subscripts] <span class="sc">+</span> x)),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">panel.superpose</span>(x, parallel.fit, <span class="at">type =</span> <span class="st">"r"</span>, ...))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following <code>print</code>s the graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>basic2<span class="sc">+</span>layer2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig20" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig20-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.13: paste(cap20)
</figcaption>
</figure>
</div>
</div>
</div>
<pre><code>### An incomplete list of _lattice_ Functions  {-}
splom( ~ data.frame)                    # Scatterplot matrix
bwplot(factor ~ numeric , . .)          # Box and whisker plot
qqnorm(numeric , . .)           # normal probability plots
dotplot(factor ~ numeric , . .)         # 1-dim. Display
stripplot(factor ~ numeric , . .)       # 1-dim. Display
barchart(character ~ numeric , . .)
histogram( ~ numeric , . .)
densityplot( ~ numeric , . .)           # Smoothed version of histogram
qqmath(numeric ~ numeric , . .)         # QQ plot
splom( ~ dataframe, . .)            # Scatterplot matrix  
parallel( ~ dataframe, . .)     # Parallel coordinate plots
cloud(numeric ~ numeric * numeric, . .)           # 3-D plot
contourplot(numeric ~ numeric * numeric, . .)   # Contour plot
levelplot(numeric ~ numeric * numeric, . .)       # Contour plot variant</code></pre>
</section>
</section>
<section id="using-mathematical-expressions-in-plots" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="using-mathematical-expressions-in-plots"><span class="header-section-number">2.7</span> Using mathematical expressions in plots</h2>
<p>The following is a simple example. For this purpose, an expression has a much extended syntax, relative to that for a mathematical expression. See <code>?plotmath</code>.</p>
<p>`</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig21" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="graphs_files/figure-html/fig-fig21-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.14: Examples where one or both axis labels are mathematical expressions,
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.8</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> pi<span class="sc">*</span>r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r, y, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="st">"Radius = "</span><span class="sc">*</span>r), <span class="at">ylab=</span><span class="fu">expression</span>(Area <span class="sc">==</span> pi<span class="sc">*</span><span class="er">~</span>r<span class="sc">^</span><span class="er">~</span><span class="dv">2</span>))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="fu">expression</span>(<span class="st">"A: Plot of Area = "</span><span class="sc">*</span>pi<span class="sc">*</span><span class="er">~</span>r<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span><span class="st">" vs Radius = "</span><span class="sc">*</span>r))</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">log</span>(x<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>x)), <span class="at">from=</span><span class="fl">0.01</span>, <span class="at">to=</span><span class="fl">0.99</span>, <span class="at">xlab=</span><span class="fu">expression</span>(pi),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">log</span>(<span class="fu">frac</span>(pi,<span class="dv">1</span><span class="sc">-</span>pi))))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="fu">expression</span>(<span class="st">"B: Plot of "</span><span class="sc">*</span><span class="fu">log</span>(<span class="fu">frac</span>(pi,<span class="dv">1</span><span class="sc">-</span>pi))<span class="sc">*</span><span class="st">" against "</span><span class="sc">*</span>pi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For <em>lattice</em> and <em>ggplot2</em> graphics as well as base graphics, expressions of the type shown can appear anywhere in place of a character vector.</p>
<p>Notice that in <code>ylab = expression(Area == pi*r^2)</code>, there is a double equals sign (<code>==</code>), although what will appear on the plot has a single equals sign. See <code>?plotmath</code> for detailed information on the plotting of mathematical expressions. Notice that <code>*</code> juxtaposes both text and mathematical symbols. Notice also that <code>~</code> been used to insert space before <span class="math inline">\(r\)</span> and <code>phantom(,)</code> between <span class="math inline">\(r\)</span> and the superscript 2. The final plot from <code>demo(graphics)</code> demonstrates some of the possibilities for plotting mathematical symbols.</p>
</section>
<section id="guidelines-for-graphs" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="guidelines-for-graphs"><span class="header-section-number">2.8</span> Guidelines for Graphs</h2>
<p>Design graphs to make their point tersely and clearly, with a minimum waste of ink. Label as necessary to identify important features. In scatterplots the graph should attract the eye’s attention to the points that are plotted, and to important grouping in the data. Use solid points, large enough to stand out relative to other features, when there is little or no overlap.<br>
When there is extensive overlap of plotting symbols, use open plotting symbols. Where points are dense, overlapping points will give a high ink density, which is exactly what one wants.<br>
Use scatterplots in preference to bar or related graphs whenever the horizontal axis represents a quantitative effect.<br>
Use graphs from which information can be read directly and easily in preference to those that rely on visual impression and perspective. Thus in scientific papers contour plots are much preferable to surface plots or two-dimensional bar graphs.<br>
Draw graphs so that reduction and reproduction will not interfere with visual clarity.<br>
Explain clearly how error bars should be interpreted — SE limits, 95% confidence interval, 2 SD limits, or whatever. Explain what source of error(s) is represented.<br>
It is pointless to present information on a source of error that is of little or no interest, for example analytical error when the relevant source of `error’ for comparison of treatments is between fruit.<br>
Use colour or different plotting symbols to distinguish different groups. Take care to use colours that contrast.</p>
</section>
<section id="exercises" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="exercises"><span class="header-section-number">2.9</span> Exercises</h2>
<ol type="1">
<li>The data set <code>huron</code> that accompanies these notes has mean July average water surface elevations, in feet, IGLD (1955) for Harbor Beach, Michigan, on Lake Huron, Station 5014, for 1860-1986 . (Alternatively work with the vector <code>LakeHuron</code> from the datasets package, that has mean heights for 1875-1972 only.)<br>
</li>
</ol>
<ol type="a">
<li>Plot mean.height against year.<br>
</li>
<li>Use the identify function to label points for the years that correspond to the lowest and highest mean levels. That is, type</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">identify</span>(huron<span class="sc">$</span>year,huron<span class="sc">$</span>mean.height,<span class="at">labels=</span>huron<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and use the left mouse button to click on the lowest point and highest point on the plot. To quit, press (depending on the operating system) a mouse button other than the left, or press ESC.<br>
c) As in the case of many time series, the mean levels are correlated from year to year. To see how each year’s mean level is related to the previous year’s mean level, use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(huron<span class="sc">$</span>mean.height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This plots the mean level at year i against the mean level at year i-1.</p>
<ol start="2" type="1">
<li><p>Plot the graph of <code>log(brain weight)</code> versus <code>log(body weight)</code>, for the data set Animals from the MASS package. Use the row labels to label the points corresponding to the three clear outliers.</p></li>
<li><p>Check the distributions of head lengths (<code>hdlngth</code>) in the possum data set that accompanies these notes. Compare the following forms of display:</p></li>
</ol>
<ol type="a">
<li>a histogram (<code>hist(possum$hdlngth)</code>);<br>
</li>
<li>a stem and leaf plot (<code>stem(possum$hdlngth)</code>);</li>
<li>a normal probability plot (<code>qqnorm(possum$hdlngth)</code>); and</li>
<li>a density plot (<code>plot(density(possum$hdlngth))</code>). What are the advantages and disadvantages of these different forms of display?</li>
</ol>
<ol start="4" type="1">
<li><p>Try <code>x &lt;- rnorm(10)</code>. Print out the numbers that you get. Look up the help for rnorm. Now generate a sample of size 10 from a normal distribution with mean 170 and standard deviation 4.</p></li>
<li><p>Use <code>mfrow()</code> to set up the layout for a 3 by 4 array of plots. In the top 4 rows, show normal probability plots for four separate `random’ samples of size 10, all from a normal distribution. In the middle 4 rows, display plots for samples of size 100. In the bottom four rows, display plots for samples of size 1000. Comment on how the appearance of the plots changes as the sample size changes.</p></li>
<li><p>The function <code>runif()</code> generates a sample from a uniform distribution, by default on the interval 0 to 1. Try <code>x &lt;- runif(10)</code>, and print out the numbers you get. Then repeat exercise 6 above, but taking samples from a uniform distribution rather than from a normal distribution. What shape do the points follow?</p></li>
</ol>
<p>*7. If you find exercise 6 interesting, you might like to try it for some further distributions. For example <code>x &lt;- rchisq(10,1)</code> will generate 10 random values from a chi-squared distribution with degrees of freedom 1. The statement <code>x &lt;- rt(10,1)</code> will generate 10 random values from a <span class="math inline">\(t\)</span> distribution with degrees of freedom one. Make normal probability plots for samples of various sizes from these distributions.</p>
<ol start="8" type="1">
<li><p>For the first two columns of the data frame hills, examine the distribution using: (a) histogram; (b) density plots; (c) normal probability plots.<br>
Repeat (a), (b) and (c), now working with the logarithms of the data values.</p></li>
<li><p>This and remaining exercises ask for the use of <em>lattice</em> functions. The following data gives milk volume (g/day) for smoking and nonsmoking mothers :</p></li>
</ol>
<pre><code>  Smoking Mothers:    621, 793,  593,  545, 753, 655, 895, 767, 714, 598, 693
  Nonsmoking Mothers: 947, 945, 1086, 1202, 973, 981, 930, 745, 903, 899, 961</code></pre>
<p>Present the data (i) in side by side boxplots (use <code>bwplot()</code>); (ii) using a dotplot form of display (use <code>dotplot()</code>).</p>
<ol start="10" type="1">
<li>For the <code>possum</code> data set, use <em>lattice</em> functions to generate the following plots:<br>
</li>
</ol>
<ol type="a">
<li>histograms of <code>hdlngth</code> – use <code>histogram()</code>;<br>
</li>
<li>normal probability plots of <code>hdlngth</code> – use <code>qqmath()</code>;<br>
</li>
<li>density plots of <code>hdlngth</code> – use <code>densityplot()</code>. Investigate the effect of varying the density bandwidth (<code>bw</code>).</li>
</ol>
<ol start="11" type="1">
<li>The following exercises, all using <em>lattice</em> functions, relate to the data frame <code>DAAG::possum</code>:<br>
</li>
</ol>
<ol type="a">
<li>Using <code>xyplot()</code>, explore the relation between <code>hdlngth</code> and <code>totlngth</code>, taking into account <code>sex</code> and <code>Pop</code>.<br>
</li>
<li>Construct a contour plot of <code>chest</code> versus <code>belly</code> and <code>totlngth</code> – use <code>levelplot()</code> or <code>contourplot()</code>.<br>
</li>
<li>Construct box and whisker plots for <code>hdlngth</code>, using <code>site</code> as a factor.<br>
</li>
<li>Use <code>qqmath()</code> to construct normal probability plots for <code>hdlgth</code>, for each separate level of <code>sex</code> and <code>Pop</code>. Does it appear that the distribution of <code>hdlgth</code> varies with the level of these other factors.</li>
</ol>
<ol start="12" type="1">
<li>The dataframe <code>airquality</code> (<em>datasets</em> package) has columns <code>Ozone</code>, <code>Solar.R</code>, <code>Wind</code>, <code>Temp</code>, <code>Month</code> and <code>Day</code>. Use <code>xyplot()</code> to plot <code>Ozone</code> against <code>Solar.R</code> for each of the three temperature ranges, and for each of three wind ranges.</li>
</ol>
</section>
<section id="references-and-reading" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="references-and-reading"><span class="header-section-number">2.10</span> References and reading</h2>
<p>The web page https://www.eecs.yorku.ca/~papaggel/courses/eecs6414/index.html<br>
has links to many different collections of information on statistical graphics.</p>
<p><span class="citation" data-cites="Chang_2013">Chang (<a href="references.html#ref-Chang_2013" role="doc-biblioref">2013</a>)</span> . R graphics cookbook. O’Reilly.</p>
<p><span class="citation" data-cites="Murrell">Murrell (<a href="references.html#ref-Murrell" role="doc-biblioref">2011</a>)</span> . R Graphics. Chapman and Hall/CRC.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Chang_2013" class="csl-entry" role="listitem">
Chang, Winston. 2013. <em>R Graphics Cookbook</em>. 1st ed. O’Reilly.
</div>
<div id="ref-Murrell" class="csl-entry" role="listitem">
Murrell, Paul. 2011. <em>R Graphics</em>. 2nd ed. Chapman; Hall/CRC. <a href="http://www.e-reading.org.ua/bookreader.php/137370/Murrell_-_R_Graphics.pdf">http://www.e-reading.org.ua/bookreader.php/137370/Murrell_-_R_Graphics.pdf</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./basics.html" class="pagination-link  aria-label=" &lt;span="" overview="" of="" the="" r="" system&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An overview of the R system</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./reg.html" class="pagination-link" aria-label="<span class='chapter-number'>3</span>&nbsp; <span class='chapter-title'>Multiple Linear Regression</span>">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>
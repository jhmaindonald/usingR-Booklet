<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Using R for Data Analysis and Graphics - 1&nbsp; An overview of the R system</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./graphs.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./basics.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An overview of the R system</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Using R for Data Analysis and Graphics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An overview of the R system</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Base R Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GLMandA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Generalized Linear and Additive Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regular Time Series in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tree-based models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mva.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Level Models and Repeated Measures Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-typing" id="toc-sec-typing" class="nav-link active" data-scroll-target="#sec-typing"><span class="header-section-number">1.1</span> Learn by typing at the command line</a>
  <ul class="collapse">
  <li><a href="#base-recommended-and-other-packages" id="toc-base-recommended-and-other-packages" class="nav-link" data-scroll-target="#base-recommended-and-other-packages">Base, recommended, and other packages</a></li>
  <li><a href="#some-ways-to-use-r" id="toc-some-ways-to-use-r" class="nav-link" data-scroll-target="#some-ways-to-use-r">Some ways to use R</a></li>
  <li><a href="#r-makes-it-easy-to-create-plots-and-other-forms-of-data-summary" id="toc-r-makes-it-easy-to-create-plots-and-other-forms-of-data-summary" class="nav-link" data-scroll-target="#r-makes-it-easy-to-create-plots-and-other-forms-of-data-summary">R makes it easy to create plots and other forms of data summary</a></li>
  </ul></li>
  <li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors"><span class="header-section-number">1.2</span> Vectors</a></li>
  <li><a href="#lists-with-dataframes-as-an-important-special-case" id="toc-lists-with-dataframes-as-an-important-special-case" class="nav-link" data-scroll-target="#lists-with-dataframes-as-an-important-special-case"><span class="header-section-number">1.3</span> Lists, with dataframes as an important special case</a>
  <ul class="collapse">
  <li><a href="#dataframes-are-lists" id="toc-dataframes-are-lists" class="nav-link" data-scroll-target="#dataframes-are-lists">Dataframes are lists!</a></li>
  <li><a href="#lists-more-generally" id="toc-lists-more-generally" class="nav-link" data-scroll-target="#lists-more-generally">Lists more generally</a></li>
  </ul></li>
  <li><a href="#factors-dates-nas-and-more" id="toc-factors-dates-nas-and-more" class="nav-link" data-scroll-target="#factors-dates-nas-and-more"><span class="header-section-number">1.4</span> Factors, dates, <code>NA</code>s, and more</a>
  <ul class="collapse">
  <li><a href="#factors-and-ordered-factors" id="toc-factors-and-ordered-factors" class="nav-link" data-scroll-target="#factors-and-ordered-factors">Factors and ordered factors</a></li>
  <li><a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates">Dates</a></li>
  <li><a href="#nas-missing-values-nan-not-a-number-and-inf" id="toc-nas-missing-values-nan-not-a-number-and-inf" class="nav-link" data-scroll-target="#nas-missing-values-nan-not-a-number-and-inf"><code>NA</code>s (missing Values), <code>NaN</code> (not a number) and <code>Inf</code></a></li>
  </ul></li>
  <li><a href="#matrices-and-arrays" id="toc-matrices-and-arrays" class="nav-link" data-scroll-target="#matrices-and-arrays"><span class="header-section-number">1.5</span> Matrices and arrays</a>
  <ul class="collapse">
  <li><a href="#arrays" id="toc-arrays" class="nav-link" data-scroll-target="#arrays">Arrays</a></li>
  </ul></li>
  <li><a href="#sec-entry" id="toc-sec-entry" class="nav-link" data-scroll-target="#sec-entry"><span class="header-section-number">1.6</span> Data entry and editing</a></li>
  <li><a href="#r-objects-the-workspace-and-attached-packages" id="toc-r-objects-the-workspace-and-attached-packages" class="nav-link" data-scroll-target="#r-objects-the-workspace-and-attached-packages"><span class="header-section-number">1.7</span> R objects, the workspace, and attached packages</a>
  <ul class="collapse">
  <li><a href="#the-function-with" id="toc-the-function-with" class="nav-link" data-scroll-target="#the-function-with">The function <code>with()</code></a></li>
  <li><a href="#saving-the-workspace" id="toc-saving-the-workspace" class="nav-link" data-scroll-target="#saving-the-workspace">Saving the workspace</a></li>
  <li><a href="#functions-and-datasets-one-at-a-time-or-per-database" id="toc-functions-and-datasets-one-at-a-time-or-per-database" class="nav-link" data-scroll-target="#functions-and-datasets-one-at-a-time-or-per-database">Functions and datasets – one at a time, or per database?</a></li>
  </ul></li>
  <li><a href="#sec-loop" id="toc-sec-loop" class="nav-link" data-scroll-target="#sec-loop"><span class="header-section-number">1.8</span> Functions in R</a>
  <ul class="collapse">
  <li><a href="#looping-the-for-function" id="toc-looping-the-for-function" class="nav-link" data-scroll-target="#looping-the-for-function">Looping – the <code>for()</code> function</a></li>
  <li><a href="#function-syntax-and-semantics" id="toc-function-syntax-and-semantics" class="nav-link" data-scroll-target="#function-syntax-and-semantics">Function syntax and semantics</a></li>
  <li><a href="#common-useful-functions" id="toc-common-useful-functions" class="nav-link" data-scroll-target="#common-useful-functions">Common Useful Functions</a></li>
  <li><a href="#the-functions-sapply-lapply-apply-and-tapply" id="toc-the-functions-sapply-lapply-apply-and-tapply" class="nav-link" data-scroll-target="#the-functions-sapply-lapply-apply-and-tapply">The functions <code>sapply()</code>, <code>lapply()</code>, <code>apply()</code>, and <code>tapply()</code></a></li>
  <li><a href="#issues-for-the-writing-and-use-of-functions" id="toc-issues-for-the-writing-and-use-of-functions" class="nav-link" data-scroll-target="#issues-for-the-writing-and-use-of-functions">Issues for the Writing and Use of Functions</a></li>
  </ul></li>
  <li><a href="#making-tables" id="toc-making-tables" class="nav-link" data-scroll-target="#making-tables"><span class="header-section-number">1.9</span> Making Tables</a></li>
  <li><a href="#pipes-a-do-this-then-do-that-syntax" id="toc-pipes-a-do-this-then-do-that-syntax" class="nav-link" data-scroll-target="#pipes-a-do-this-then-do-that-syntax"><span class="header-section-number">1.10</span> Pipes – A “do this, then do that” syntax</a>
  <ul class="collapse">
  <li><a href="#pipe-to-several-functions-or-to-a-later-argument-than-the-first" id="toc-pipe-to-several-functions-or-to-a-later-argument-than-the-first" class="nav-link" data-scroll-target="#pipe-to-several-functions-or-to-a-later-argument-than-the-first">Pipe to several functions, or to a later argument than the first</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">1.11</span> Methods</a></li>
  <li><a href="#some-further-programming-niceties" id="toc-some-further-programming-niceties" class="nav-link" data-scroll-target="#some-further-programming-niceties"><span class="header-section-number">1.12</span> Some Further Programming Niceties</a>
  <ul class="collapse">
  <li><a href="#extracting-arguments-to-functions" id="toc-extracting-arguments-to-functions" class="nav-link" data-scroll-target="#extracting-arguments-to-functions">Extracting Arguments to Functions</a></li>
  <li><a href="#parsing-and-evaluation-of-expressions" id="toc-parsing-and-evaluation-of-expressions" class="nav-link" data-scroll-target="#parsing-and-evaluation-of-expressions">Parsing and Evaluation of Expressions</a></li>
  </ul></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps"><span class="header-section-number">1.13</span> Next steps</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">1.14</span> Exercises</a></li>
  <li><a href="#references-and-reading" id="toc-references-and-reading" class="nav-link" data-scroll-target="#references-and-reading"><span class="header-section-number">1.15</span> References and reading</a>
  <ul class="collapse">
  <li><a href="#references-to-packages" id="toc-references-to-packages" class="nav-link" data-scroll-target="#references-to-packages">References to packages</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An overview of the R system</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-typing" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sec-typing"><span class="header-section-number">1.1</span> Learn by typing at the command line</h2>
<p>This document mostly assumes that users will type commands into the <em>command window</em>, at the command line prompt. The command line prompt, i.e.&nbsp;the <code>&gt;</code>, is an invitation to start typing in commands. For example, type <code>2+2</code> and press the <strong>Enter</strong> key. Here is what appears on the screen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here the result is 4. The <code>[1]</code> says, a little strangely, “first requested element will follow”. Here, there is just one element. The <code>&gt;</code> indicates that R is ready for another command.</p>
<p>For later reference, note that the exit or quit command is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">q</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An alternative to the use of <code>q()</code> is to click on the <strong>File</strong> menu and then on <strong>Exit</strong>. There will be a message asking whether to save the workspace image. Clicking <strong>Yes</strong> (the safe option) will save all the objects that remain in the workspace — any that remain from the start of the session and any that have been added since. RStudio users can click on one of the options that are available under the <strong>Session</strong> menu header.</p>
<p>The <em>workspace</em> is the name given to a <em>database</em> (as it is called) that holds objects (datasets and functions) that have been created or copied in by the user, and have not been subsequently deleted. Depending on session settings, these may add to objects that were saved from a previous session and re-loaded at startup.</p>
<section id="some-notational-details" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="some-notational-details">Some notational details</h4>
<p>As noted earlier, the command line prompt is</p>
<pre><code>&gt;</code></pre>
<p>R commands (expressions) are typed following this prompt.</p>
<p>There is also a continuation prompt, used when, following a carriage return, the command is still not complete. By default, the continuation prompt is</p>
<pre><code>+</code></pre>
<p>In these notes, we often continue commands over more than one line, but omit the <code>+</code> that will appear on the commands window if the command is typed in as we show it.</p>
<p>For the names of R objects or commands, case is significant. Thus <code>Austpop</code> is different from <code>austpop</code>. For file names when using Windows, however, the Microsoft Windows conventions apply, and case does not distinguish file names. On Unix and Mac systems, letters that have a different case are treated as different.</p>
<p>Anything that follows <code>#</code> on the command line is taken as comment.</p>
<p><em>Note:</em> Recall that, in order to quit from the R session we could type <code>q()</code>. This is because <code>q</code> is a function. Typing <code>q</code> on its own, without the parentheses, displays the text of the function on the screen. Try it!</p>
</section>
<section id="base-recommended-and-other-packages" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="base-recommended-and-other-packages">Base, recommended, and other packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Base packages</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">which</span>(<span class="fu">installed.packages</span>()[ ,<span class="st">"Priority"</span>] <span class="sc">==</span> <span class="st">"base"</span>, ))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">"base"</span>      <span class="st">"compiler"</span>  <span class="st">"datasets"</span>  <span class="st">"graphics"</span>  <span class="st">"grDevices"</span> <span class="st">"grid"</span>     </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">"methods"</span>   <span class="st">"parallel"</span>  <span class="st">"splines"</span>   <span class="st">"stats"</span>     <span class="st">"stats4"</span>    <span class="st">"tcltk"</span>    </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] <span class="st">"tools"</span>     <span class="st">"utils"</span>    </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Recommended packages</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">which</span>(<span class="fu">available.packages</span>(<span class="at">repos =</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cran.r-project.org"</span>))[ ,<span class="st">"Priority"</span>] <span class="sc">==</span> <span class="st">"recommended"</span>, ))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">"boot"</span>       <span class="st">"class"</span>      <span class="st">"cluster"</span>    <span class="st">"codetools"</span>  <span class="st">"foreign"</span>   </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>] <span class="st">"KernSmooth"</span> <span class="st">"lattice"</span>    <span class="st">"MASS"</span>       <span class="st">"Matrix"</span>     <span class="st">"mgcv"</span>      </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] <span class="st">"nlme"</span>       <span class="st">"nnet"</span>       <span class="st">"rpart"</span>      <span class="st">"spatial"</span>    <span class="st">"survival"</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Packages that do not come with the initial distribution must be downloaded and installed separately. A number of packages are by default attached at startup. Names of packages (additional to <em>base</em>) that are by default attached at startup can be checked thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getOption</span>(<span class="st">'defaultPackages'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"datasets"</span>  <span class="st">"utils"</span>     <span class="st">"grDevices"</span> <span class="st">"graphics"</span>  <span class="st">"stats"</span>     <span class="st">"methods"</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To see which packages have been attached at any point in a session, type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These may, if earlier session was saved upon quitting and restored on startup for the current session, include packages that were attached in the earlier session.</p>
<p>It pays to have a separate working directory for each major project. RStudio makes it straightforward, both to set up a new project in a new directory, and to move between projects.</p>
</section>
<section id="some-ways-to-use-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="some-ways-to-use-r">Some ways to use R</h3>
<section id="r-may-be-used-as-a-calculator." class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="r-may-be-used-as-a-calculator.">R may be used as a calculator.</h4>
<p>R evaluates and prints out the result of any expression that one types in at the command line in the console window. Expressions are typed following the prompt (<code>&gt;</code>) on the screen. The result, if any, appears on subsequent lines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">4</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">10</span>)                 <span class="co"># Type ?sqrt to see help for `sqrt`</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">3.162278</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="dv">3</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span><span class="dv">5</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">120</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1000</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">+0.045</span>)<span class="sc">^</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">1000</span>  <span class="co"># Interest on $1000, compounded annually </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">246.1819</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># at 4.5% p.a. for five years</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>pi  <span class="co"># R knows about pi</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">3.141593</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">6378</span> <span class="co">#Circumference of Earth at Equator, in km; radius is 6378 km</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">40074.16</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>deg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">90</span>)  </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save the numeric vector `c(30,60,90)` with the name `deg`</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="fu">sin</span>(deg<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>)          <span class="co"># Convert angles to radians, then take sin()</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5000000</span> <span class="fl">0.8660254</span> <span class="fl">1.0000000</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">sin</span>(<span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">90</span>)<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>)  <span class="co"># The result is the same</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5000000</span> <span class="fl">0.8660254</span> <span class="fl">1.0000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observe that <code>c()</code> is a function that joins vectors together</p>
</section>
</section>
<section id="r-makes-it-easy-to-create-plots-and-other-forms-of-data-summary" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="r-makes-it-easy-to-create-plots-and-other-forms-of-data-summary">R makes it easy to create plots and other forms of data summary</h3>
<p>As a relatively simple example, where all columns are numeric, consider the data frame <code>austpop</code> that holds population figures (in thousands) for Australian states and territories, and total population, at various times since 1917. Assuming that the <em>DAAG</em> package has been installed, this can be accessed as <code>DAAG::austpop</code>. The data are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>austpop <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>austpop</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(austpop)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  year  NSW  Vic  Qld   SA  WA Tas NT ACT  Aust</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">1917</span> <span class="dv">1904</span> <span class="dv">1409</span>  <span class="dv">683</span>  <span class="dv">440</span> <span class="dv">306</span> <span class="dv">193</span>  <span class="dv">5</span>   <span class="dv">3</span>  <span class="dv">4941</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">1927</span> <span class="dv">2402</span> <span class="dv">1727</span>  <span class="dv">873</span>  <span class="dv">565</span> <span class="dv">392</span> <span class="dv">211</span>  <span class="dv">4</span>   <span class="dv">8</span>  <span class="dv">6182</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">1937</span> <span class="dv">2693</span> <span class="dv">1853</span>  <span class="dv">993</span>  <span class="dv">589</span> <span class="dv">457</span> <span class="dv">233</span>  <span class="dv">6</span>  <span class="dv">11</span>  <span class="dv">6836</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">1947</span> <span class="dv">2985</span> <span class="dv">2055</span> <span class="dv">1106</span>  <span class="dv">646</span> <span class="dv">502</span> <span class="dv">257</span> <span class="dv">11</span>  <span class="dv">17</span>  <span class="dv">7579</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">1957</span> <span class="dv">3625</span> <span class="dv">2656</span> <span class="dv">1413</span>  <span class="dv">873</span> <span class="dv">688</span> <span class="dv">326</span> <span class="dv">21</span>  <span class="dv">38</span>  <span class="dv">9640</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="dv">1967</span> <span class="dv">4295</span> <span class="dv">3274</span> <span class="dv">1700</span> <span class="dv">1110</span> <span class="dv">879</span> <span class="dv">375</span> <span class="dv">62</span> <span class="dv">103</span> <span class="dv">11799</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-fig1" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> uses the function <code>plot()</code> to show a plot of the Australian Capital Territory (ACT) population between 1917 and 1997.</p>
<p><a href="#fig-fig1" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> uses the function <code>plot()</code> to show a plot of the Australian Capital Territory (ACT) population between 1917 and 1997.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="basics_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Australian Capital Territory (ACT) population between 1917 and 1997
</figcaption>
</figure>
</div>
</div>
</div>
<p>Code is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ACT <span class="sc">~</span> year, <span class="at">data=</span>austpop, <span class="at">pch=</span><span class="dv">16</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The option <code>pch=16</code> sets the plotting character to a solid black dot. This plot can be improved greatly. We can specify more informative axis labels, change size of the text and of the plotting symbol, and so on.</p>
<section id="r-provides-a-huge-range-of-abilities-for-working-with-data" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="r-provides-a-huge-range-of-abilities-for-working-with-data">R provides a huge range of abilities for working with data</h4>
<p>Between the base, recommended, and huge range of contributed packages, R offers wide-ranging abilities for data manipulation, for data summary, for graphical display, for fitting models, for simulation, and for a variety of other computations.</p>
<p>Data frames are a standard way to store data. A dataframe is a list of columns, all of the same length. Columns can be numeric, or character, or logical (values are <code>TRUE</code> or <code>FALSE</code>), or factor, or dates. As a first example, consider the data frame <code>hills</code>. This has three columns (variables), with the names distance, climb, and time. Typing <code>summary(hills)</code> gives summary information on these variables. There is one column for each variable, thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>hills <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>hills  <span class="co"># Copy the dataframe `hills`, from the </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># DAAG package, into the  workspace.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hills)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>      dist            climb           time       </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span> <span class="fl">2.000</span>   Min.   <span class="sc">:</span> <span class="dv">300</span>   Min.   <span class="sc">:</span><span class="fl">0.2658</span>  </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>st Qu.<span class="sc">:</span> <span class="fl">4.500</span>   <span class="dv">1</span>st Qu.<span class="sc">:</span> <span class="dv">725</span>   <span class="dv">1</span>st Qu.<span class="sc">:</span><span class="fl">0.4667</span>  </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span> <span class="fl">6.000</span>   Median <span class="sc">:</span><span class="dv">1000</span>   Median <span class="sc">:</span><span class="fl">0.6625</span>  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span> <span class="fl">7.526</span>   Mean   <span class="sc">:</span><span class="dv">1815</span>   Mean   <span class="sc">:</span><span class="fl">0.9646</span>  </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>rd Qu.<span class="sc">:</span> <span class="fl">8.000</span>   <span class="dv">3</span>rd Qu.<span class="sc">:</span><span class="dv">2200</span>   <span class="dv">3</span>rd Qu.<span class="sc">:</span><span class="fl">1.1438</span>  </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">28.000</span>   Max.   <span class="sc">:</span><span class="dv">7500</span>   Max.   <span class="sc">:</span><span class="fl">3.4103</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We may for example require information on ranges of variables. Thus the range of distances (first column) is from 2 miles to 28 miles, while the range of times (third column) is from 15.95 (minutes) to 204.6 minutes.</p>
<p>A helpful graphical summary for the hills data frame is the scatterplot matrix, shown in <a href="#fig-fig2" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(DAAG<span class="sc">::</span>hills)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="basics_files/figure-html/fig-fig2-1.png" class="img-fluid figure-img" style="width:72.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Scatterplot matrix for the Scottish hill race data
</figcaption>
</figure>
</div>
</div>
</div>
<p>To reproduce the plot, type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(DAAG<span class="sc">::</span>hills)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correlation calculations are a form of data summary. The correlation matrix for the <code>hills</code> data is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DAAG<span class="sc">::</span>hills)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>       dist climb  time</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>dist  <span class="fl">1.000</span> <span class="fl">0.652</span> <span class="fl">0.920</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>climb <span class="fl">0.652</span> <span class="fl">1.000</span> <span class="fl">0.805</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>time  <span class="fl">0.920</span> <span class="fl">0.805</span> <span class="fl">1.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There is a case for taking logarithms of data values, and then calculating correlations. This can all be done in one step, thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="fu">log</span>(DAAG<span class="sc">::</span>hills))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>      dist climb  time</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>dist  <span class="fl">1.00</span> <span class="fl">0.700</span> <span class="fl">0.890</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>climb <span class="fl">0.70</span> <span class="fl">1.000</span> <span class="fl">0.724</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>time  <span class="fl">0.89</span> <span class="fl">0.724</span> <span class="fl">1.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>R was not clever enough to relabel <code>distance</code> as <code>log(distance)</code>, <code>climb</code> as <code>log(climb)</code>, and <code>time</code> as <code>log(time)</code>. Notice that the correlations between time and distance, and between time and climb, have reduced. Why has this happened?</p>
<p>In the straight line regression calculations now demonstrated, the variable names are the names of columns in the data frame <code>DAAG::elasticband</code>. The formula that is supplied to the <code>lm()</code> (linear model) command asks for the regression of distance traveled by the elastic band (<code>distance</code>) on the amount by which it is stretched (<code>stretch</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>elasticband <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>elasticband</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>elastic.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(distance<span class="sc">~</span>stretch,<span class="at">data=</span>elasticband)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(distance <span class="sc">~</span>stretch, <span class="at">data=</span>elasticband)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> distance <span class="sc">~</span> stretch, <span class="at">data =</span> elasticband)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>(Intercept)      stretch  </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="fl">63.57</span>         <span class="fl">4.55</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>More complete information is available by typing</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(elastic.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-fig3" class="quarto-xref">Figure&nbsp;<span>1.3</span></a> plots the data and adds the regression line:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="basics_files/figure-html/fig-fig3-1.png" class="img-fluid figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: Elastic band <code>distance</code> versus <code>stretch</code>, with regression line added
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Code</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(distance <span class="sc">~</span> stretch,<span class="at">data=</span>elasticband, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(elastic.lm)  <span class="co"># Add regression line to graph</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-is-an-interactive-programming-language" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="r-is-an-interactive-programming-language">R is an interactive programming language</h4>
<p>We calculate the Fahrenheit temperatures that correspond to Celsius temperatures 25, 26, …, 30:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>celsius <span class="ot">&lt;-</span> <span class="dv">25</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fahrenheit <span class="ot">&lt;-</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">5</span><span class="sc">*</span>celsius<span class="sc">+</span><span class="dv">32</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>conversion <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Celsius=</span>celsius, <span class="at">Fahrenheit=</span>fahrenheit)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conversion)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  Celsius Fahrenheit</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">25</span>       <span class="fl">77.0</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">26</span>       <span class="fl">78.8</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">27</span>       <span class="fl">80.6</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">28</span>       <span class="fl">82.4</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>      <span class="dv">29</span>       <span class="fl">84.2</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>      <span class="dv">30</span>       <span class="fl">86.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extensive-help-is-available-from-the-command-line" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="extensive-help-is-available-from-the-command-line">Extensive help is available from the command line</h4>
<p>To get a help on an R object, use <code>help()</code> or <code>?</code>, thus</p>
<p>Thus, to get help on the R function <code>plot()</code>, type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>?plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The two search functions <code>help.search()</code> and <code>apropos()</code> can help in finding what one wants. Examples of their use are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help.search</span>(<span class="st">"matrix"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## This lists all functions whose help pages have a title or alias in</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## which the text string “matrix” appears.</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">apropos</span>(<span class="st">"matrix"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## This lists all function names that include the text “matrix”</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>help.start()</code> opens a browser window that gives access to the full range of documentation for syntax, packages and functions.</p>
<p>Experimentation often helps clarify the precise action of an R function.</p>
</section>
</section>
</section>
<section id="vectors" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="vectors"><span class="header-section-number">1.2</span> Vectors</h2>
<p>Examples of vectors are</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>   <span class="co"># The numbers 3, 4, .., 10</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(”Canberra”,”Sydney”,”Newcastle”,”Darwin”)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vectors may have mode logical, numeric or character . The first two vectors above are numeric, the third is logical (i.e.&nbsp;a vector with elements of mode logical), and the fourth is a string vector (i.e.&nbsp;a vector with elements of mode character). The missing value symbol, which is NA, can be included as an element of a vector.</p>
<section id="joining-concatenating-vectors" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="joining-concatenating-vectors">Joining (concatenating) vectors</h4>
<p>The <code>c</code> in <code>c(2, 3, 5, 7, 1)</code> above is an acronym for “concatenate”, i.e.&nbsp;the meaning is: “Join these numbers together in to a vector. Existing vectors may be included among the elements that are to be concatenated. In the following we form vectors <code>x</code> and <code>y</code>, which we then concatenate to form a vector <code>z</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">1</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">7</span> <span class="dv">1</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">12</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">10</span> <span class="dv">15</span> <span class="dv">12</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">5</span>  <span class="dv">2</span>  <span class="dv">7</span>  <span class="dv">1</span> <span class="dv">10</span> <span class="dv">15</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The concatenate function <code>c()</code> may also be used to join lists.</p>
</section>
<section id="subsets-of-vectors" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="subsets-of-vectors">Subsets of Vectors</h4>
<p>There are two common ways to extract subsets of vectors.<br>
1. Specify the numbers of the elements that are to be extracted, e.g.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">15</span>,<span class="dv">12</span>)  <span class="co"># Assign to x the values 3, 11, 8, 15, 12</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]   <span class="co"># Extract elements (rows) 2 and 4</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">11</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One can use negative numbers to omit elements:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">15</span>,<span class="dv">12</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">3</span> <span class="dv">15</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Specify a vector of logical values. The elements that are extracted are those for which the logical value is T. Thus suppose we want to extract values of x that are greater than 10.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">&gt;</span><span class="dv">10</span>       <span class="co"># This generates a vector of logical (T or F)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span>  <span class="cn">TRUE</span> <span class="cn">FALSE</span>  <span class="cn">TRUE</span>  <span class="cn">TRUE</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>x[x<span class="sc">&gt;</span><span class="dv">10</span>]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">11</span> <span class="dv">15</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Arithmetic relations that may be used in the extraction of subsets of vectors are <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>, and <code>!=</code>. The first four compare magnitudes, <code>==</code> tests for equality, and <code>!=</code> tests for inequality.</p>
<p>Vectors can have named elements, in which case elements can be extracted by name. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Andreas=</span><span class="dv">178</span>, <span class="at">John=</span><span class="dv">185</span>, <span class="at">Jeff=</span><span class="dv">183</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>height[<span class="fu">c</span>(<span class="st">"John"</span>,<span class="st">"Jeff"</span>)]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>John Jeff </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a> <span class="dv">185</span>  <span class="dv">183</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="patterned-data" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="patterned-data">Patterned Data</h4>
<p>Use <code>5:15</code> to generate the numbers 5, 6, . . ., 15. Entering 15:5 will generate the sequence in the reverse order. To repeat the sequence (2, 3, 5) four times over, enter <code>rep(c(2,3,5), 4)</code> thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>),<span class="dv">4</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If instead one wants four 2s, then four 3s, then four 5s, enter</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>))    <span class="co"># An alternative is rep(c(2,3,5), each=4)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note further that, in place of <code>c(4,4,4)</code> we could write <code>rep(4,3)</code>.</p>
<p>In addition to the above, note that the function <code>rep()</code> has an argument <code>length.out</code>, meaning “keep on repeating the sequence until the length is <code>length.out</code>.”</p>
</section>
</section>
<section id="lists-with-dataframes-as-an-important-special-case" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="lists-with-dataframes-as-an-important-special-case"><span class="header-section-number">1.3</span> Lists, with dataframes as an important special case</h2>
<p>Lists collect together, under a single name, what can be an arbitrary set of R objects. These might be vectors of several different modes and lengths, scalars, dates, matrices or more general arrays, or functions, etc.</p>
<section id="dataframes-are-lists" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="dataframes-are-lists">Dataframes are lists!</h3>
<p>A data frame is a list of variables, all of equal length. Variables can be vectors (integer, or numeric, or character, or logical, or complex). Among other possibilities, they can also be factors, or date objects. For the moment, attention will be limited to dataframes where the columns are integer, or numeric, or character, or logical.</p>
<p>Just as with any other list, subscripting extracts a list. Thus <code>Cars93.summary[4]</code> is a data frame with a single column, which is the fourth column vector of Cars93.summary. Use <code>Cars93.summary[[4]]</code> or <code>Cars93.summary[,4]</code> to extract the column vector.</p>
<p>R packages include a wide variety of datasets, mostly in the form of <em>dataframe</em>s. Data frames have a central role in the way that R is set up to process data, fit models, and display graphs.</p>
<section id="operations-with-dataframes" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="operations-with-dataframes">Operations with dataframes</h4>
<p>Among the datasets in the <em>DAAG</em> package is <code>Cars93.summary</code>, created from information in the <code>Cars93</code> data set in the Venables and Ripley <em>MASS</em> package. Here it is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Cars93.summary <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>Cars93.summary </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Cars93.summary</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        Min.passengers Max.passengers No.of.cars abbrev</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>Compact              <span class="dv">4</span>              <span class="dv">6</span>         <span class="dv">16</span>      C</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>Large                <span class="dv">6</span>              <span class="dv">6</span>         <span class="dv">11</span>      L</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>Midsize              <span class="dv">4</span>              <span class="dv">6</span>         <span class="dv">22</span>      M</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>Small                <span class="dv">4</span>              <span class="dv">5</span>         <span class="dv">21</span>     Sm</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>Sporty               <span class="dv">2</span>              <span class="dv">4</span>         <span class="dv">14</span>     Sp</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>Van                  <span class="dv">7</span>              <span class="dv">8</span>          <span class="dv">9</span>      V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that the final column has the <em>mode</em> character. Different columns can have different modes – including numeric, character, and logical (values <code>TRUE</code> and <code>FALSE</code>).</p>
<p>The data frame has row labels (access with <code>row.names(Cars93.summary)</code>) <code>Compact</code>, <code>Large</code>, . . . The column names (access with <code>names(Cars93.summary)</code>) are <code>Min.passengers</code> (i.e.&nbsp;the minimum number of passengers for cars in this category), <code>Max.passengers</code>, <code>No.of.cars.</code>, and <code>abbrev</code>. The first three columns have mode numeric, and the fourth has mode character. Columns can be vectors of any mode. The column <code>abbrev</code> could equally well be stored as a factor – more on that in due course.</p>
</section>
<section id="accessing-parts-of-data-frames" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="accessing-parts-of-data-frames">Accessing parts of data frames</h4>
<p>A data frame that has only the first four rows and omits the third column can be extracted thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> Cars93.summary[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> Cars93.summary[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">3</span>]   <span class="co"># Alternative --- specify what to omit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Any of the following will pick out the fourth column of the data frame Cars93.summary, then storing it in the vector type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>type <span class="ot">&lt;-</span> Cars93.summary<span class="sc">$</span>abbrev</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>type <span class="ot">&lt;-</span> Cars93.summary[,<span class="dv">4</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>type <span class="ot">&lt;-</span> Cars93.summary[,<span class="st">"abbrev"</span>]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>type <span class="ot">&lt;-</span> Cars93.summary[[<span class="dv">4</span>]]    <span class="co"># Take the object that is stored</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                               <span class="co"># in the fourth list element.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="merging-data-frames-a-simple-example-.unnumbered" class="level4">
<h4 class="anchored" data-anchor-id="merging-data-frames-a-simple-example-.unnumbered">*Merging Data Frames – a simple example {.unnumbered}</h4>
<p>The data frame <code>MASS::Cars93</code> holds extensive information on data from 93 cars on sale in the USA in 1993. The data frame <code>DAAG::Cars93.summary</code> has as row names the distinct values of the factor <code>Type</code>. The final column, with the name <code>abbrev</code>, holds two character abbreviations of each of the car type names, suitable for use in plotting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>Cars93.summary <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>Cars93.summary</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>Cars93.summary</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        Min.passengers Max.passengers No.of.cars abbrev</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>Compact              <span class="dv">4</span>              <span class="dv">6</span>         <span class="dv">16</span>      C</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>Large                <span class="dv">6</span>              <span class="dv">6</span>         <span class="dv">11</span>      L</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>Midsize              <span class="dv">4</span>              <span class="dv">6</span>         <span class="dv">22</span>      M</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>Small                <span class="dv">4</span>              <span class="dv">5</span>         <span class="dv">21</span>     Sm</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>Sporty               <span class="dv">2</span>              <span class="dv">4</span>         <span class="dv">14</span>     Sp</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>Van                  <span class="dv">7</span>              <span class="dv">8</span>          <span class="dv">9</span>      V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We proceed thus to add a column that has the abbreviations to the data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Cars93 <span class="ot">&lt;-</span> MASS<span class="sc">::</span>Cars93</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>new.Cars93 <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x=</span>Cars93, <span class="at">y=</span>Cars93.summary[,<span class="dv">4</span>,<span class="at">drop=</span>F],</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by.x=</span><span class="st">"Type"</span>, <span class="at">by.y=</span><span class="st">"row.names"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that the row names of <code>Cars93.summary</code> are treated as a column of the data frame, with name <code>row.names</code>. The effect is to create a data frame that has the abbreviations in the additional column with name <code>abbrev</code>. If there had been rows with missing values of Type, these would have been omitted from the new data frame. This can be avoided by ensuring that Type has <code>NA</code> as one of its levels, in both data frames.</p>
</section>
</section>
<section id="lists-more-generally" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="lists-more-generally">Lists more generally</h3>
<section id="output-from-fitting-a-model-is-a-list" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="output-from-fitting-a-model-is-a-list">Output from fitting a model is a list</h4>
<p>As an illustration consider the list object that R creates as output from an <code>lm()</code> linear model fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>elastic.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(distance<span class="sc">~</span>stretch, <span class="at">data=</span>DAAG<span class="sc">::</span>elasticband)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The object <code>elastic.lm</code> is a list that brings together several different kinds of objects. The names are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(elastic.lm)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">"coefficients"</span>  <span class="st">"residuals"</span>     <span class="st">"effects"</span>       <span class="st">"rank"</span>         </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] <span class="st">"fitted.values"</span> <span class="st">"assign"</span>        <span class="st">"qr"</span>            <span class="st">"df.residual"</span>  </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] <span class="st">"xlevels"</span>       <span class="st">"call"</span>          <span class="st">"terms"</span>         <span class="st">"model"</span>        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first list element is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>elastic.lm<span class="sc">$</span>coefficients</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>(Intercept)     stretch </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="fl">63.57</span>        <span class="fl">4.55</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternative ways to extract this first list element are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>elastic.lm[[<span class="st">"coefficients"</span>]]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>elastic.lm[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can alternatively ask for the sublist whose only element is the vector <code>elastic.lm$coefficients</code>. For this, specify</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>elastic.lm[<span class="st">"coefficients"</span>]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>coefficients</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>(Intercept)     stretch </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="fl">63.57</span>        <span class="fl">4.55</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># elastic.lm[1] gives the same result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that the information is in this case preceded by $coefficients, meaning “list element with name coefficients”. The result is a list, now with just the first element of <code>elastic.lm</code>.</p>
<p>The second list element is a vector of length 7:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(elastic.lm<span class="sc">$</span>residuals, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>       <span class="dv">2</span>       <span class="dv">3</span>       <span class="dv">4</span>       <span class="dv">5</span>       <span class="dv">6</span>       <span class="dv">7</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">2.107</span>  <span class="sc">-</span><span class="fl">0.321</span>  <span class="fl">18.000</span>   <span class="fl">1.893</span> <span class="sc">-</span><span class="fl">27.786</span>  <span class="fl">13.321</span>  <span class="sc">-</span><span class="fl">7.214</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The tenth list element documents the function call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>elastic.lm<span class="sc">$</span>call</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> distance <span class="sc">~</span> stretch, <span class="at">data =</span> DAAG<span class="sc">::</span>elasticband)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(elastic.lm<span class="sc">$</span>call)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"call"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="factors-dates-nas-and-more" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="factors-dates-nas-and-more"><span class="header-section-number">1.4</span> Factors, dates, <code>NA</code>s, and more</h2>
<section id="factors-and-ordered-factors" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="factors-and-ordered-factors">Factors and ordered factors</h3>
<p>A factor is stored internally as a numeric vector with values 1, 2, 3, k, where k is the number of levels. An attributes table gives the ‘level’ for each integer value . Factors provide a compact way to store character strings. They are crucial in the representation of categorical effects in model and graphics formulae. The class attribute of a factor has, not surprisingly, the value <code>"factor"</code>.</p>
<p>Consider a survey that has data on 691 females and 692 males. If the first 691 are females and the next 692 males, we can create a vector of strings that that holds the values thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"female"</span>,<span class="dv">691</span>), <span class="fu">rep</span>(<span class="st">"male"</span>,<span class="dv">692</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(The usage is that rep(“female”, 691) creates 691 copies of the character string “female”, and similarly for the creation of 692 copies of “male”.)</p>
<p>We can change the vector to a factor, by entering:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Internally the factor gender is stored as 691 1’s, followed by 692 2’s. It has stored with it the vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(gender)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"female"</span> <span class="st">"male"</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In most cases where the context seems to demand a character string, the 1 is translated into <code>"female"</code> and the 2 into <code>"male"</code>. The values <code>"female"</code> and <code>"male"</code> are the levels of the factor. By default, the levels are in alphanumeric order, so that <code>"female"</code> precedes <code>"male"</code>. Hence:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(gender)  <span class="co"># Assumes gender is a factor, created as above</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"female"</span> <span class="st">"male"</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The order of the levels in a factor determines the order in which the levels appear in graphs that use this information, and in tables. To cause <code>"male"</code> to come before <code>"female"</code>, use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">relevel</span>(gender, <span class="at">ref=</span><span class="st">"male"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An alternative is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(gender, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This last syntax is available both when the factor is first created, or later when one wishes to change the order of levels in an existing factor. Incorrect spelling of the level names will generate an error message. Try</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(“female”,<span class="dv">691</span>), <span class="fu">rep</span>(“male”,<span class="dv">692</span>)))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gender)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(gender, <span class="at">levels=</span><span class="fu">c</span>(“male”, “female”))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gender)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(gender, <span class="at">levels=</span><span class="fu">c</span>(“Male”, “female”))  </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Erroneous - "male" rows now hold missing values</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gender)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gender)      <span class="co"># Remove gender  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following adds site names to the <code>possum</code> dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>possum <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>possum</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>possumsites <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>possumsites</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>possum<span class="sc">$</span>sitenam <span class="ot">&lt;-</span> <span class="fu">rownames</span>(possumsites)[DAAG<span class="sc">::</span>possum<span class="sc">$</span>site]</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(possum, <span class="fu">table</span>(sitenam))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>sitenam</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>Allyn River    Bellbird    Bulburin   Byrangery Cambarville   Conondale </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>          <span class="dv">7</span>          <span class="dv">13</span>          <span class="dv">18</span>          <span class="dv">13</span>          <span class="dv">33</span>          <span class="dv">13</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>Whian Whian </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>          <span class="dv">7</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>sitefac <span class="ot">&lt;-</span> <span class="fu">factor</span>(possum<span class="sc">$</span>sitenam)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sitefac)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>sitefac</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>Allyn River    Bellbird    Bulburin   Byrangery Cambarville   Conondale </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>          <span class="dv">7</span>          <span class="dv">13</span>          <span class="dv">18</span>          <span class="dv">13</span>          <span class="dv">33</span>          <span class="dv">13</span> </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>Whian Whian </span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>          <span class="dv">7</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is the integer values that are stored. Along with the vector of integer values are stored a list of <em>attributes</em>, which holds the level names and the <em>class</em> vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(sitefac)        </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"numeric"</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The attributes list is for an object of this class</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(sitefac)  </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>levels</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Allyn River"</span> <span class="st">"Bellbird"</span>    <span class="st">"Bulburin"</span>    <span class="st">"Byrangery"</span>   <span class="st">"Cambarville"</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">6</span>] <span class="st">"Conondale"</span>   <span class="st">"Whian Whian"</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>class</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"factor"</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This controls the interpretation of `sitefac` a factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Printing the contents of the column with the name <code>sitefac</code> gives the names, not the integer values. As in most operations with factors, R does the translation invisibly. There are though annoying exceptions that can make the use of factors tricky. To get back the site names as a character vector and tabulate the result, specify</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">as.character</span>(possum<span class="sc">$</span>sitefac))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span> table of extent <span class="dv">0</span> <span class="sc">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To get the integer values and tabulate the result, specify</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">unclass</span>(possum<span class="sc">$</span>sitefac))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span> table of extent <span class="dv">0</span> <span class="sc">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We might prefer the names to appear in order of latitude, from North to South. We can change the order of the level names to reflect this desired order:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ordnam <span class="ot">&lt;-</span> <span class="fu">rownames</span>(possumsites)[<span class="fu">order</span>(possumsites<span class="sc">$</span>Latitude)]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>possum<span class="sc">$</span>sitefac <span class="ot">&lt;-</span> <span class="fu">factor</span>(possum<span class="sc">$</span>sitenam, <span class="at">levels=</span>ordnam)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(possum, <span class="fu">table</span>(sitefac))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>sitefac</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>   Bellbird Cambarville Allyn River Whian Whian   Byrangery   Conondale </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>         <span class="dv">13</span>          <span class="dv">33</span>           <span class="dv">7</span>           <span class="dv">7</span>          <span class="dv">13</span>          <span class="dv">13</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>   Bulburin </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>         <span class="dv">18</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Factors have the potential to cause surprises. Points to note are:<br>
* When a vector of character strings becomes a column of a data frame, R by default turns it into a factor. Enclose the vector of character strings in the wrapper function <code>I()</code> if it is to remain character. With tibbles, this is not an issue. * There are some contexts in which factors become numeric vectors. To be sure of getting the vector of text strings, specify e.g.&nbsp;<code>as.character(possum$sitefac)</code>.</p>
<section id="ordered-factors" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ordered-factors">Ordered Factors</h4>
<p>Actually, it is their levels that are ordered. To create an ordered factor, or to turn a factor into an ordered factor, use the function <code>ordered()</code>. The levels of an ordered factor are assumed to specify positions on an ordinal scale. Try</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>stress.level <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"medium"</span>,<span class="st">"high"</span>),<span class="dv">2</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>ordf.stress <span class="ot">&lt;-</span> <span class="fu">ordered</span>(stress.level, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"medium"</span>,<span class="st">"high"</span>))</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>ordf.stress</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] low    medium high   low    medium high  </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>Levels<span class="sc">:</span> low <span class="sc">&lt;</span> medium <span class="sc">&lt;</span> high</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>ordf.stress <span class="sc">&lt;</span> <span class="st">"medium"</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span>  <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>ordf.stress <span class="sc">&gt;=</span> <span class="st">"medium"</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span>  <span class="cn">TRUE</span>  <span class="cn">TRUE</span> <span class="cn">FALSE</span>  <span class="cn">TRUE</span>  <span class="cn">TRUE</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>ordf.stress <span class="sc">==</span> <span class="st">"medium"</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span>  <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span>  <span class="cn">TRUE</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ordered factors <code>inherit</code> the attributes of factors, and have a further ordering attribute. Asking for the class of an object returns details both of the class of the object, and of any classes from which it inherits.<br>
Thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ordf.stress)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"ordered"</span> <span class="st">"factor"</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(ordf.stress)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>levels</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"low"</span>    <span class="st">"medium"</span> <span class="st">"high"</span>  </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>class</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"ordered"</span> <span class="st">"factor"</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inclusion-of-character-string-vectors-in-data-frames" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="inclusion-of-character-string-vectors-in-data-frames">Inclusion of character string vectors in data frames</h4>
<p>When data are input using <code>read.table()</code>, or when the <code>data.frame()</code> function is used to create data frames, vectors of character strings are by default turned into factors. The parameter setting <code>stringsAsFactors=TRUE</code>, available both with <code>read.table()</code> and with <code>data.frame()</code>, will if needed ensure that character strings are input without such conversion. For <code>read.table()</code>, an alternative is <code>as.is=TRUE</code>. When input uses functions in the <em>readr</em> package, character strings are left unchanged.</p>
</section>
</section>
<section id="dates" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="dates">Dates</h3>
<p>See <code>?Dates</code>, <code>?as.Date</code> and <code>?format.Date</code> for information on functions in base R for working with dates. Use <code>as.Date()</code> to convert text strings into dates. The default is that the year comes first, then the month, and then the day of the month, thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Electricity Billing Dates</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2003/08/24"</span>,<span class="st">"2003/11/23"</span>,<span class="st">"2004/02/22"</span>,<span class="st">"2004/05/23"</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(dd)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>Time differences <span class="cf">in</span> days</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">91</span> <span class="dv">91</span> <span class="dv">91</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>format()</code> to set or change the way that a date is formatted. The following are a selection of the symbols used:</p>
<p>%d: day, as number<br>
%a: abbreviated weekday name (%A: unabbreviated)<br>
%m: month (00-12)<br>
%b: month abbreviated name (%B: unabbreviated)<br>
%y: final two digits of year (%Y: all four digits)</p>
<p>The default format is <code>%Y-%m-%d</code>. The function <code>as.Date()</code> take<code>a vector of character strings that has  an appropriate format, and converts it into a dates object. By default,  dates are stored using January 1 1970 as origin. This becomes apparent  when</code>as.integer()` is used to convert a date into an integer value. Examples are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">"1/1/1960"</span>, <span class="at">format=</span><span class="st">"%d/%m/%Y"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"1960-01-01"</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">"1:12:1960"</span>,<span class="at">format=</span><span class="st">"%d:%m:%Y"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"1960-12-01"</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">"1960-12-1"</span>)<span class="sc">-</span><span class="fu">as.Date</span>(<span class="st">"1960-1-1"</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>Time difference of <span class="dv">335</span> days</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">"31/12/1960"</span>,<span class="st">"%d/%m/%Y"</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"1960-12-31"</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(<span class="fu">as.Date</span>(<span class="st">"1/1/1970"</span>,<span class="st">"%d/%m/%Y"</span>))</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(<span class="fu">as.Date</span>(<span class="st">"1/1/2000"</span>,<span class="st">"%d/%m/%Y"</span>))</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">10957</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>format()</code> allows control of the formatting of dates when they are printed. <code>See ?format.Date</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>dec1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2004-12-1"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(dec1, <span class="at">format=</span><span class="st">"%b %d %Y"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Dec 01 2004"</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(dec1, <span class="at">format=</span><span class="st">"%a %b %d %Y"</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Wed Dec 01 2004"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As with factors, the underlying storage mode is a numeric vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(dd)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"numeric"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">julian</span>(dd)          </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">12288</span> <span class="dv">12379</span> <span class="dv">12470</span> <span class="dv">12561</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">"origin"</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"1970-01-01"</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Makes it clear that date is days since '1970-01-01'</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">julian</span>(<span class="fu">as.Date</span>(<span class="st">'1970-01-01'</span>))                    </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">"origin"</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"1970-01-01"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="nas-missing-values-nan-not-a-number-and-inf" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="nas-missing-values-nan-not-a-number-and-inf"><code>NA</code>s (missing Values), <code>NaN</code> (not a number) and <code>Inf</code></h3>
<p>In R, the missing value symbol is NA. Any arithmetic operation or relation that involves NA generates an NA. This applies also to the relations <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>. The first four compare magnitudes, <code>==</code> tests for equality, and <code>!=</code> tests for inequality. Users who do not carefully consider implications for expressions that include <code>NA</code>s may be puzzled by the results. Specifically, note that <code>x==NA</code> generates <code>NA</code>.<br>
Be sure to use <code>is.na(x)</code> to test which values of <code>x</code> are <code>NA</code>. As <code>x==NA</code> gives a vector of <code>NA</code>s, this gives no information about <code>x</code>.<br>
For example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="cn">NA</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(x)            <span class="co"># TRUE for when NA appears, and otherwise FALSE</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span>  <span class="cn">TRUE</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> <span class="cn">NA</span>             <span class="co"># Result is NA, for all elements of `x`</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">==</span> <span class="cn">NA</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-use-of-na-in-variable-subscripts" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-use-of-na-in-variable-subscripts">The Use of <code>NA</code> in variable subscripts</h4>
<p>Any arithmetic operation or relation that involves <code>NA</code> generates an <code>NA</code>. Set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Be warned that <code>y[y==NA] &lt;- 0</code> leaves y unchanged. The reason is that all elements of <code>y==NA</code> evaluate to <code>NA</code>. This does not select an element of <code>y</code>, and there is no assignment. To replace all <code>NA</code>s by <code>0</code>, use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>y[<span class="fu">is.na</span>(y)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following, where the subscript vector on both sides has one or more missing values, generates an error message:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="cn">NA</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>y[x<span class="sc">&gt;</span><span class="dv">2</span>] <span class="ot">&lt;-</span> x[x<span class="sc">&gt;</span><span class="dv">2</span>]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> y[x <span class="sc">&gt;</span> <span class="dv">2</span>] <span class="ot">&lt;-</span> x[x <span class="sc">&gt;</span> <span class="dv">2</span>]<span class="sc">:</span> NAs are not allowed <span class="cf">in</span> subscripted assignments</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>!is.na(x)</code> to limit the selection, on both sides, to those elements of x that are not <code>NA</code>s.</p>
</section>
<section id="inf-and-nan" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="inf-and-nan"><code>Inf</code> and <code>NaN</code></h4>
<p>The following are allowed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">0</span>, <span class="dv">0</span><span class="sc">/</span><span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="cn">Inf</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="cn">Inf</span>  <span class="cn">Inf</span>  <span class="cn">NaN</span>    <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is up to the user to ensure that allowing such calculations to proceed leads to results that make sense.</p>
</section>
</section>
</section>
<section id="matrices-and-arrays" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="matrices-and-arrays"><span class="header-section-number">1.5</span> Matrices and arrays</h2>
<p>All elements of a matrix have the same mode, i.e.&nbsp;all numeric, or all character. Thus a matrix is a more restricted structure than a data frame. One reason for numeric matrices is that they allow a variety of mathematical operations that are not available for data frames. Matrices are likely to be important for those users who wish to implement new regression and multivariate methods. The matrix construct generalizes to array, which may have more than two dimensions. Matrices are stored columnwise, in a single vector. Thus consider:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">ncol=</span><span class="dv">3</span>)  <span class="co"># Equivalently, enter matrix(1:6,nrow=2)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>xx</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>]</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">5</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">4</span>    <span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If <code>xx</code> is any matrix, the assignment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(xx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>places columns of <code>xx</code>, in order, into one long vector <code>x</code>. In the example just given, we get back the elements 1, 2, . . . , 6. Matrices have the attribute “dimension”. Thus</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(xx)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thus, a matrix is a vector (numeric or character or logical) whose dimension attribute has length 2.<br>
Now set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>x34 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>x34</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>]</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">5</span>    <span class="dv">7</span>    <span class="dv">9</span>   <span class="dv">11</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">4</span>    <span class="dv">6</span>    <span class="dv">8</span>   <span class="dv">10</span>   <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Examples of the extraction of columns or rows or submatrices are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>x34 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>x34[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)]  <span class="co"># Extract rows 2 &amp; 3 &amp; columns 1 &amp; 4</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>x34[<span class="dv">2</span>,]           <span class="co"># Extract the second row</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>x34[<span class="sc">-</span><span class="dv">2</span>,]          <span class="co"># Extract all rows except the second</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>x34[<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">3</span>]        <span class="co"># Omit row 2 &amp; column 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>dimnames()</code> function assigns and/or extracts matrix row and column names. The is a list, in which the first list element is the vector of row names, and the second list element is the vector of column names. This generalizes in the obvious way for use with arrays, which we now discuss.</p>
<section id="arrays" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="arrays">Arrays</h3>
<p>The generalization from a matrix (2 dimensions) to allow more than 2 dimensions gives an array. A matrix is a 2-dimensional array. Consider a numeric vector of length 24. So that we can easily keep track of the elements, we will make them 1, 2, .., 24. Thus</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">12</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># `x` is then a 2 x 12 matrix.  </span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>] [,<span class="dv">7</span>] [,<span class="dv">8</span>] [,<span class="dv">9</span>] [,<span class="dv">10</span>] [,<span class="dv">11</span>] [,<span class="dv">12</span>]</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">5</span>    <span class="dv">7</span>    <span class="dv">9</span>   <span class="dv">11</span>   <span class="dv">13</span>   <span class="dv">15</span>   <span class="dv">17</span>    <span class="dv">19</span>    <span class="dv">21</span>    <span class="dv">23</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">4</span>    <span class="dv">6</span>    <span class="dv">8</span>   <span class="dv">10</span>   <span class="dv">12</span>   <span class="dv">14</span>   <span class="dv">16</span>   <span class="dv">18</span>    <span class="dv">20</span>    <span class="dv">22</span>    <span class="dv">24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now try</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>, , <span class="dv">1</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>]</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">7</span>   <span class="dv">10</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">5</span>    <span class="dv">8</span>   <span class="dv">11</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]    <span class="dv">3</span>    <span class="dv">6</span>    <span class="dv">9</span>   <span class="dv">12</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>, , <span class="dv">2</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>]</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]   <span class="dv">13</span>   <span class="dv">16</span>   <span class="dv">19</span>   <span class="dv">22</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]   <span class="dv">14</span>   <span class="dv">17</span>   <span class="dv">20</span>   <span class="dv">23</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]   <span class="dv">15</span>   <span class="dv">18</span>   <span class="dv">21</span>   <span class="dv">24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="conversion-of-numeric-dataframes-into-matrices" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conversion-of-numeric-dataframes-into-matrices">Conversion of numeric dataframes into matrices</h4>
<p>There are various manipulations that are available for matrices, but not for data frames. Use <code>as.matrix()</code> to handle any conversion that may be necessary. Or, as with <code>apply()</code>, the conversion may happen automatically.</p>
</section>
</section>
</section>
<section id="sec-entry" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="sec-entry"><span class="header-section-number">1.6</span> Data entry and editing</h2>
<section id="entry-of-data-at-the-command-line" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="entry-of-data-at-the-command-line">Entry of Data at the Command Line</h4>
<p>The following data gives, for each amount by which an elastic band is stretched over the end of a ruler, the distance that the band moved when released:</p>
<pre><code>  stretch   46  54  48   50  44  42  52  
  distance 148 182 173  166 109 141 166  </code></pre>
<p>The function <code>data.frame()</code> can be used to input these (or other) data directly at the command line. We will give the data frame the name <code>elasticband</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>elasticband <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">stretch=</span><span class="fu">c</span>(<span class="dv">46</span>,<span class="dv">54</span>,<span class="dv">48</span>,<span class="dv">50</span>,<span class="dv">44</span>,<span class="dv">42</span>,<span class="dv">52</span>),</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">distance=</span><span class="fu">c</span>(<span class="dv">148</span>,<span class="dv">182</span>,<span class="dv">173</span>,<span class="dv">166</span>,<span class="dv">109</span>,<span class="dv">141</span>,<span class="dv">166</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="entry-andor-editing-of-data-in-an-editor-window" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="entry-andor-editing-of-data-in-an-editor-window">Entry and/or editing of data in an editor window</h4>
<p>To edit the data frame elasticband in a spreadsheet-like format, type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>elasticband <span class="ot">&lt;-</span> <span class="fu">edit</span>(elasticband)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="options-for-read.table" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="options-for-read.table">Options for <code>read.table()</code></h4>
<p>Under RStudio, input of data from files is very conveniently handled by selecting <span class="math inline">\(\underline{File}\)</span> | <span class="math inline">\(\underline{Import \space Dataset}\)</span> from the menu. Functions in the <em>tidyverse</em> collection greatly extend the range of data structure types that can be readily input into R. For this purpose, it is convenient to work from the RStudio menu, where the default is to read data into the data frame variant that has the name <em>tibble</em>.</p>
<p>The base R function <code>read.table()</code> takes, optionally various parameters additional to the file name that holds the data. Specify <code>header=TRUE</code> if there is an initial row of header names. The default is <code>header=FALSE</code>. In addition users can specify the separator character or characters. Command alternatives to the default use of a space are <code>sep=","</code> and <code>sep="\\t"</code>. This last choice makes tabs separators. Similarly, users can control over the choice of missing value character or characters, which by default is <code>NA</code>. If the missing value character is a period (“.”), specify <code>na.strings="."</code>.</p>
<p>There are several variants of <code>read.table()</code> that differ only in having different default parameter settings. Note in particular <code>read.csv()</code>, which has settings that are suitable for comma delimited (csv) files that have been generated from Excel spreadsheets.</p>
<p>If <code>read.table()</code> detects that lines in the input file have different numbers of fields, data input will fail, with an error message that draws attention to the discrepancy. It is then often useful to use the function <code>count.fields()</code> to report the number of fields that were identified on each separate line of the file.</p>
</section>
</section>
<section id="r-objects-the-workspace-and-attached-packages" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="r-objects-the-workspace-and-attached-packages"><span class="header-section-number">1.7</span> R objects, the workspace, and attached packages</h2>
<p>To attach the <em>MASS</em> package, type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MASS"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">'MASS'</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>The following object is masked _by_ <span class="st">'.GlobalEnv'</span><span class="sc">:</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    hills</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It will then be attached at position 2 on the ‘search list’, which is the list of <em>databases</em> (as they are termed) that R searches for datasets or functions whose source has not been specifically identified. Position 1 is reserved for <em>workspace</em> objects that have been created or copied in by the user.</p>
<p>Functions and datasets are specific types of R <em>objects</em>. Notice that the first name on the search list is <code>.GlobalEnv</code>, which refers to the workspace. The following code ‘loads’ the dataframe <code>cabbages</code>, from the <em>MASS</em> package, into the workspace:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>cabbages <span class="ot">&lt;-</span> MASS<span class="sc">::</span>cabbages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the <em>MASS</em> package has earlier been attached, there will then be two places on the search list where it can be found. The name <code>cabbages</code>, appearing on its own, would be taken to refer to the version in the workspace, not&nbsp;to that in the attached package <em>MASS</em>.</p>
<section id="the-function-with" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-function-with">The function <code>with()</code></h3>
<p>The function <code>with()</code> attaches the data frame (or, it can be a list) that is given as its first argument, within a specially created <em>environment</em> for the duration of the calculation(s) that are specified by its second argument. The <em>environment</em> here is neither the workspace nor an attached database. See <code>?environment</code> for details of what, in general, constitutes an environment.</p>
<p>For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>av <span class="ot">&lt;-</span> <span class="fu">with</span>(trees, <span class="fu">mean</span>(Height))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The assignment places the result in the worksapce.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The environment is then the first place searched, looking for a column with the name <code>Height</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y=</span><span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>), <span class="fu">mean</span>(y))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">6.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="saving-the-workspace" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="saving-the-workspace">Saving the workspace</h3>
<p>All R entities, including functions and data structures, exist as objects. They can all be operated on as data. Type in <code>ls()</code> to see the names of all objects in your workspace. An alternative to <code>ls()</code> is <code>objects()</code>. In both cases there is provision to specify a particular pattern, e.g.&nbsp;starting with the letter <code>p</code>.</p>
<p>Typing the name of an object causes the printing of its contents. Try typing q, mean, etc. In a long session, it makes sense to save the contents of the working directory from time to time. It is also possible to save individual objects, or collections of objects into a named image file. Some possibilities are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>()           <span class="co"># Save contents of workspace, into the file .RData</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="at">file=</span><span class="st">"archive.RData"</span>)      <span class="co"># Save into the file archive.RData</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(celsius, fahrenheit, <span class="at">file=</span><span class="st">"tempscales.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Important: On quitting, R offers the option of saving the workspace image, by default in the file .RData in the working directory. This allows the retention, for use in the next session in the same workspace, any objects that were created in the current session. Careful housekeeping may be needed to distinguish between objects that are to be kept and objects that will not be used again. Before typing q() to quit, use rm() to remove objects that are no longer required. Saving the workspace image will then save everything remains. The workspace image will be automatically loaded upon starting another session in that directory.</p>
<p>The function <code>save()</code> can be used to save a specific set of R objects into a named image file.</p>
</section>
<section id="functions-and-datasets-one-at-a-time-or-per-database" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="functions-and-datasets-one-at-a-time-or-per-database">Functions and datasets – one at a time, or per database?</h3>
<p>The dataset <code>possum</code> from the <em>DAAG</em> can be accessed as <code>DAAG::possum</code>, provided <em>DAAG</em> is installed on the computer. This has the advantage of leaving no room for ambiguity over the source of the dataset.</p>
<p>Datasets can alternatively be made available, using the functions <code>attach()</code> or <code>load()</code>, on a per database basis. For this purpose, a database is an R package, or an <em>image</em> file that holds some or all of the datasets that have been saved from an R session. Or it can be a list or data frame, allowing the list elements or data frame columns to be referred to directly, without reference to the list or data frame. The following first saves the dataframes <code>DAAG::possum</code> and <code>DAAG::cuckoos</code> to the image file <code>misc.RData</code> in the working directory (enter <code>getwd()</code> to check where that is), and then attaches <code>misc.RData</code>, making both these datasets available from a database that is placed at position 2 on the search list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>possum <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>possum; cuckoos <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>cuckoos</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(possum, cuckoos, <span class="at">file=</span><span class="st">"misc.Rdata"</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(possum, cuckoos)  <span class="co"># Remove from the workspace</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `attach()` to make these available again.</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(<span class="st">"misc.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Be aware that if an object of the same name happens to be present in the workspace, that will be taken instead. The function <code>load()</code> can alternatively be used to load the objects saved in <code>misc.RData</code> into the workspace, which might be a safer way to proceed.</p>
<p>Individual dataframes can also be attached or loaded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>possum <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>possum   <span class="co"># Load `possum` into the workspace</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(DAAG<span class="sc">::</span>possum)     <span class="co"># Add DAAG::possum to the search list</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Its columns can then be directly referenced by name </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Databases that are attached in the course of a session are by default added at position 2 on the search list. Set the argument <code>pos</code> to a value greater than 2 in order to add at a later position.</p>
<p>Image files, from the working directory or (with the path specified) from another directory, can be attached, thus making objects in the file available on request. For example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(<span class="st">"tempscales.RData"</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(<span class="at">pos=</span><span class="dv">2</span>)   <span class="co"># Check the contents of the file that has been attached</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The parameter <code>pos</code> gives the position on the search list.</p>
<section id="datasets-in-r-packages" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="datasets-in-r-packages">Datasets in R packages</h4>
<p>Type in <code>data()</code> to get a list of data sets (mostly data frames) associated with all packages that are in the current search path. To get information on the data sets that are included in the datasets package, specify</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="at">package=</span><span class="st">"datasets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and similarly for any other package. In most packages, data from an attached package are automatically available. Use of e.g., <code>data(airquality)</code> to attach the data set <code>airquality</code> (<em>datasets</em> package) is unnecessary. The out-of-the-box Windows and other binary distributions include a number of commonly required packages, including <em>datasets</em>. Other packages must be explicitly installed.</p>
<p>The base package, and several other packages (including <em>datasets</em>), are automatically attached at the beginning of the session. To attach any other installed package, use the <code>library()</code> command.</p>
</section>
</section>
</section>
<section id="sec-loop" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="sec-loop"><span class="header-section-number">1.8</span> Functions in R</h2>
<p>We give two simple examples of R functions.</p>
<section id="an-approximate-miles-to-kilometers-conversion" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="an-approximate-miles-to-kilometers-conversion">An Approximate Miles to Kilometers Conversion</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>miles.to.km <span class="ot">&lt;-</span> <span class="cf">function</span>(miles)miles<span class="sc">*</span><span class="dv">8</span><span class="sc">/</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The return value is the value of the final (and in this instance only) expression that appears in the function body . Use the function thus</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miles.to.km</span>(<span class="dv">175</span>)    <span class="co"># Approximate distance from Canberra to Sydney, in miles</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">280</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function will do the conversion for several distances all at once. To convert a vector of the three distances 100, 200 and 300 miles to distances in kilometers, specify:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miles.to.km</span>(<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">300</span>))</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">160</span> <span class="dv">320</span> <span class="dv">480</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-function-that-returns-the-mean-and-standard-deviation-of-a-set-of-numbers" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-function-that-returns-the-mean-and-standard-deviation-of-a-set-of-numbers">A function that returns the mean and standard deviation of a set of numbers</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>mean.and.sd <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  av <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">mean=</span>av, <span class="at">SD=</span>sd)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that a default argument is supplied. Now invoke the function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean.and.sd</span>()       <span class="co"># Uses default argument</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>mean   SD </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fl">5.50</span> <span class="fl">3.03</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean.and.sd</span>(hills<span class="sc">$</span>climb)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>mean   SD </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1815</span> <span class="dv">1619</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="looping-the-for-function" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="looping-the-for-function">Looping – the <code>for()</code> function</h3>
<p>A simple example of a for loop is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="fu">print</span>(i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is another example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Celsius to Fahrenheit</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (celsius <span class="cf">in</span> <span class="dv">25</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(<span class="fu">c</span>(celsius, <span class="dv">9</span><span class="sc">/</span><span class="dv">5</span><span class="sc">*</span>celsius <span class="sc">+</span> <span class="dv">32</span>))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">25</span> <span class="dv">77</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">26.0</span> <span class="fl">78.8</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">27.0</span> <span class="fl">80.6</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">28.0</span> <span class="fl">82.4</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">29.0</span> <span class="fl">84.2</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">30</span> <span class="dv">86</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A better way to formulate the calculation is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>celsius <span class="ot">&lt;-</span> <span class="dv">25</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="dv">9</span><span class="sc">/</span><span class="dv">5</span><span class="sc">*</span>celsius<span class="sc">+</span><span class="dv">32</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">77.0</span> <span class="fl">78.8</span> <span class="fl">80.6</span> <span class="fl">82.4</span> <span class="fl">84.2</span> <span class="fl">86.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Skilled R users have limited recourse to loops. There are often, as in this and earlier examples, better alternatives.</p>
</section>
<section id="function-syntax-and-semantics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="function-syntax-and-semantics">Function syntax and semantics</h3>
<p>A function is created using an assignment. On the right hand side, the parameters appear within round brackets. A default can, optionally, be provided. In the example above the default was <code>x = 1:10</code>, so that users can run the function without specifying a parameter, just to see what it does. Following the closing “)” the function body appears. Except where the function body consists of just one statement, this is enclosed between curly braces (<code>{</code> <code>}</code>). The return value usually appears on the final line of the function body. In the example above, this was the vector consisting of the two named elements <code>mean</code> and <code>sd</code>.</p>
<section id="an-example-of-a-user-function" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="an-example-of-a-user-function">An example of a user function</h4>
<p>The data set <code>mtcars</code> in the <em>datasets</em> package has data on 63 cars, as given in the 1974 Motor Trend US magazine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(mtcars, <span class="fu">plot</span>(hp, mpg))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Alternatively:</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(mtcars, <span class="fu">plot</span>(mpg <span class="sc">~</span> hp))   <span class="co"># mpg ~ hp is a graphics formula</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is a function that makes it possible to plot the figures for any pair of columns of <code>mtcars</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>plot.mtcars <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">form=</span>mpg<span class="sc">~</span>hp, <span class="at">data=</span>mtcars){</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(form, <span class="at">data=</span>data)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    vars <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(form)   <span class="co"># Extract the variable names</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="fl">1.5</span>, </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">paste</span>(<span class="st">"Plot of"</span>, vars[<span class="dv">1</span>], <span class="st">"versus"</span>, vars[<span class="dv">2</span>]))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observe that the function body is enclosed in braces ({ }). <a href="#fig-fig4" class="quarto-xref">Figure&nbsp;<span>1.4</span></a> shows the graph produced by <code>plot.mtcars()</code>. Parameter settings were left at their defaults.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.mtcars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="basics_files/figure-html/fig-fig4-1.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: Plot of miles per gallon versus horsepower, for cars in the <code>mtcars</code> data frame
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="common-useful-functions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="common-useful-functions">Common Useful Functions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>()     <span class="co"># Prints a single R object</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>()       <span class="co"># Prints multiple objects, one after the other</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>()    <span class="co"># Number of elements in a vector or of a list</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>()</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>()</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>()</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>()    <span class="co"># Gives the vector of distinct values</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>()      <span class="co"># Replace a vector by the vector of first differences</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>              <span class="co"># N. B. diff(x) has one less element than x</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>()      <span class="co"># Sort elements into order, but omitting NAs</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="fu">order</span>()     <span class="co"># x[order(x)] orders elements of x, with NAs last</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>()</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cumprod</span>()</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rev</span>()       <span class="co"># reverse the order of vector elements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The functions <code>mean()</code>, <code>median()</code>, <code>range()</code>, and a number of other functions, allow the argument <code>na.rm=T</code>; i.e.&nbsp;remove <code>NA</code>s, then proceed with the calculation. By default, <code>sort()</code> omits any <code>NA</code>s. The function <code>order()</code> places <code>NA</code>s last. Hence:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,  <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">22</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">order</span>(x)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">4</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">order</span>(x)]</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">1</span>  <span class="dv">2</span> <span class="dv">20</span> <span class="dv">22</span> <span class="cn">NA</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">1</span>  <span class="dv">2</span> <span class="dv">20</span> <span class="dv">22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="string-functions" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="string-functions">String Functions</h4>
<pre><code>substring(&lt;vector of text strings&gt;, &lt;first position&gt;, &lt;last position&gt;)
nchar(&lt;vector of text strings&gt;)       
              ## Returns vector of number of characters in each element.</code></pre>
</section>
</section>
<section id="the-functions-sapply-lapply-apply-and-tapply" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-functions-sapply-lapply-apply-and-tapply">The functions <code>sapply()</code>, <code>lapply()</code>, <code>apply()</code>, and <code>tapply()</code></h3>
<p>The functions are called as follows:</p>
<pre><code>lapply(&lt;list&gt;, &lt;function&gt;) 
               ## N. B. A dataframe is a list.  Output is a list.
sapply(&lt;list&gt;, &lt;function&gt;)              
               ## As lapply(), but simplify (e.g. to a vector
               ## or matrix), if possible.
apply(&lt;array&gt;, &lt;dimension&gt;, &lt;function&gt;)</code></pre>
<p>Both <code>sapply()</code> (‘s’=‘simplify’) and <code>lapply()</code> (‘l’=‘list’) can be used with lists or with vectors, as well as with dataframes.<br>
The function <code>lapply()</code> works in the same way as <code>sapply()</code>, but generates a list, and does not attempt to bring the list elements together into a common structure.</p>
<p>to the rows or columns of a matrix, can also be used with matrices. It can also be used with arrays of more than two dimensions.</p>
<p>The functions <code>sapply()</code> and <code>lapply()</code> take as arguments data frame, and the function that is to be applied. The following applies the function <code>is.factor()</code> to all columns of the supplied data frame rainforest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(DAAG<span class="sc">::</span>rainforest, is.factor)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    dbh    wood    bark    root  rootsk  branch species </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="cn">FALSE</span>   <span class="cn">FALSE</span>   <span class="cn">FALSE</span>   <span class="cn">FALSE</span>   <span class="cn">FALSE</span>   <span class="cn">FALSE</span>    <span class="cn">TRUE</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(DAAG<span class="sc">::</span>rainforest[,<span class="sc">-</span><span class="dv">7</span>], range)   <span class="co"># The final column (7) is a factor</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>     dbh wood bark root rootsk branch</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]   <span class="dv">4</span>   <span class="cn">NA</span>   <span class="cn">NA</span>   <span class="cn">NA</span>     <span class="cn">NA</span>     <span class="cn">NA</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="dv">56</span>   <span class="cn">NA</span>   <span class="cn">NA</span>   <span class="cn">NA</span>     <span class="cn">NA</span>     <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One can specify na.rm=TRUE as a third argument to <code>sapply()</code>.<br>
This argument is then automatically passed to the function that is specified in the second argument position. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(DAAG<span class="sc">::</span>rainforest[,<span class="sc">-</span><span class="dv">7</span>], range, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>     dbh wood bark root rootsk branch</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]   <span class="dv">4</span>    <span class="dv">3</span>    <span class="dv">8</span>    <span class="dv">2</span>    <span class="fl">0.3</span>      <span class="dv">4</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="dv">56</span> <span class="dv">1530</span>  <span class="dv">105</span>  <span class="dv">135</span>   <span class="fl">24.0</span>    <span class="dv">120</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code returns that number of missing values in each column of the data frame <code>airquality</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(airquality, <span class="cf">function</span>(x)<span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  Ozone Solar.R    Wind    Temp   Month     Day </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>     <span class="dv">37</span>       <span class="dv">7</span>       <span class="dv">0</span>       <span class="dv">0</span>       <span class="dv">0</span>       <span class="dv">0</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>apply()</code> can be used on data frames as well as matrices and arrays. An example that calculates means for each column is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(airquality,<span class="dv">2</span>,mean)   <span class="co"># All elements must be numeric!</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  Ozone Solar.R    Wind    Temp   Month     Day </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>     <span class="cn">NA</span>      <span class="cn">NA</span>    <span class="fl">9.96</span>   <span class="fl">77.88</span>    <span class="fl">6.99</span>   <span class="fl">15.80</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(airquality,<span class="dv">2</span>,mean,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  Ozone Solar.R    Wind    Temp   Month     Day </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.13</span>  <span class="fl">185.93</span>    <span class="fl">9.96</span>   <span class="fl">77.88</span>    <span class="fl">6.99</span>   <span class="fl">15.80</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The use of <code>apply(airquality,1,mean)</code> will give means for each row.<br>
These are not, for these data, useful information!</p>
<section id="an-example-that-uses-sapply-with-a-vector-of-text-strings-.unnumbered" class="level4">
<h4 class="anchored" data-anchor-id="an-example-that-uses-sapply-with-a-vector-of-text-strings-.unnumbered">*An example that uses <code>sapply()</code> with a vector of text strings {.unnumbered}</h4>
<p>We will work with the column <code>Make</code> in the dataset <code>MASS::Cars93</code>. To find the position at which the first space appears in the information on make of car, we might do the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>Cars93 <span class="ot">&lt;-</span> MASS<span class="sc">::</span>Cars93</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>car.brandnames <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">strsplit</span>(<span class="fu">as.character</span>(Cars93<span class="sc">$</span>Make), <span class="st">" "</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>),</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>                         <span class="cf">function</span>(x)x[<span class="dv">1</span>])</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>car.brandnames[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Acura"</span> <span class="st">"Acura"</span> <span class="st">"Audi"</span>  <span class="st">"Audi"</span>  <span class="st">"BMW"</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-aggregate-and-tapply" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-aggregate-and-tapply">Using <code>aggregate()</code> and <code>tapply()</code></h4>
<p>The arguments are in each case a variable, a list of factors, and a function that operates on a vector to return a single value. For each combination of factor levels, the function is applied to corresponding values of the variable.<br>
The function <code>aggregate()</code> returns a data frame. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>cabbages <span class="ot">&lt;-</span> MASS<span class="sc">::</span>cabbages</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cabbages)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="st">'data.frame'</span><span class="sc">:</span>   <span class="dv">60</span> obs. of  <span class="dv">4</span> variables<span class="sc">:</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> Cult  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">"c39"</span>,<span class="st">"c52"</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Date  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">3</span> levels <span class="st">"d16"</span>,<span class="st">"d20"</span>,<span class="st">"d21"</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> HeadWt<span class="sc">:</span> num  <span class="fl">2.5</span> <span class="fl">2.2</span> <span class="fl">3.1</span> <span class="fl">4.3</span> <span class="fl">2.5</span> <span class="fl">4.3</span> <span class="fl">3.8</span> <span class="fl">4.3</span> <span class="fl">1.7</span> <span class="fl">3.1</span> ...</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> VitC  <span class="sc">:</span> int  <span class="dv">51</span> <span class="dv">55</span> <span class="dv">45</span> <span class="dv">42</span> <span class="dv">53</span> <span class="dv">50</span> <span class="dv">50</span> <span class="dv">52</span> <span class="dv">56</span> <span class="dv">49</span> ...</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(cabbages, <span class="fu">aggregate</span>(HeadWt, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Cult=</span>Cult, <span class="at">Date=</span>Date), <span class="at">FUN=</span>mean))</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  Cult Date    x</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  c39  d16 <span class="fl">3.18</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  c52  d16 <span class="fl">2.26</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  c39  d20 <span class="fl">2.80</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  c52  d20 <span class="fl">3.11</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  c39  d21 <span class="fl">2.74</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  c52  d21 <span class="fl">1.47</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The syntax for <code>tapply()</code> is similar, except that the name of the second argument is <code>INDEX</code> rather than <code>by</code>. The output is an array with as many dimensions as there are factors. Where there are no data values for a particular combination of factor levels, <code>NA</code> is returned.</p>
</section>
<section id="functions-for-confidence-intervals-and-tests" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="functions-for-confidence-intervals-and-tests">Functions for Confidence Intervals and Tests</h4>
<p>Two of the simpler functions are <code>t-test</code> (allows both a one-sample and a two-sample test) and <code>chisq.test()</code> for testing for no association between rows and columns in a two way table. (This assumes counts enter independently into the cells&nbsp;of the table. The test is invalid if there is clustering in the data.)</p>
<p>Use the help pages to get more complete information.</p>
</section>
<section id="matching-and-ordering" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="matching-and-ordering">Matching and Ordering</h4>
<pre><code>match(&lt;vec1&gt;, &lt;vec2&gt;)  ## For each element of &lt;vec1&gt;, returns the 
                       ## position of the first occurrence in &lt;vec2&gt;
order(&lt;vector&gt;)        ## Returns the vector of subscripts giving
                       ## the order in which elements must be taken
                       ## so that &lt;vector&gt; will be sorted.
rank(&lt;vector&gt;)         ## Returns the ranks of the successive elements.</code></pre>
<p>Numeric vectors will be sorted in numerical order. Character vectors will be sorted in alphanumeric order. The operator <code>%in%</code> can be used to pick out subsets of data. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>two4 <span class="ot">&lt;-</span> x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>two4</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span>  <span class="cn">TRUE</span>  <span class="cn">TRUE</span>  <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span>  <span class="cn">TRUE</span>  <span class="cn">TRUE</span>  <span class="cn">TRUE</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Now pick out the 2s and the 4s</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>x[two4]</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compare-working-directory-data-sets-with-a-reference-set" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="compare-working-directory-data-sets-with-a-reference-set">Compare Working Directory Data Sets with a Reference Set</h4>
<p>At the beginning of a new session, we might store the names of the objects in the working directory in the vector dsetnames, thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>dsetnames <span class="ot">&lt;-</span> <span class="fu">objects</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now suppose that we have a function additions(), defined thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>additions <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">objnames =</span> dsetnames)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>        newnames <span class="ot">&lt;-</span> <span class="fu">objects</span>(<span class="at">pos=</span><span class="dv">1</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>        existing <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(<span class="fu">match</span>(newnames, objnames, <span class="at">nomatch =</span> <span class="dv">0</span>))</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>        newnames[<span class="sc">!</span>existing]</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>At some later point in the session, we can enter</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">additions</span>(dsetnames)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>to get the names of objects that have been added since the start of the session.</p>
</section>
<section id="a-simulation-example" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-simulation-example">A Simulation Example</h4>
<p>We would like to know how well such a student might do by random guessing, on a multiple choice test consisting of 15 questions each with five alternatives. If the choice is truly random, with the same probability for all 5 possibilities, we can simulate the correctness of the student for each question by using <code>sample(1:5, size=1)</code>, taking <code>1</code> as ‘correct’ and any other number as ‘wrong’. For 15 questions we can do <code>sample(1:5, replace=T, size=15)</code>, and repeat this perhaps 1000 times to get an idea of the distribution of number of right&nbsp;answers. Or we can calculate the distribution as <code>dbinom(x, size=15, prob=0.2)</code>, with <code>x</code> running from 0 to 15.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>resp1000 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">replace=</span>T, <span class="at">size=</span><span class="dv">15000</span>),<span class="at">nrow=</span><span class="dv">1000</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Each row counts as one set of responses</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>correct <span class="ot">&lt;-</span> <span class="fu">apply</span>(resp1000, <span class="dv">1</span>, <span class="cf">function</span>(x)<span class="fu">sum</span>(x<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Look at distribution of number of correct&nbsp;answers.</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(correct)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>correct</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">3</span>     <span class="dv">4</span>     <span class="dv">5</span>     <span class="dv">6</span>     <span class="dv">7</span>     <span class="dv">8</span>     <span class="dv">9</span> </span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.034</span> <span class="fl">0.143</span> <span class="fl">0.256</span> <span class="fl">0.238</span> <span class="fl">0.187</span> <span class="fl">0.098</span> <span class="fl">0.029</span> <span class="fl">0.010</span> <span class="fl">0.004</span> <span class="fl">0.001</span> </span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Now use `dbinom()` to obtain expected numbers</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="fu">round</span>(<span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">size=</span><span class="dv">15</span>, <span class="at">prob=</span><span class="fl">0.2</span>), <span class="dv">3</span>), <span class="dv">0</span><span class="sc">:</span><span class="dv">15</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">3</span>     <span class="dv">4</span>     <span class="dv">5</span>     <span class="dv">6</span>     <span class="dv">7</span>     <span class="dv">8</span>     <span class="dv">9</span>    <span class="dv">10</span> </span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="fl">0.035</span> <span class="fl">0.132</span> <span class="fl">0.231</span> <span class="fl">0.250</span> <span class="fl">0.188</span> <span class="fl">0.103</span> <span class="fl">0.043</span> <span class="fl">0.014</span> <span class="fl">0.003</span> <span class="fl">0.001</span> <span class="fl">0.000</span> </span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For x&gt;0, the probability is no more than 0.0005</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">pbinom</span>(<span class="dv">8</span>, <span class="at">size=</span><span class="dv">15</span>, <span class="at">prob=</span><span class="fl">0.2</span>, <span class="at">lower.tail=</span>F),<span class="dv">4</span>)  <span class="do">## 9 or more</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">8e-04</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="poisson-random-numbers" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="poisson-random-numbers">Poisson Random Numbers</h4>
<p>One can think of the Poisson distribution as the distribution of the total for occurrences of rare events. For example, an accident at an intersection on any one day should be a rare event. The total number of accidents over the course of a year may well follow a distribution that is close to Poisson. However, the total number of people injured is unlikely to follow a Poisson distribution. Why?</p>
<p>The function using <code>rpois()</code> generates Poisson random numbers. Suppose for example that traffic accidents occur at an intersection with a Poisson distribution that has a mean rate of 3.7 per year. To simulate the annual number of accidents for a 10-year period, we can specify <code>rpois(10,3.7)</code>. We pursue the Poisson distribution in an exercise below.</p>
</section>
<section id="functions-that-assist-with-data-management" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="functions-that-assist-with-data-management">Functions that assist with data management</h4>
<p>Where data, labeling etc must be pulled together from a number of sources, and especially where you may want to retrace your steps some months later, take the same care over structuring data as over structuring code. Thus if there is a factorial structure to the data files, choose file names that reflect it. You can then generate the file names automatically, using paste() to glue the separate portions of the name together.</p>
<p>Lists are a useful mechanism for grouping together all data and labeling information that one may wish to bring together in a single set of computations. Use as the name of the list a unique and meaningful identification code. Consider whether you should include objects as list items, or whether identification by name is preferable. Bear in mind, also, the use of <code>switch()</code>, with the identification code used to determine what <code>switch()</code> should pick out, to pull out specific information and data that is required for a particular run. Concentrate in one function the task of pulling together data and labeling information, perhaps with some subsequent manipulation, from a number of separate files. This structures the code, and makes the function a source of documentation for the data.</p>
</section>
</section>
<section id="issues-for-the-writing-and-use-of-functions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="issues-for-the-writing-and-use-of-functions">Issues for the Writing and Use of Functions</h3>
<p>There can be many functions. Choose their names and argument names carefully, so that they are meaningful, even if this means that they are longer than one would like.<br>
There are mechanisms by which names and argument names can be abbreviated in actual use. As far as possible, make code self-documenting. Use meaningful names for R objects. Ensure that the names used reflect the hierarchies of files, data structures and code.</p>
<p>R allows the use of names for elements of vectors and lists, and for rows and columns of arrays and dataframes. Consider the use of names rather than numbers when you pull out individual elements, columns etc. Thus dead.tot[,“dead”] is more meaningful and safer than dead.tot[,2]. Settings that may need to change in later use of the function should appear as default settings for parameters. Use lists, where this seems appropriate, to group together parameters that belong together conceptually.</p>
<p>Where appropriate, provide a demonstration mode for functions. Such a mode will print out summary information on the data and/or on the results of manipulations prior to analysis, with appropriate labeling. The code needed to implement this feature has the side-effect of showing by example what the function does, and may be useful for debugging.</p>
<p>Break functions up into a small number of sub-functions or “primitives”. Re-use existing functions wherever possible. Write any new “primitives” so that they can be re-used. This helps ensure that functions contain well-tested and well-understood components. Watch the r-help electronic mail list (section 13.3) for useful functions for routine tasks.</p>
<p>Wherever possible, give parameters sensible defaults. Often a good strategy is to use as defaults parameters that will serve for a demonstration run of the function.</p>
<p>NULL is a useful default where the parameter mostly is not required, but where the parameter if it appears may be any one of several types of data structure. The test if(!is.null()) then determines whether one needs to investigate that parameter further.</p>
<p>Structure computations so that it is easy to retrace them. For this reason substantial chunks of code should be incorporated into functions sooner rather than later.</p>
<p>Structure code to avoid multiple entry of information.</p>
</section>
</section>
<section id="making-tables" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="making-tables"><span class="header-section-number">1.9</span> Making Tables</h2>
<p>The function <code>table()</code> makes a table of counts. Specify one vector of values (often a factor) for each table margin that is required. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)    <span class="co"># The data frame `barley` is included in lattice</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(barley<span class="sc">$</span>year, barley<span class="sc">$</span>site)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>       Grand Rapids Duluth University Farm Morris Crookston Waseca</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1932</span>           <span class="dv">10</span>     <span class="dv">10</span>              <span class="dv">10</span>     <span class="dv">10</span>        <span class="dv">10</span>     <span class="dv">10</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1931</span>           <span class="dv">10</span>     <span class="dv">10</span>              <span class="dv">10</span>     <span class="dv">10</span>        <span class="dv">10</span>     <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>WARNING: <code>NA</code>s are by default ignored. The action needed to get <code>NA</code>s tabulated under a separate <code>NA</code> category depends, annoyingly, on whether or not the vector is a factor. If the vector is not a factor, specify <code>exclude=NULL</code>. If the vector is a factor then it is necessary to generate a new factor that includes <code>NA</code> as a level. Specify <code>x &lt;- factor(x,exclude=NULL)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="cn">NA</span>,<span class="dv">8</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(x)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span>    <span class="dv">5</span>    <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span> <span class="dv">8</span>   </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>Levels<span class="sc">:</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">8</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(x,<span class="at">exclude=</span><span class="cn">NULL</span>)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span>    <span class="dv">5</span>    <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span> <span class="dv">8</span>   </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>Levels<span class="sc">:</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">8</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="numbers-of-nas-in-subgroups-of-the-data" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="numbers-of-nas-in-subgroups-of-the-data">Numbers of NAs in subgroups of the data</h4>
<p>The following gives information on the number of NAs in subgroups of the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>rainforest <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>rainforest</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(rainforest<span class="sc">$</span>species, <span class="sc">!</span><span class="fu">is.na</span>(rainforest<span class="sc">$</span>branch))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                  <span class="cn">FALSE</span> <span class="cn">TRUE</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  Acacia mabellae     <span class="dv">6</span>   <span class="dv">10</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  C. fraseri          <span class="dv">0</span>   <span class="dv">12</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  Acmena smithii     <span class="dv">15</span>   <span class="dv">11</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  B. myrtifolia       <span class="dv">1</span>   <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thus for Acacia mabellae the variable <code>branch</code> (i.e.&nbsp;number of branches over 2cm in diameter) has 6 <code>NA</code>s, out of a total of 16 data values.</p>
</section>
</section>
<section id="pipes-a-do-this-then-do-that-syntax" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="pipes-a-do-this-then-do-that-syntax"><span class="header-section-number">1.10</span> Pipes – A “do this, then do that” syntax</h2>
<p>The following calculates the difference between the largest and the smallest tree height, in the <code>trees</code> dataframe (<em>datasets</em> package):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the relation: y/x = exp(log(y/x) = exp(log(y)-log(x))</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">range</span>(trees<span class="sc">$</span>Height))</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using a pipe, this can be written:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>trees<span class="sc">$</span>Height <span class="sc">|&gt;</span>     <span class="co"># Pipe vector of heights to function `range()`</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">range</span>() <span class="sc">|&gt;</span>        <span class="co"># Pipe (min, max) vector to function `diff()`</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>()</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data object (here, in both cases, a vector) is taken as the first argument of the function to which it is piped. Notice the ability to add commentary, at each step, that describes the operation that is to be performed.</p>
<p>To assign result, use either of the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> trees<span class="sc">$</span>Height <span class="sc">|&gt;</span> <span class="fu">range</span>() <span class="sc">|&gt;</span> <span class="fu">diff</span>()</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>trees<span class="sc">$</span>Height <span class="sc">|&gt;</span> <span class="fu">range</span>() <span class="sc">|&gt;</span> <span class="fu">diff</span>() <span class="ot">-&gt;</span> d</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Uses right assignment operator</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The assignment is the last operation performed. It is then in the spirit of the use of pipes to use the right assignment operator (<code>-&gt;</code>) to position the assignment last.</p>
<p>The following creates a new data frame where the columns hold the logarithms of the values of <code>Girth</code>, <code>Height</code>, and <code>Volume</code>, and changes the column names accordingly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>logtrees <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">log</span>(trees), <span class="fu">c</span>(<span class="st">"logGirth"</span>,<span class="st">"logHeight"</span>,<span class="st">"logVolume"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are three steps here – taking the logarithms, and changing the names. What is happening may be clearer if the pipe syntax is used to set them out in order:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>trees <span class="sc">|&gt;</span> <span class="fu">log</span>() <span class="sc">|&gt;</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"logGirth"</span>,<span class="st">"logHeight"</span>,<span class="st">"logVolume"</span>)) <span class="ot">-&gt;</span> logtrees</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice the specifying of the new names as a second argument, following the argument that is piped through from the previous line, to the function <code>setnames()</code>.</p>
<section id="pipe-to-several-functions-or-to-a-later-argument-than-the-first" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="pipe-to-several-functions-or-to-a-later-argument-than-the-first">Pipe to several functions, or to a later argument than the first</h3>
<p>The trick is to create an anonymous function for which the argument concerned is the only argument:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>LakeHuron <span class="sc">|&gt;</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    (<span class="cf">function</span>(x)<span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">SD =</span> <span class="fu">sd</span>(x), <span class="at">n=</span><span class="fu">length</span>(x)))() <span class="sc">|&gt;</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  mean     SD      n </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fl">579.00</span>   <span class="fl">1.32</span>  <span class="fl">98.00</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wrapping round brackets around the function definition causes it to be treated as a function name.</p>
<p>Note that <code>function(x)</code> can be abbreviated to <code>\(x)</code>.</p>
</section>
</section>
<section id="methods" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="methods"><span class="header-section-number">1.11</span> Methods</h2>
<p>R is an object-oriented language. Objects may have a <em>class</em>. Functions that have generic implementations include <code>print()</code>, <code>summary()</code>, and <code>plot()</code> the class of the object supplied as argument determines what action will be taken. Thus in response to <code>print(x)</code>, R determines the class attribute of <code>x</code>, if one exists. If for example the class attribute is <code>"factor"</code> then the function which finally handles the printing is <code>print.factor()</code>. The function <code>print.default()</code> is used to print objects that have not been assigned a class.</p>
<p>More generally, the class attribute of an object may be a character vector. If there are <em>ancestor</em> classes – parent, grandparent, . . ., these are specified in order in subsequent elements of the class vector. For example, ordered factors have the class <code>"ordered</code>“, which inherits from the class <code>"factor"</code>. Thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>fac<span class="ot">&lt;-</span><span class="fu">ordered</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(fac)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"ordered"</span> <span class="st">"factor"</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="some-further-programming-niceties" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="some-further-programming-niceties"><span class="header-section-number">1.12</span> Some Further Programming Niceties</h2>
<section id="extracting-arguments-to-functions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="extracting-arguments-to-functions">Extracting Arguments to Functions</h3>
<p>When an argument appears inside a function, it is taken to be another name for the object to which the argument refers. Other possibilities are that one might want the name itself, or the character vector that has the name. Thus, consider:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>fun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x)x</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>fun2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">substitute</span>(x)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>fun3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">deparse</span>(<span class="fu">substitute</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now see what happens, in the three cases, when the argument is the linear model object created thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>cars.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars) </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fun1</span>(cars.lm)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> dist <span class="sc">~</span> speed, <span class="at">data =</span> cars)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>(Intercept)        speed  </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="fl">17.58</span>         <span class="fl">3.93</span>  </span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fun2</span>(cars.lm)</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>cars.lm</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="fu">fun3</span>(cars.lm)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"cars.lm"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="parsing-and-evaluation-of-expressions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="parsing-and-evaluation-of-expressions">Parsing and Evaluation of Expressions</h3>
<p>When R encounters an expression such as <code>mean(x+y)</code> or <code>cbind(x,y)</code>, there are two steps:<br>
* The text string is parsed and turned into an expression, i.e.&nbsp;the syntax is checked and it is turned into code that the R computing engine can more immediately evaluate. * The expression is evaluated.<br>
Upon typing in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expression</span>(<span class="fu">mean</span>(x<span class="sc">+</span>y))</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">expression</span>(<span class="fu">mean</span>(x <span class="sc">+</span> y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>the output is the unevaluated expression <code>expression(mean(x+y))</code>. Setting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>my.exp <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">mean</span>(x<span class="sc">+</span>y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>stores this unevaluated expression in <code>my.exp</code>. The actual contents of <code>my.exp</code> are a little different from what is printed out. R gives as much information as it thinks helpful.</p>
<p>Note that <code>expression(mean(x+y))</code> is different from <code>expression(“mean(x+y)”)</code>, as is obvious when the expression is evaluated.<br>
Here is an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">110</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>my.exp <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">mean</span>(x<span class="sc">+</span>y))</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>my.txt <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="st">"mean(x+y)"</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(my.exp)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">131</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(my.txt)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"mean(x+y)"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>parse()</code>, used with the argument <code>text</code>, takes code that is stored in a text string and turns it into an expression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse</span>(<span class="at">text=</span><span class="st">"mean(x+y)"</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">expression</span>(<span class="fu">mean</span>(x <span class="sc">+</span> y))</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">expression</span>(<span class="fu">mean</span>(x <span class="sc">+</span> y))</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">expression</span>(<span class="fu">mean</span>(x <span class="sc">+</span> y))</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We store the expression in my.exp2, and then evaluate it</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>my.exp2 <span class="ot">&lt;-</span> <span class="fu">parse</span>(<span class="at">text=</span><span class="st">"mean(x+y)"</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(my.exp2, <span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y=</span><span class="dv">13</span><span class="sc">:</span><span class="dv">17</span>))</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">18</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y=</span><span class="dv">13</span><span class="sc">:</span><span class="dv">17</span>), <span class="fu">eval</span>(my.exp2))</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="next-steps" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="next-steps"><span class="header-section-number">1.13</span> Next steps</h2>
<p>It may pay, at this point, to glance through chapters 6 and 7, which have a more detailed coverage of the topics in this chapter. Remember also to use R’s help pages and functions. Topics from chapter 6, additional to those covered above, that may be important for relatively elementary uses of R include:</p>
<ul>
<li>The entry of patterned data (6.1.3)</li>
<li>The handling of missing values in subscripts when vectors are assigned (7.2)</li>
<li>Unexpected consequences (e.g.&nbsp;conversion of columns of numeric data into factors) from errors in data (6.4.1).</li>
</ul>
</section>
<section id="exercises" class="level2" data-number="1.14">
<h2 data-number="1.14" class="anchored" data-anchor-id="exercises"><span class="header-section-number">1.14</span> Exercises</h2>
<ol type="1">
<li>In the data frame <code>elasticband</code> from section 1.3.1, plot <code>distance</code> against <code>stretch</code>.</li>
<li>The following creates a data frame that has October snow cover (millions of square kilometers)) in Eurasia for the years 1970-79:<br>
</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>snowCover <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">1970</span><span class="sc">:</span><span class="dv">1979</span>,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">snow.cover =</span> <span class="fu">c</span>(<span class="fl">6.5</span>, <span class="dv">12</span>, <span class="fl">14.9</span>, <span class="dv">10</span>, <span class="fl">10.7</span>, <span class="fl">7.9</span>, <span class="fl">21.9</span>, <span class="fl">12.5</span>, <span class="fl">14.5</span>, <span class="fl">9.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="i">
<li>Enter the data into R.</li>
<li>Plot <code>snow.cover</code> versus <code>year</code>.<br>
</li>
<li>Use the <code>hist()</code> command to plot a histogram of the snow cover values.<br>
</li>
<li>Repeat ii and iii after taking logarithms of snow cover.</li>
</ol>
<!-- -->
<ol start="3" type="1">
<li>Input the following data, on damage that had occurred in space shuttle launches prior to the disastrous launch of Jan 28 1986. These are the data, for 6 launches out of 24, that were included in the pre-launch charts that were used in deciding whether to proceed with the launch. (Data for the 23 launches where information is available is in the data set <code>orings</code>, from the <em>DAAG</em> package.)</li>
</ol>
<table class="table">
<thead>
<tr class="header">
<th>Temperature</th>
<th>Erosion</th>
<th>Blowby</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>53</td>
<td>3</td>
<td>2</td>
<td>5</td>
</tr>
<tr class="even">
<td>57</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>63</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>70</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>70</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>75</td>
<td>0</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Enter these data into a dataframe, with (for example) column names <code>temperature</code>, <code>erosion</code>, <code>blowby</code> and <code>total</code>. (Refer back to <a href="#sec-entry" class="quarto-xref"><span>Section 1.6</span></a>). Plot total incidents against temperature.</p>
<ol start="4" type="1">
<li>For each of the following code sequences, predict the result. Then do the computation:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="do">## a) </span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>answer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>){ answer <span class="ot">&lt;-</span> j<span class="sc">+</span>answer }</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="do">## b)</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>answer<span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>){ answer <span class="ot">&lt;-</span> j<span class="sc">+</span>answer }</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="do">## c)</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>answer <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>){ answer <span class="ot">&lt;-</span> j<span class="sc">*</span>answer }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li><p>Look up the help for the function <code>prod()</code>, and use <code>prod()</code> to do the calculation in 1(c) above. Alternatively, how would you expect <code>prod()</code> to work? Try it!</p></li>
<li><p>Add up all the numbers from 1 to 100 in two different ways: using <code>for()</code>, and using <code>sum()</code>. Now apply the function to the sequence <code>1:100</code>. What is its action?</p></li>
<li><p>Multiply all the numbers from 1 to 50 in two different ways: using <code>for()</code> and using <code>prod()</code>.</p></li>
<li><p>The volume of a sphere of radius <span class="math inline">\(r\)</span> is <span class="math inline">\(4r^3/3\)</span>. For spheres having radii 3, 4, 5, …, 20 find the corresponding volumes and print the results out in a table. Construct a data frame with columns <code>radius</code> and <code>volume</code>.</p></li>
<li><p>Use <code>sapply()</code> to apply the function <code>is.factor()</code> to each column of the data frame <code>DAAG::tinting</code>. For each of the columns that are identified as factors, determine the levels. Which columns are ordered factors? [Use <code>is.ordered()</code>].</p></li>
<li><p>Generate and save the following sets of numbers:<br>
</p></li>
</ol>
<ol type="a">
<li>Generate the numbers 101, 102, …, 112, and store the result in the vector <code>x</code>.<br>
</li>
<li>Generate four repeats of the sequence of numbers (4, 6, 3).<br>
</li>
<li>Generate the sequence consisting of eight 4s, then seven 6s, and finally nine 3s. Store the numbers obtained , in order, in the columns of a 6 by 4 matrix.<br>
</li>
<li>Create a vector consisting of one 1, then two 2’s, three 3’s, etc., and ending with nine 9’s.</li>
</ol>
<ol start="11" type="1">
<li>For each of the following calculations, what you would expect? Check to see if you were right!<br>
</li>
</ol>
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>answer <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">4</span>)  </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(answer)){ answer[j] <span class="ot">&lt;-</span> <span class="fu">max</span>(answer[j],answer[j<span class="dv">-1</span>])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>answer <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(answer)){ answer[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(answer[j],answer[j<span class="dv">-1</span>])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="12" type="1">
<li>In the data frame <code>airquality</code> (<em>datasets</em> package):<br>
</li>
</ol>
<ol type="a">
<li>Determine, for each of the columns, the median, mean, upper and lower quartiles, and range;<br>
</li>
<li>Extract the row or rows for which Ozone has its maximum value;<br>
</li>
<li>extract the vector of values of <code>Wind</code> for values of <code>Ozone</code> that are above the upper quartile.</li>
</ol>
<ol start="13" type="1">
<li><p>Refer to the Eurasian snow data that is given in Exercise 1.6.<br>
Find the mean of the snow cover (a) for the odd-numbered years and (b) for the even-numbered years.</p></li>
<li><p>Determine which columns of the data frame <code>MASS::Cars93</code> are factors. For each of these factor columns, print out the levels vector. Which of these are ordered factors?</p></li>
<li><p>Use <code>summary()</code> to get information about data in the data frame <code>attitude</code> (in the <code>datasets</code> package), and <code>MASS::cpus</code>. Comment, for each of these data sets, on what this reveals.</p></li>
<li><p>From the data frame <code>MASS::mtcars</code> extract a data frame <code>mtcars6</code> that holds only the information for cars with 6 cylinders.</p></li>
<li><p>From the data frame <code>MASS::Cars93</code>, extract a data frame which holds information for small and sporty cars.</p></li>
<li><p>Use the function <code>sample()</code> function to generate 100 random integers between 0 and 19. Now look up the help for <code>runif()</code>, and use it for the same purpose. [Count a value between 0&nbsp;and 0.05 as 0, where the range is from 0 to 1.]</p></li>
<li><p>Write a function that will take as its arguments a list of response variables, a list of factors, a data frame, and a function such as mean or median. It will return a data frame in which each value for each combination of factor levels is summarized in a single statistic, for example the mean or the median.</p></li>
<li><p>Determine the number of days, according to R, between the following dates:<br>
</p></li>
</ol>
<ol type="a">
<li>January 1 in the year 1700, and January 1 in the year 1800<br>
</li>
<li>January 1 in the year 1998, and January 1 in the year 2000</li>
</ol>
<ol start="21" type="1">
<li>Seventeen people rated the sweetness of each of two samples of a milk product on a continuous scale from 1 to 7, one sample with four units of additive and the other with one unit of additive. The data frame <code>DAAG::milk</code>, with columns <code>four</code> and <code>one</code>, shows the ratings.<br>
Here is a function that plots, for each patient, the four result against the one result, with the same range for the <code>x</code> and <code>y</code> axes.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>plot.one <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  xyrange <span class="ot">&lt;-</span> <span class="fu">range</span>(milk)   <span class="co"># Calculates the range of all values in the data frame</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">6.75</span>, <span class="fl">6.75</span>))      <span class="co"># Set plotting area = 6.75 in. by 6.75 in.</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(four, one, <span class="at">data=</span>milk, <span class="at">xlim=</span>xyrange, <span class="at">ylim=</span>xyrange, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)                  <span class="co"># Line where four = one</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rewrite this function so that, given the name of a data frame and of any two of its columns, it will plot the second named column against the first named column, showing also the line <code>y = x</code>.</p>
<ol start="22" type="1">
<li><p>Write a function that prints, with their row and column labels, only those elements of a correlation matrix for <code>which abs(correlation) &gt;= 0.9</code>.</p></li>
<li><p>Write q wrapper function for one-way analysis of variance that provides a side by side boxplot of the distribution of values by groups. If no response variable is specified, the function will generate random normal data (no difference between groups) and provide the analysis of variance and show the boxplot.</p></li>
<li><p>Use the function <code>zoo::rollmean</code> to compute the moving average of order 2 of the data for levels of Lake Erie, included in the dataset <code>DAAG::greatLakes</code>. Repeat for order 3.</p></li>
<li><p>Create a function to compute the average, variance and standard deviation of 1000 randomly generated uniform random numbers, on [0,1]. Compare your results with the theoretical results. The expected value of a uniform random variable on [0,1] is 0.5, and the variance of such a random variable is 0.0833.</p></li>
<li><p>Write a function that generates 100 independent observations on a uniformly distributed random variable on the interval [3.7, 5.8].<br>
Find the mean, variance and standard deviation of such a uniform random variable. Now modify the function so that you can specify an arbitrary interval.</p></li>
<li><p>Look up the help for the <code>sample()</code> function. Use it to generate 50 random integers between 0 and 99, sampled without replacement. (This means that we do not allow any number to be sampled a second time.) Repeat several times. Now, generate 50 random integers between 0 and 9, with replacement. Determine the proportion of integers that occur more than once.</p></li>
<li><p>Write an R function that simulates a student guessing at a True-False test consisting of 40 questions. Find the mean and variance of the student’s answers. Compare with the theoretical values of .5 and .25.</p></li>
<li><p>Write an R function that simulates a student guessing at a multiple choice test consisting of 40 questions, where there is a chance of 1 in 5 of getting the right answer to each question.<br>
Find the mean and variance of the student’s answers. Compare with the theoretical values of .2 and .16.</p></li>
<li><p>Write an R function that simulates the number of working light bulbs out of 500, where each bulb has a probability .99 of working.<br>
Using simulation, estimate the expected value and variance of the random variable <code>X</code>, which is 1 if the light bulb works and 0 if the light bulb does not work. What are the theoretical values?</p></li>
<li><p>Write a function that does an arbitrary number <code>n</code> of repeated simulations of the number of accidents in a year, plotting the result in a suitable way. Assume that the number of accidents in a year follows a Poisson distribution. Run the function assuming an average rate of 2.8 accidents per year.</p></li>
<li><p>Write a function that simulates the repeated calculation of the coefficient of variation (= the ratio of the mean to the standard deviation), for independent random samples from a normal distribution.</p></li>
<li><p>Write a function that, for any sample, calculates the median of the absolute values of the deviations from the sample median.</p></li>
<li><p>*Generate random samples from normal, exponential, t (2 d.&nbsp;f.), and t (1 d.&nbsp;f.), thus:<br>
</p></li>
</ol>
<ol type="a">
<li><code>xn &lt;- rnorm(100)</code> (b) <code>xe &lt;- rexp(100)</code><br>
</li>
<li><code>xt2 &lt;- rt(100, df=2)</code> (d) <code>xt2 &lt;- rt(100, df=1)</code><br>
Apply the function from exercise 17 to each sample. Compare with the standard deviation in each case.</li>
</ol>
<ol start="35" type="1">
<li><p>*The vector x consists of the frequencies<br>
5, 3, 1, 4, 6<br>
The first element is the number of occurrences of level 1 of a factor, the second is the number of occurrences of level 2, and so on. Write a function that takes any such vector x as its input, and outputs the vector of factor levels, here 1 1 1 1 1 2 2 2 3 . . .<br>
[You’ll need the information that is provided by <code>cumsum(x)</code>. Form a vector in which 1’s appear whenever the factor level is incremented, and is otherwise zero. . . .]</p></li>
<li><p>*Write a function that calculates the minimum of a quadratic expression, and the value of the function at the minimum.</p></li>
<li><p>*A “between times” correlation matrix, has been calculated from data on heights of trees at times 1, 2, 3, 4, . . . Write a function that calculates the average of the correlations for any given lag.</p></li>
<li><p>*Given data on trees at times 1, 2, 3, 4, . . ., write a function that calculates the matrix of “average” relative growth rates over the for each interval.</p></li>
</ol>
</section>
<section id="references-and-reading" class="level2" data-number="1.15">
<h2 data-number="1.15" class="anchored" data-anchor-id="references-and-reading"><span class="header-section-number">1.15</span> References and reading</h2>
<p><span class="citation" data-cites="BraunMurdoch_2021">Braun and Murdoch (<a href="references.html#ref-BraunMurdoch_2021" role="doc-biblioref">2021</a>)</span> . A first course in statistical programming with R.</p>
<p><span class="citation" data-cites="Dalg">Dalgaard (<a href="references.html#ref-Dalg" role="doc-biblioref">2008</a>)</span> . Introductory Statistics with R.<br>
[This introductory text has a biostatistical emphasis.]</p>
<p><span class="citation" data-cites="maindonald2010data">J. Maindonald and Braun (<a href="references.html#ref-maindonald2010data" role="doc-biblioref">2010</a>)</span> . Data Analysis and Graphics Using R –- An Example-Based Approach.</p>
<p><span class="citation" data-cites="maindonald2023">J. Maindonald, Braun, and Andrews (<a href="references.html#ref-maindonald2023" role="doc-biblioref">2024, forthcoming</a>)</span> . A Practical Guide to Data Analysis Using R. An Example-Based Approach. Cambridge University Press.<br>
[Appendix A gives a brief overview of the R language and system.]</p>
<p><span class="citation" data-cites="Matloff2011">Matloff (<a href="references.html#ref-Matloff2011" role="doc-biblioref">2011</a>)</span> . The Art of R Programming.</p>
<p><span class="citation" data-cites="Murrell-Data">Murrell (<a href="references.html#ref-Murrell-Data" role="doc-biblioref">2009</a>)</span> . Introduction to data technologies.</p>
<p><span class="citation" data-cites="Muenchen">Muenchen (<a href="references.html#ref-Muenchen" role="doc-biblioref">2011</a>)</span> . R for SAS and SPSS Users.</p>
<p><span class="citation" data-cites="VR-MASS">Venables and Ripley (<a href="references.html#ref-VR-MASS" role="doc-biblioref">2002</a>)</span> . Modern Applied Statistics with S.<br>
[This assumes a fair level of statistical sophistication. Explanation is careful, but often terse.]</p>
<p><span class="citation" data-cites="Wickham-RforData">Wickham (<a href="references.html#ref-Wickham-RforData" role="doc-biblioref">2016</a>)</span> . R for Data Science.</p>
<section id="references-to-packages" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="references-to-packages">References to packages</h3>
<p>DAAG: <span class="citation" data-cites="R-DAAG">J. H. Maindonald and Braun (<a href="references.html#ref-R-DAAG" role="doc-biblioref">2022</a>)</span></p>
<p>lattice: <span class="citation" data-cites="R-lattice">Sarkar (<a href="references.html#ref-R-lattice" role="doc-biblioref">2023</a>)</span></p>
<p>MASS: <span class="citation" data-cites="R-MASS">Ripley (<a href="references.html#ref-R-MASS" role="doc-biblioref">2023</a>)</span></p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-BraunMurdoch_2021" class="csl-entry" role="listitem">
Braun, W. John, and Duncan J. Murdoch. 2021. <em>A First Course in Statistical Programming with <span>R</span></em>. 3rd ed. Cambridge University Press.
</div>
<div id="ref-Dalg" class="csl-entry" role="listitem">
Dalgaard, Peter. 2008. <em>Introductory Statistics with <span>R</span></em>. 2nd ed. Springer.
</div>
<div id="ref-R-DAAG" class="csl-entry" role="listitem">
Maindonald, John H, and W. John Braun. 2022. <em>DAAG: Data Analysis and Graphics Data and Functions</em>. <a href="https://gitlab.com/daagur">https://gitlab.com/daagur</a>.
</div>
<div id="ref-maindonald2010data" class="csl-entry" role="listitem">
Maindonald, John, and John Braun. 2010. <em>Data Analysis and Graphics Using r: An Example-Based Approach</em>. Cambridge University Press.
</div>
<div id="ref-maindonald2023" class="csl-entry" role="listitem">
Maindonald, John, W John Braun, and Jeffrey Andrews. 2024, forthcoming. <em>A Practical Guide to Data Analysis Using r. An Example-Based Approach.</em> Cambridge University Press. <a href="https://jhmaindonald.github.io/PGRcode">https://jhmaindonald.github.io/PGRcode</a>.
</div>
<div id="ref-Matloff2011" class="csl-entry" role="listitem">
Matloff, Norman. 2011. <em>The Art of r Programming</em>. No Starch Inc.
</div>
<div id="ref-Muenchen" class="csl-entry" role="listitem">
Muenchen, R. A. 2011. <em>R for SAS and SPSS Users</em>. 2nd ed. Springer. <a href="http://r4stats.com/books/r4sas-spss/">http://r4stats.com/books/r4sas-spss/</a>.
</div>
<div id="ref-Murrell-Data" class="csl-entry" role="listitem">
Murrell, Paul. 2009. <em>Introduction to Data Technologies</em>. 1st ed. CRC Press.
</div>
<div id="ref-R-MASS" class="csl-entry" role="listitem">
Ripley, Brian. 2023. <em>MASS: Support Functions and Datasets for Venables and Ripley’s MASS</em>. <a href="http://www.stats.ox.ac.uk/pub/MASS4/">http://www.stats.ox.ac.uk/pub/MASS4/</a>.
</div>
<div id="ref-R-lattice" class="csl-entry" role="listitem">
Sarkar, Deepayan. 2023. <em>Lattice: Trellis Graphics for r</em>. <a href="https://lattice.r-forge.r-project.org/">https://lattice.r-forge.r-project.org/</a>.
</div>
<div id="ref-VR-MASS" class="csl-entry" role="listitem">
Venables, W. N., and B. D. Ripley. 2002. <em>Modern Applied Statistics with <span>S</span></em>. 4th ed. Springer.
</div>
<div id="ref-Wickham-RforData" class="csl-entry" role="listitem">
Wickham, H. 2016. <em>R for Data Science</em>. O’Reilly.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link  aria-label=" preface"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./graphs.html" class="pagination-link" aria-label="<span class='chapter-number'>2</span>&nbsp; <span class='chapter-title'>Base R Graphics</span>">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Base R Graphics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>
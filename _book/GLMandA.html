<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Using R for Data Analysis and Graphics - 4&nbsp; Generalized Linear and Additive Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ts.html" rel="next">
<link href="./reg.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Generalized Linear and Additive Models</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Using R for Data Analysis and Graphics</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An overview of the R system</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Base R Graphics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GLMandA.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Generalized Linear and Additive Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regular Time Series in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trees.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tree-based models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mva.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Level Models and Repeated Measures Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#extending-the-linear-model" id="toc-extending-the-linear-model" class="nav-link active" data-scroll-target="#extending-the-linear-model"><span class="toc-section-number">4.1</span>  Extending the Linear Model</a>
  <ul class="collapse">
  <li><a href="#multiple-regression-models" id="toc-multiple-regression-models" class="nav-link" data-scroll-target="#multiple-regression-models"><span class="toc-section-number">4.1.1</span>  Multiple regression models</a></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="toc-section-number">4.2</span>  Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#anesthetic-depth-example" id="toc-anesthetic-depth-example" class="nav-link" data-scroll-target="#anesthetic-depth-example"><span class="toc-section-number">4.2.1</span>  Anesthetic Depth Example</a></li>
  </ul></li>
  <li><a href="#glm-models-generalized-linear-regression-modelling" id="toc-glm-models-generalized-linear-regression-modelling" class="nav-link" data-scroll-target="#glm-models-generalized-linear-regression-modelling"><span class="toc-section-number">4.3</span>  GLM models (Generalized Linear Regression Modelling)</a>
  <ul class="collapse">
  <li><a href="#data-in-the-form-of-counts" id="toc-data-in-the-form-of-counts" class="nav-link" data-scroll-target="#data-in-the-form-of-counts"><span class="toc-section-number">4.3.1</span>  Data in the form of counts</a></li>
  <li><a href="#the-gaussian-family" id="toc-the-gaussian-family" class="nav-link" data-scroll-target="#the-gaussian-family"><span class="toc-section-number">4.3.2</span>  The gaussian family</a></li>
  </ul></li>
  <li><a href="#models-that-include-spline-terms" id="toc-models-that-include-spline-terms" class="nav-link" data-scroll-target="#models-that-include-spline-terms"><span class="toc-section-number">4.4</span>  Models that include spline terms</a>
  <ul class="collapse">
  <li><a href="#dewpoint-data" id="toc-dewpoint-data" class="nav-link" data-scroll-target="#dewpoint-data"><span class="toc-section-number">4.4.1</span>  Dewpoint Data</a></li>
  <li><a href="#model-summaries" id="toc-model-summaries" class="nav-link" data-scroll-target="#model-summaries"><span class="toc-section-number">4.4.2</span>  Model Summaries</a></li>
  </ul></li>
  <li><a href="#further-types-of-model" id="toc-further-types-of-model" class="nav-link" data-scroll-target="#further-types-of-model"><span class="toc-section-number">4.5</span>  Further types of model</a>
  <ul class="collapse">
  <li><a href="#survival-analysis" id="toc-survival-analysis" class="nav-link" data-scroll-target="#survival-analysis"><span class="toc-section-number">4.5.1</span>  Survival Analysis</a></li>
  <li><a href="#nonlinear-models" id="toc-nonlinear-models" class="nav-link" data-scroll-target="#nonlinear-models"><span class="toc-section-number">4.5.2</span>  Nonlinear Models</a></li>
  </ul></li>
  <li><a href="#further-elaborations" id="toc-further-elaborations" class="nav-link" data-scroll-target="#further-elaborations"><span class="toc-section-number">4.6</span>  Further Elaborations</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">4.7</span>  Exercises</a></li>
  <li><a href="#references-and-reading" id="toc-references-and-reading" class="nav-link" data-scroll-target="#references-and-reading"><span class="toc-section-number">4.8</span>  References and reading</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Generalized Linear and Additive Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Generalized Linear Models (GLMs) extend multiple regression style models. Generalized Additive Models (GAMs) are a further extension.</p>
<section id="extending-the-linear-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="extending-the-linear-model"><span class="header-section-number">4.1</span> Extending the Linear Model</h2>
<p>The basic model formulation is:</p>
<pre><code>Observed value = Model Prediction + Statistical Error  </code></pre>
<p>Often it is assumed that the statistical error values (values of <span class="math inline">\(\epsilon\)</span> in the discussion below) are independently and identically distributed as Normal. Generalized Linear Models, and the other extensions we describe, allow a variety of non-normal distributions. In the discussion of this section, the focus is on the form of the model prediction, leaving until later sections the discussion of different possibilities for the ‘error’ distribution.</p>
<section id="multiple-regression-models" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="multiple-regression-models"><span class="header-section-number">4.1.1</span> Multiple regression models</h3>
<p>The various other models we describe are, in essence, generalizations of the multiple regression model, fitted in earlier chapters using <code>lm()</code>. <span class="math display">\[
    y = b_0 + b_1 x_1 + b_2 x_2 + . . . + b_p x_p + \epsilon
\]</span> ### Generalized Linear Model (e.g.&nbsp;logit model) To simplify the discussion, a single explanatory variable will be assumed. <span class="math display">\[
    y = g(b_0 + b_1 x_1) + \epsilon,\\
    \mbox{so that } \mbox{E}[y] = g(b_0 + b_1 x_1)
\]</span> Here <code>g()</code> is selected from one of a small number of options. For logit models, with <span class="math inline">\(\mu\)</span> the expected number of ‘successes’. Then: <span class="math display">\[
    \mu = n \dfrac{\eta}{1+e^\eta},
    \mbox{  where } \eta = b_0 + b_1 x_1
\]</span> Here <span class="math inline">\(\dfrac{\mu}{n}\)</span> is an expected proportion.</p>
<p>We can turn this model around, and write <span class="math display">\[
    \eta = \log(\dfrac{\mu}{n+\mu}) = f(\frac{\pi}{1-\pi}), \mbox{ where } \pi=\frac{\mu}{n}
\]</span></p>
<p>Here <code>f()</code> is the logit link.</p>
<p>Generalized Additive Model</p>
<p>Generalized Additive Models are a generalization of Generalized Linear Models. For example, g(.) may be the function that undoes the logit transformation, as in a logistic regression model.</p>
<p>Some terms may be smoothing functions, while others may be the usual linear model terms.</p>
</section>
</section>
<section id="logistic-regression" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">4.2</span> Logistic Regression</h2>
<p>We will use a logistic regression model as a starting point for discussing Generalized Linear Models. With proportions that range from less than 0.1 to 0.99, it is not reasonable to expect that the expected proportion will be a linear function of <code>x</code>. Some such transformation (<code>link</code> function) as the logit is required. Logit models transform to a <code>log(odds)</code> scale. If <code>p</code> is a probability (e.g.&nbsp;that horse A will win the race), then the corresponding odds are <code>p/(1-p)</code>, and <span class="math display">\[
    log(\mbox{odds}) = log(\frac{p}{1-p}) = log(p) - log(1-p)
\]</span> The linear model predicts, not p, but <span class="math inline">\(log(\frac{p}{1-p})\)</span>.</p>
<p>The logit or log(odds) function turns expected proportions into values that may range from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span>. The values from the linear model may in principle vary across the whole real line. One needs a transformation, such as the logit, such that transformed values may extend outside the range from 0 to 1.</p>
<p>Among other link functions that are used with proportions, one of the commonest is the complementary log-log link. See <code>?make.link</code> for details of those that are available for use with GLM models, as fitted using <code>glm()</code>.</p>
<section id="anesthetic-depth-example" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="anesthetic-depth-example"><span class="header-section-number">4.2.1</span> Anesthetic Depth Example</h3>
<p>Thirty patients were given an anesthetic agent that was maintained at a pre-determined [alveolar] concentration for 15 minutes before making an incision . It was then noted whether the patient moved, i.e.&nbsp;jerked or twisted. The interest is in estimating how the probability of jerking or twisting varies with increasing concentration of the anesthetic agent.</p>
<p>The response is best taken as <code>nomove</code>, for reasons that will emerge later. There are a small number of concentrations; so we begin by tabulating proportion that have the <code>nomove</code> outcome against concentration.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Patients moving (0) and not moving (1), for each of six different alveolar concentrations.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0.8</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">1.2</th>
<th style="text-align: right;">1.4</th>
<th style="text-align: right;">1.6</th>
<th style="text-align: right;">2.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">nomove=0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">nomove=1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We fit two models, the logit model and the complementary log-log model. We can fit the models either directly to the 0/1 data, or to the proportions in Table 1. To understand the output, you need to know about “deviances”. A deviance has a role very similar to a sum of squares in regression. Thus we have:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Regression</th>
<th style="text-align: left;">Logistic regression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">degrees of freedom</td>
<td style="text-align: left;">degrees of freedom</td>
</tr>
<tr class="even">
<td style="text-align: left;">sum of squares</td>
<td style="text-align: left;">deviance</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean sum of squares (divide by d.f.)</td>
<td style="text-align: left;">mean deviance (divide by d.f.)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Minimize residual sum of squares</td>
<td style="text-align: left;">Minimize deviance</td>
</tr>
</tbody>
</table>
<p>If individuals respond independently, with the same probability, then we have Bernoulli trials. Justification for assuming the same probability will arise from the way in which individuals are sampled. While individuals will certainly be different in their response the notion is that, each time a new individual is taken, they are drawn at random from some larger population.<br>
Here is the R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>anesthetic <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>anesthetic</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>anaes.logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(nomove <span class="sc">~</span> conc, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> anesthetic)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anaes.logit)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> nomove <span class="sc">~</span> conc, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit), </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> anesthetic)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            Estimate Std. Error z value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>(Intercept)   <span class="sc">-</span><span class="fl">6.469</span>      <span class="fl">2.418</span>  <span class="sc">-</span><span class="fl">2.675</span>  <span class="fl">0.00748</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>conc           <span class="fl">5.567</span>      <span class="fl">2.044</span>   <span class="fl">2.724</span>  <span class="fl">0.00645</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>(Dispersion parameter <span class="cf">for</span> binomial family taken to be <span class="dv">1</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    Null deviance<span class="sc">:</span> <span class="fl">41.455</span>  on <span class="dv">29</span>  degrees of freedom</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>Residual deviance<span class="sc">:</span> <span class="fl">27.754</span>  on <span class="dv">28</span>  degrees of freedom</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>AIC<span class="sc">:</span> <span class="fl">31.754</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>Number of Fisher Scoring iterations<span class="sc">:</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-fig30">Figure&nbsp;<span>4.1</span></a> is a graphical summary of the results. The labeling on the <span class="math inline">\(y\)</span>-axis is on the scale of the linear predictor (<span class="math inline">\(\eta\)</span>),</p>
<div class="cell">

</div>
<div class="cell" data-fig.asp="1.1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">termplot</span>(anaes.logit, <span class="at">partial=</span>T, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">ylab=</span><span class="st">"Probability"</span>, <span class="at">yaxt=</span><span class="st">'n'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>probVal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fu">seq</span>(<span class="at">from=</span>.<span class="dv">1</span>, <span class="at">to=</span>.<span class="dv">9</span>, <span class="at">by=</span>.<span class="dv">2</span>), <span class="fl">0.98</span>, <span class="fl">0.998</span>)) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log</span>(probVal<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>probVal)), <span class="at">labels=</span><span class="fu">paste</span>(probVal), <span class="at">las=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig30" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="GLMandA_files/figure-html/fig-fig30-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.1: Plot, versus concentration, of log(odds) [= logit(proportion)] of patients not moving. The line is the estimate of the proportion of<br>
moves that is based on the fitted logit model.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Code is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">termplot</span>(anaes.logit, <span class="at">partial=</span>T, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">ylab=</span><span class="st">"Probability"</span>, <span class="at">yaxt=</span><span class="st">'n'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>probVal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fu">seq</span>(<span class="at">from=</span>.<span class="dv">1</span>, <span class="at">to=</span>.<span class="dv">9</span>, <span class="at">by=</span>.<span class="dv">2</span>), <span class="fl">0.98</span>, <span class="fl">0.998</span>)) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log</span>(probVal<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>probVal)), <span class="at">labels=</span><span class="fu">paste</span>(probVal), <span class="at">las=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With such a small sample size it is impossible to do much that is useful to check the adequacy of the model. Try also <code>plot(anaes.logit)</code>.</p>
</section>
</section>
<section id="glm-models-generalized-linear-regression-modelling" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="glm-models-generalized-linear-regression-modelling"><span class="header-section-number">4.3</span> GLM models (Generalized Linear Regression Modelling)</h2>
<p>In the above we had</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>anaes.logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(nomove <span class="sc">~</span> conc, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data=</span>anesthetic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The family parameter specifies the distribution for the dependent variable. An optional argument allows specification of the link function. Below we give further examples.</p>
<section id="data-in-the-form-of-counts" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="data-in-the-form-of-counts"><span class="header-section-number">4.3.1</span> Data in the form of counts</h3>
<p>Data that are in the form of counts can often be analysed quite effectively assuming the poisson family. The link that is commonly used is log. The log link transforms from positive numbers to numbers in the range <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span>.</p>
</section>
<section id="the-gaussian-family" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="the-gaussian-family"><span class="header-section-number">4.3.2</span> The gaussian family</h3>
<p>If no family is specified, then the family is taken to be gaussian.<br>
The default link is then the identity, effectively giving an <code>lm</code> model. This way of formulating a linear model has the advantage that one is not restricted to what is effectively the identity link.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset airquality, from datasets package</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>air.glm<span class="ot">&lt;-</span><span class="fu">glm</span>(Ozone<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">~</span> Solar.R <span class="sc">+</span> Wind <span class="sc">+</span> Temp, <span class="at">data =</span> airquality)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assumes gaussian family, i.e. normal errors model</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(air.glm)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="models-that-include-spline-terms" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="models-that-include-spline-terms"><span class="header-section-number">4.4</span> Models that include spline terms</h2>
<p>In most circumstances, rather than adding regression spline terms to <code>lm</code> style linear models, it is better to move directly to using the penalized spline approach, with automatic choice of smoothing parameter, that is implemented in the <em>mgcv</em> package. Note however the risk of over-fitting is there is a correlation structure in the data, such as is likely to be present for time sereis.</p>
<section id="dewpoint-data" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="dewpoint-data"><span class="header-section-number">4.4.1</span> Dewpoint Data</h3>
<p>The data set dewpoint has columns <code>mintemp</code>, <code>maxtemp</code> and <code>dewpoint</code>. The dewpoint values are averages, for each combination of <code>mintemp</code> and <code>maxtemp</code>, of monthly data from a number of different times and locations. We fit the model:</p>
<p>dewpoint = mean of dewpoint + smooth(mintemp) + smooth(maxtemp)</p>
<p>Taking out the mean is a computational convenience. Also it provides a more helpful form of output. Here are details of the calculations for a generalized additive model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dewpoint <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>dewpoint</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Loading required package<span class="sc">:</span> nlme</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>This is mgcv <span class="fl">1.9-0.</span> For overview type <span class="st">'help("mgcv-package")'</span>.</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>dewpoint.gam <span class="ot">&lt;-</span> <span class="fu">gam</span>(dewpt <span class="sc">~</span> <span class="fu">s</span>(mintemp) <span class="sc">+</span> <span class="fu">s</span>(maxtemp),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> dewpoint)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dewpoint.gam, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>Family<span class="sc">:</span> gaussian </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>Link <span class="cf">function</span><span class="sc">:</span> identity </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>Formula<span class="sc">:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>dewpt <span class="sc">~</span> <span class="fu">s</span>(mintemp) <span class="sc">+</span> <span class="fu">s</span>(maxtemp)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>Parametric coefficients<span class="sc">:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>            Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>(Intercept) <span class="fl">13.12500</span>    <span class="fl">0.04215</span>   <span class="fl">311.4</span>   <span class="sc">&lt;</span><span class="fl">2e-16</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>Approximate significance of smooth terms<span class="sc">:</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>             edf Ref.df      F p<span class="sc">-</span>value</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(mintemp) <span class="fl">3.220</span>  <span class="fl">4.042</span> <span class="fl">3992.2</span>  <span class="sc">&lt;</span><span class="fl">2e-16</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(maxtemp) <span class="fl">6.252</span>  <span class="fl">7.420</span>  <span class="fl">794.3</span>  <span class="sc">&lt;</span><span class="fl">2e-16</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>R<span class="sc">-</span><span class="fu">sq.</span>(adj) <span class="ot">=</span>  <span class="fl">0.996</span>   Deviance explained <span class="ot">=</span> <span class="fl">99.7</span>%</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>GCV <span class="ot">=</span> <span class="fl">0.14971</span>  Scale est. <span class="ot">=</span> <span class="fl">0.12794</span>   n <span class="ot">=</span> <span class="dv">72</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-summaries" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="model-summaries"><span class="header-section-number">4.4.2</span> Model Summaries</h3>
<p>Type in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">methods</span>(summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>to get a list of the summary methods that are available. You may want to mix and match, e.g.&nbsp;<code>summary.lm()</code> on an aov object. The output may not be what you might expect. So be careful!</p>
</section>
</section>
<section id="further-types-of-model" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="further-types-of-model"><span class="header-section-number">4.5</span> Further types of model</h2>
<section id="survival-analysis" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="survival-analysis"><span class="header-section-number">4.5.1</span> Survival Analysis</h3>
<p>For example times at which subjects were either lost to the study or died (‘failed’) may be recorded for individuals in each of several treatment groups. Engineering or business failures can be modelled using this same methodology. The R survival package has state of the art abilities for survival analysis.</p>
</section>
<section id="nonlinear-models" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="nonlinear-models"><span class="header-section-number">4.5.2</span> Nonlinear Models</h3>
<p>The function <code>nls()</code> (non-linear least squares) can be used to obtain a least squares fit to a non-linear function.</p>
</section>
</section>
<section id="further-elaborations" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="further-elaborations"><span class="header-section-number">4.6</span> Further Elaborations</h2>
<p>Generalised Linear Models were developed in the 1970s. They unified a wide range of what had earlier been treated as distinct methods, and have now become a stock-in-trade of statistical analysts. Their practical implementation took advantage of new computational abilities that had been developed for handling linear model calculations.</p>
<p>Practical data analysis demands further elaborations. An important elaboration is to the incorporation of more than one term in the error structure. The R <em>nlme</em> and <em>lme4</em> packages implement such extensions, for a wide class of nonlinear models as well for linear models. Each such new development builds on the theoretical and computational tools that have arisen from earlier developments. Powerful new analysis tools will continue to appear for a long time yet. This is fortunate. Most professional users of R will regularly encounter data where the methodology that the data ideally demands is not yet available.</p>
</section>
<section id="exercises" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="exercises"><span class="header-section-number">4.7</span> Exercises</h2>
<ol type="1">
<li>Fit a Poisson regression model to the data in the data frame <code>DAAG::moths</code>, Allow different intercepts for different habitats. Use <code>log(meters)</code> as a covariate. Why <code>log(meters)</code>?</li>
</ol>
</section>
<section id="references-and-reading" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="references-and-reading"><span class="header-section-number">4.8</span> References and reading</h2>
<p><span class="citation" data-cites="Faraway-extend">Faraway (<a href="references.html#ref-Faraway-extend" role="doc-biblioref">2016</a>)</span> . Extending the Linear Model with R. Taylor &amp; Francis.</p>
<p><span class="citation" data-cites="maindonald2010data">Maindonald and Braun (<a href="references.html#ref-maindonald2010data" role="doc-biblioref">2010</a>)</span> . Data Analysis and Graphics Using R –- An Example-Based Approach. Cambridge University Press.</p>
<p><span class="citation" data-cites="maindonald2023">Maindonald, Braun, and Andrews (<a href="references.html#ref-maindonald2023" role="doc-biblioref">2024, forthcoming</a>)</span> . A Practical Guide to Data Analysis Using R. An Example-Based Approach. Cambridge University Press.</p>
<p><span class="citation" data-cites="VR-MASS">Venables and Ripley (<a href="references.html#ref-VR-MASS" role="doc-biblioref">2002</a>)</span> . Modern Applied Statistics with S. Springer, NY.</p>
<p><span class="citation" data-cites="Wood-2017">Wood (<a href="references.html#ref-Wood-2017" role="doc-biblioref">2017</a>)</span> . Generalized Additive Models. An Introduction with R. Chapman and Hall/CRC.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-Faraway-extend" class="csl-entry" role="doc-biblioentry">
Faraway, Julian J. 2016. <em>Extending the Linear Model with r</em>. 2nd ed. Taylor &amp; Francis Inc.
</div>
<div id="ref-maindonald2010data" class="csl-entry" role="doc-biblioentry">
Maindonald, John, and John Braun. 2010. <em>Data Analysis and Graphics Using r: An Example-Based Approach</em>. Cambridge University Press.
</div>
<div id="ref-maindonald2023" class="csl-entry" role="doc-biblioentry">
Maindonald, John, W John Braun, and Jeffrey Andrews. 2024, forthcoming. <em>A Practical Guide to Data Analysis Using r. An Example-Based Approach.</em> Cambridge University Press. <a href="https://jhmaindonald.github.io/PGRcode">https://jhmaindonald.github.io/PGRcode</a>.
</div>
<div id="ref-VR-MASS" class="csl-entry" role="doc-biblioentry">
Venables, W. N., and B. D. Ripley. 2002. <em>Modern Applied Statistics with <span>S</span></em>. 4th ed. Springer.
</div>
<div id="ref-Wood-2017" class="csl-entry" role="doc-biblioentry">
Wood, S. N. 2017. <em>Generalized Additive Models. An Introduction with r</em>. 2nd ed. Chapman; Hall/CRC.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./reg.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ts.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regular Time Series in R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
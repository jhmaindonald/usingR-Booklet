<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Using R for Data Analysis and Graphics - 8&nbsp; Multi-Level Models and Repeated Measures Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./mva.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Level Models and Repeated Measures Models</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Using R for Data Analysis and Graphics</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An overview of the R system</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Base R Graphics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GLMandA.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Generalized Linear and Additive Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regular Time Series in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trees.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tree-based models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mva.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Level Models and Repeated Measures Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#multi-level-models-examples" id="toc-multi-level-models-examples" class="nav-link active" data-scroll-target="#multi-level-models-examples"><span class="toc-section-number">8.1</span>  Multi-level models – examples</a>
  <ul class="collapse">
  <li><a href="#the-kiwifruit-shading-data-again" id="toc-the-kiwifruit-shading-data-again" class="nav-link" data-scroll-target="#the-kiwifruit-shading-data-again">The Kiwifruit Shading Data, Again</a></li>
  <li><a href="#the-tinting-of-car-windows" id="toc-the-tinting-of-car-windows" class="nav-link" data-scroll-target="#the-tinting-of-car-windows">The Tinting of Car Windows</a></li>
  <li><a href="#the-michelson-speed-of-light-data" id="toc-the-michelson-speed-of-light-data" class="nav-link" data-scroll-target="#the-michelson-speed-of-light-data">The Michelson Speed of Light Data</a></li>
  </ul></li>
  <li><a href="#references-and-reading" id="toc-references-and-reading" class="nav-link" data-scroll-target="#references-and-reading"><span class="toc-section-number">8.2</span>  References and reading</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Level Models and Repeated Measures Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Models have both a fixed effects structure and an error structure. For example, in an inter-laboratory comparison there may be variation between laboratories, between observers within laboratories, and between multiple determinations made by the same observer on different samples. If we treat laboratories and observers as random, the only fixed effect is the mean.</p>
<p>The functions <code>lme()</code> and <code>nlme()</code>, from the Pinheiro and Bates <em>nlme</em> package, handle models in which a repeated measures error structure is superimposed on a linear (<code>lme4()</code>) or non-linear (<code>nlme()</code>) model. The <code>lme()</code> function is broadly comparable to Proc Mixed in the widely used SAS statistical package. The function <code>lme()</code> has associated with it important abilities for diagnostic checking and other insight.</p>
<p>There is a strong link between a wide class of repeated measures models and time series models. In the time series context there is usually just one realization of the series, which may however be observed at a large number of time points. In the repeated measures context there may be a large number of realizations of a series that is typically quite short.</p>
<section id="multi-level-models-examples" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="multi-level-models-examples"><span class="header-section-number">8.1</span> Multi-level models – examples</h2>
<section id="the-kiwifruit-shading-data-again" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-kiwifruit-shading-data-again">The Kiwifruit Shading Data, Again</h3>
<p>Refer back to <a href="reg.html#sec-errorAOV"><span>Section&nbsp;3.8</span></a> for details of the data. The fixed effects are <code>block</code> and treatment (<code>shade</code>). The random effects are block (though making block a random effect is optional, for purposes of comparing treatments), <code>plot</code> within <code>block</code>, and units within each block/plot combination. Here is the analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>kiwishade <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>kiwishade</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>kiwishade<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">paste</span>(kiwishade<span class="sc">$</span>block, kiwishade<span class="sc">$</span>shade, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">"."</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>kiwishade.lme <span class="ot">&lt;-</span> <span class="fu">lme</span>(yield<span class="sc">~</span>shade,<span class="at">random=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>plot, <span class="at">data=</span>kiwishade)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kiwishade.lme)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Linear mixed<span class="sc">-</span>effects model fit by REML</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  Data<span class="sc">:</span> kiwishade </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>       AIC      BIC    logLik</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fl">265.9663</span> <span class="fl">278.4556</span> <span class="sc">-</span><span class="fl">125.9831</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Random effects<span class="sc">:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a> Formula<span class="sc">:</span> <span class="er">~</span><span class="dv">1</span> <span class="sc">|</span> block</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        (Intercept)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>StdDev<span class="sc">:</span>    <span class="fl">2.019373</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a> Formula<span class="sc">:</span> <span class="er">~</span><span class="dv">1</span> <span class="sc">|</span> plot <span class="sc">%in%</span> block</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        (Intercept) Residual</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>StdDev<span class="sc">:</span>    <span class="fl">1.478623</span> <span class="fl">3.490381</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>Fixed effects<span class="sc">:</span>  yield <span class="sc">~</span> shade </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                 Value Std.Error DF  t<span class="sc">-</span>value p<span class="sc">-</span>value</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>(Intercept)  <span class="fl">100.20250</span>  <span class="fl">1.761617</span> <span class="dv">36</span> <span class="fl">56.88098</span>  <span class="fl">0.0000</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>shadeAug2Dec   <span class="fl">3.03083</span>  <span class="fl">1.867621</span>  <span class="dv">6</span>  <span class="fl">1.62283</span>  <span class="fl">0.1558</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>shadeDec2Feb <span class="sc">-</span><span class="fl">10.28167</span>  <span class="fl">1.867621</span>  <span class="dv">6</span> <span class="sc">-</span><span class="fl">5.50522</span>  <span class="fl">0.0015</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>shadeFeb2May  <span class="sc">-</span><span class="fl">7.42833</span>  <span class="fl">1.867621</span>  <span class="dv">6</span> <span class="sc">-</span><span class="fl">3.97743</span>  <span class="fl">0.0073</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a> Correlation<span class="sc">:</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>             (Intr) shdA2D shdD2F</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>shadeAug2Dec <span class="sc">-</span><span class="fl">0.53</span>               </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>shadeDec2Feb <span class="sc">-</span><span class="fl">0.53</span>   <span class="fl">0.50</span>        </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>shadeFeb2May <span class="sc">-</span><span class="fl">0.53</span>   <span class="fl">0.50</span>   <span class="fl">0.50</span> </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>Standardized Within<span class="sc">-</span>Group Residuals<span class="sc">:</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        Min          Q1         Med          Q3         Max </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">2.41538976</span> <span class="sc">-</span><span class="fl">0.59814252</span> <span class="sc">-</span><span class="fl">0.06899575</span>  <span class="fl">0.78046182</span>  <span class="fl">1.58909233</span> </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>Number of Observations<span class="sc">:</span> <span class="dv">48</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>Number of Groups<span class="sc">:</span> </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>          block plot <span class="sc">%in%</span> block </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>              <span class="dv">3</span>              <span class="dv">12</span> </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(kiwishade.lme)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            numDF denDF  F<span class="sc">-</span>value p<span class="sc">-</span>value</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>(Intercept)     <span class="dv">1</span>    <span class="dv">36</span> <span class="fl">5190.560</span>  <span class="sc">&lt;</span>.<span class="dv">0001</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>shade           <span class="dv">3</span>     <span class="dv">6</span>   <span class="fl">22.211</span>  <span class="fl">0.0012</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">intervals</span>(kiwishade.lme)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>Approximate <span class="dv">95</span>% confidence intervals</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a> Fixed effects<span class="sc">:</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                  lower       est.      upper</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>(Intercept)   <span class="fl">96.629775</span> <span class="fl">100.202500</span> <span class="fl">103.775225</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>shadeAug2Dec  <span class="sc">-</span><span class="fl">1.539072</span>   <span class="fl">3.030833</span>   <span class="fl">7.600738</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>shadeDec2Feb <span class="sc">-</span><span class="fl">14.851572</span> <span class="sc">-</span><span class="fl">10.281667</span>  <span class="sc">-</span><span class="fl">5.711762</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>shadeFeb2May <span class="sc">-</span><span class="fl">11.998238</span>  <span class="sc">-</span><span class="fl">7.428333</span>  <span class="sc">-</span><span class="fl">2.858428</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a> Random Effects<span class="sc">:</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  Level<span class="sc">:</span> block </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                    lower     est.    upper</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>((Intercept)) <span class="fl">0.5475859</span> <span class="fl">2.019373</span> <span class="fl">7.446993</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  Level<span class="sc">:</span> plot </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                    lower     est.    upper</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>((Intercept)) <span class="fl">0.3700762</span> <span class="fl">1.478623</span> <span class="fl">5.907772</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a> Within<span class="sc">-</span>group standard error<span class="sc">:</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>   lower     est.    upper </span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="fl">2.770652</span> <span class="fl">3.490381</span> <span class="fl">4.397072</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are interested in the three sd estimates. By squaring the standard deviations and converting them to variances we get the information in the following table:</p>
<table class="table">
<colgroup>
<col style="width: 31%">
<col style="width: 30%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Variance component</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">block</td>
<td style="text-align: left;">2.0192<span class="math inline">\(^2\)</span> = 4.076</td>
<td style="text-align: left;">Three blocks</td>
</tr>
<tr class="even">
<td style="text-align: left;">plot</td>
<td style="text-align: left;">1.4792<span class="math inline">\(^2\)</span> = 2.186</td>
<td style="text-align: left;">4 plots per block</td>
</tr>
<tr class="odd">
<td style="text-align: left;">residual (within group)</td>
<td style="text-align: left;">3.4902<span class="math inline">\(^2\)</span>=12.180</td>
<td style="text-align: left;">4 vines (subplots) per plot</td>
</tr>
</tbody>
</table>
<p>The above gives the information for an analysis of variance table. We have:</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 20%">
<col style="width: 31%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Variance component</th>
<th style="text-align: left;">Mean square for anova table</th>
<th style="text-align: left;">d.f.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">block</td>
<td style="text-align: left;">4.076</td>
<td style="text-align: left;">12.180 + 4 <span class="math inline">\(\times\)</span> 2.186 + 16 <span class="math inline">\(\times\)</span> 4.076 = 86.14</td>
<td style="text-align: left;">2 (3-1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">plot</td>
<td style="text-align: left;">2.186</td>
<td style="text-align: left;">12.180 + 4 <span class="math inline">\(\times\)</span> 2.186 = 20.92</td>
<td style="text-align: left;">6 (3-1)<span class="math inline">\(\times\)</span>(4-1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">residual (within gp)</td>
<td style="text-align: left;">12.180</td>
<td style="text-align: left;">12.18</td>
<td style="text-align: left;">3 <span class="math inline">\(\times\)</span> 4 <span class="math inline">\(\times\)</span> (4-1)</td>
</tr>
</tbody>
</table>
<p>Now see where these same pieces of information appeared in the analysis of variance table of <a href="reg.html#sec-errorAOV"><span>Section&nbsp;3.8</span></a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>kiwishade.aov<span class="ot">&lt;-</span><span class="fu">aov</span>(yield<span class="sc">~</span>block<span class="sc">+</span>shade<span class="sc">+</span><span class="fu">Error</span>(block<span class="sc">:</span>shade),<span class="at">data=</span>kiwishade)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">aov</span>(yield <span class="sc">~</span> block <span class="sc">+</span> shade <span class="sc">+</span> <span class="fu">Error</span>(block<span class="sc">:</span>shade), <span class="at">data =</span> kiwishade)<span class="sc">:</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Error</span>() model is singular</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kiwishade.aov)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Error<span class="sc">:</span> block<span class="sc">:</span>shade</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>          Df Sum Sq Mean Sq F value  <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>block      <span class="dv">2</span>  <span class="fl">172.3</span>    <span class="fl">86.2</span>   <span class="fl">4.118</span> <span class="fl">0.07488</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>shade      <span class="dv">3</span> <span class="fl">1394.5</span>   <span class="fl">464.8</span>  <span class="fl">22.211</span> <span class="fl">0.00119</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>Residuals  <span class="dv">6</span>  <span class="fl">125.6</span>    <span class="fl">20.9</span>                </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>Error<span class="sc">:</span> Within</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>          Df Sum Sq Mean Sq F value <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>Residuals <span class="dv">36</span>  <span class="fl">438.6</span>   <span class="fl">12.18</span>               </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-tinting-of-car-windows" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-tinting-of-car-windows">The Tinting of Car Windows</h3>
<p>In <a href="graphs.html#sec-lattice"><span>Section&nbsp;2.8</span></a> we encountered data from an experiment that aimed to model the effects of the tinting of car windows on visual performance . The authors are mainly interested in effects on side window vision, and hence in visual recognition tasks that would be performed when looking through side windows. Data are in the data frame tinting. In this data frame, <code>csoa</code> (critical stimulus onset asynchrony, i.e.&nbsp;the time in milliseconds required to recognise an alphanumeric target), <code>it</code> (inspection time, i.e.&nbsp;the time required for a simple discrimination task) and age are variables, while <code>tint</code> (3 levels) and <code>target</code> (2 levels) are ordered factors. The variable <code>sex</code> is coded 1 for <code>males</code> and 2 for females, while the variable <code>agegp</code> is coded 1 for young people (all in their early 20s) and 2 for older participants (all in the early 70s).</p>
<p>We have two levels of variation – within individuals (who were each tested on each combination of <code>tint</code> and <code>target</code>), and between individuals. So we need to specify <code>id</code> (identifying the individual) as a random effect. Plots such as we examined in <a href="graphs.html#sec-lattice"><span>Section&nbsp;2.8</span></a> make it clear that, to get variances that are approximately homogeneous, we need to work with <code>log(csoa)</code> and <code>log(it)</code>. Here we examine the analysis for <code>log(it)</code>. We start with a model that is likely to be more complex than we need (it has all possible interactions):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tinting <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>tinting</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>itstar.lme<span class="ot">&lt;-</span><span class="fu">lme</span>(<span class="fu">log</span>(it)<span class="sc">~</span>tint<span class="sc">*</span>target<span class="sc">*</span>agegp<span class="sc">*</span>sex,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">random=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>id, <span class="at">data=</span>tinting,<span class="at">method=</span><span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A reasonable guess is that first order interactions may be all we need, i.e.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>it2.lme<span class="ot">&lt;-</span><span class="fu">lme</span>(<span class="fu">log</span>(it)<span class="sc">~</span>(tint<span class="sc">+</span>target<span class="sc">+</span>agegp<span class="sc">+</span>sex)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">random=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>id, <span class="at">data=</span>tinting,<span class="at">method=</span><span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, there is the very simple model, allowing only for main effects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>it1.lme<span class="ot">&lt;-</span><span class="fu">lme</span>(<span class="fu">log</span>(it)<span class="sc">~</span>(tint<span class="sc">+</span>target<span class="sc">+</span>agegp<span class="sc">+</span>sex),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">random=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>id, <span class="at">data=</span>tinting,<span class="at">method=</span><span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that all these models have been fitted by maximum likelihood. This allows the equivalent of an analysis of variance comparison.<br>
Here is what we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(itstar.lme,it2.lme,it1.lme)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>           Model df       AIC      BIC    logLik   Test  L.Ratio p<span class="sc">-</span>value</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>itstar.lme     <span class="dv">1</span> <span class="dv">26</span>  <span class="fl">8.146187</span> <span class="fl">91.45036</span> <span class="fl">21.926906</span>                        </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>it2.lme        <span class="dv">2</span> <span class="dv">17</span> <span class="sc">-</span><span class="fl">3.742883</span> <span class="fl">50.72523</span> <span class="fl">18.871441</span> <span class="dv">1</span> vs <span class="dv">2</span>  <span class="fl">6.11093</span>  <span class="fl">0.7288</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>it1.lme        <span class="dv">3</span>  <span class="dv">8</span>  <span class="fl">1.138171</span> <span class="fl">26.77022</span>  <span class="fl">7.430915</span> <span class="dv">2</span> vs <span class="dv">3</span> <span class="fl">22.88105</span>  <span class="fl">0.0065</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model that limits attention to first order interactions appears adequate. As a preliminary to examining the first order interactions individually, we re-fit the model used for <code>it2.lme</code>, now with <code>method="REML"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>it2.reml<span class="ot">&lt;-</span><span class="fu">update</span>(it2.lme,<span class="at">method=</span><span class="st">"REML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now examine the estimated effects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(it2.reml)<span class="sc">$</span>tTable</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                          Value Std.Error  DF t<span class="sc">-</span>value  p<span class="sc">-</span>value</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>(Intercept)             <span class="fl">3.61907</span>    <span class="fl">0.1301</span> <span class="dv">145</span>  <span class="fl">27.817</span> <span class="fl">5.30e-60</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>tint.L                  <span class="fl">0.16095</span>    <span class="fl">0.0442</span> <span class="dv">145</span>   <span class="fl">3.638</span> <span class="fl">3.81e-04</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>tint.Q                  <span class="fl">0.02096</span>    <span class="fl">0.0452</span> <span class="dv">145</span>   <span class="fl">0.464</span> <span class="fl">6.44e-01</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>targethicon            <span class="sc">-</span><span class="fl">0.11807</span>    <span class="fl">0.0423</span> <span class="dv">145</span>  <span class="sc">-</span><span class="fl">2.789</span> <span class="fl">5.99e-03</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>agegpolder              <span class="fl">0.47121</span>    <span class="fl">0.2329</span>  <span class="dv">22</span>   <span class="fl">2.023</span> <span class="fl">5.54e-02</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>sexm                    <span class="fl">0.08213</span>    <span class="fl">0.2329</span>  <span class="dv">22</span>   <span class="fl">0.353</span> <span class="fl">7.28e-01</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>tint.L<span class="sc">:</span>targethicon     <span class="sc">-</span><span class="fl">0.09193</span>    <span class="fl">0.0461</span> <span class="dv">145</span>  <span class="sc">-</span><span class="fl">1.996</span> <span class="fl">4.78e-02</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>tint.Q<span class="sc">:</span>targethicon     <span class="sc">-</span><span class="fl">0.00722</span>    <span class="fl">0.0482</span> <span class="dv">145</span>  <span class="sc">-</span><span class="fl">0.150</span> <span class="fl">8.81e-01</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>tint.L<span class="sc">:</span>agegpolder       <span class="fl">0.13075</span>    <span class="fl">0.0492</span> <span class="dv">145</span>   <span class="fl">2.658</span> <span class="fl">8.74e-03</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>tint.Q<span class="sc">:</span>agegpolder       <span class="fl">0.06972</span>    <span class="fl">0.0520</span> <span class="dv">145</span>   <span class="fl">1.341</span> <span class="fl">1.82e-01</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>tint.L<span class="sc">:</span>sexm            <span class="sc">-</span><span class="fl">0.09794</span>    <span class="fl">0.0492</span> <span class="dv">145</span>  <span class="sc">-</span><span class="fl">1.991</span> <span class="fl">4.83e-02</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>tint.Q<span class="sc">:</span>sexm             <span class="fl">0.00542</span>    <span class="fl">0.0520</span> <span class="dv">145</span>   <span class="fl">0.104</span> <span class="fl">9.17e-01</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>targethicon<span class="sc">:</span>agegpolder <span class="sc">-</span><span class="fl">0.13887</span>    <span class="fl">0.0584</span> <span class="dv">145</span>  <span class="sc">-</span><span class="fl">2.376</span> <span class="fl">1.88e-02</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>targethicon<span class="sc">:</span>sexm        <span class="fl">0.07785</span>    <span class="fl">0.0584</span> <span class="dv">145</span>   <span class="fl">1.332</span> <span class="fl">1.85e-01</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>agegpolder<span class="sc">:</span>sexm         <span class="fl">0.33164</span>    <span class="fl">0.3261</span>  <span class="dv">22</span>   <span class="fl">1.017</span> <span class="fl">3.20e-01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because tint is an ordered factor, polynomial contrasts are used.</p>
</section>
<section id="the-michelson-speed-of-light-data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-michelson-speed-of-light-data">The Michelson Speed of Light Data</h3>
<p>The <code>MASS::michelson</code> dataframe has columns <code>Speed</code>, <code>Run</code>, and <code>Expt</code>, for five experiments of 20 runs each. A plot of the data seems consistent with sequential dependence within runs, possibly with random variation between runs.</p>
<div class="cell">

</div>
<div class="cell" data-fig.asp="0.38">
<div class="cell-output-display">
<div id="fig-fig45" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="mlm_files/figure-html/fig-fig45-1.png" class="img-fluid figure-img" width="720"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8.1: Plots show speed of light estimates against run number, for each of five experiments.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Code is:</p>
<div class="cell" data-fig.asp="0.38">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>michelson <span class="ot">&lt;-</span> MASS<span class="sc">::</span>michelson</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">xyplot</span>(Speed<span class="sc">~</span>Run<span class="sc">|</span><span class="fu">factor</span>(Expt), <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>michelson, <span class="at">type=</span><span class="fu">c</span>(<span class="st">'p'</span>,<span class="st">'r'</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">at=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="dv">19</span>, <span class="at">by=</span><span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We try a model that allows the estimates to vary linearly with Run (from 1 to 20), with the slope varying randomly between experiments. We assume an autoregressive dependence structure of order 1. We allow the variance to change from one experiment to another.</p>
<p>To test whether this level of model complexity is justified statistically, one needs to compare models with and without these effects, setting <code>method="ML"</code> in each case, and compare the likelihoods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>michelson <span class="ot">&lt;-</span> MASS<span class="sc">::</span>michelson</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>michelson<span class="sc">$</span>Run <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(michelson<span class="sc">$</span>Run)   <span class="co"># Ensure Run is a variable</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>mich.lme1 <span class="ot">&lt;-</span> <span class="fu">lme</span>(<span class="at">fixed =</span> Speed <span class="sc">~</span> Run, <span class="at">data =</span> michelson, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">random =</span>  <span class="sc">~</span> Run<span class="sc">|</span> Expt, <span class="at">correlation =</span> <span class="fu">corAR1</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Expt), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Expt), <span class="at">method=</span><span class="st">'ML'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>mich.lme0 <span class="ot">&lt;-</span> <span class="fu">lme</span>(<span class="at">fixed =</span> Speed <span class="sc">~</span> Run, <span class="at">data =</span> michelson, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">random =</span>  <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span> Expt, <span class="at">correlation =</span> <span class="fu">corAR1</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Expt), </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Expt), <span class="at">method=</span><span class="st">'ML'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mich.lme0, mich.lme1)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>          Model df  AIC  BIC logLik   Test  L.Ratio p<span class="sc">-</span>value</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>mich.lme0     <span class="dv">1</span>  <span class="dv">9</span> <span class="dv">1121</span> <span class="dv">1144</span>   <span class="sc">-</span><span class="dv">551</span>                        </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>mich.lme1     <span class="dv">2</span> <span class="dv">11</span> <span class="dv">1125</span> <span class="dv">1153</span>   <span class="sc">-</span><span class="dv">551</span> <span class="dv">1</span> vs <span class="dv">2</span> <span class="fl">2.63e-08</span>       <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The simpler model is preferred. Can it be simplified further?</p>
</section>
</section>
<section id="references-and-reading" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="references-and-reading"><span class="header-section-number">8.2</span> References and reading</h2>
<p>See the vignettes that accompany the <em>lme4</em> package.</p>
<p><span class="citation" data-cites="maindonald2010data">Maindonald and Braun (<a href="references.html#ref-maindonald2010data" role="doc-biblioref">2010</a>)</span> . Data Analysis and Graphics Using R –- An Example-Based Approach. Cambridge University Press.</p>
<p><span class="citation" data-cites="maindonald2023">Maindonald, Braun, and Andrews (<a href="references.html#ref-maindonald2023" role="doc-biblioref">2024, forthcoming</a>)</span> . A Practical Guide to Data Analysis Using R. An Example-Based Approach. Cambridge University Press.</p>
<p><span class="citation" data-cites="PinBates">Pinheiro and Bates (<a href="references.html#ref-PinBates" role="doc-biblioref">2000</a>)</span> . Mixed effects models in S and S-PLUS. Springer.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-maindonald2010data" class="csl-entry" role="doc-biblioentry">
Maindonald, John, and John Braun. 2010. <em>Data Analysis and Graphics Using r: An Example-Based Approach</em>. Cambridge University Press.
</div>
<div id="ref-maindonald2023" class="csl-entry" role="doc-biblioentry">
Maindonald, John, W John Braun, and Jeffrey Andrews. 2024, forthcoming. <em>A Practical Guide to Data Analysis Using r. An Example-Based Approach.</em> Cambridge University Press. <a href="https://jhmaindonald.github.io/PGRcode">https://jhmaindonald.github.io/PGRcode</a>.
</div>
<div id="ref-PinBates" class="csl-entry" role="doc-biblioentry">
Pinheiro, J. C., and D. M. Bates. 2000. <em>Mixed Effects Models in <span>S</span> and <span>S-PLUS</span></em>. Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./mva.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Methods</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>